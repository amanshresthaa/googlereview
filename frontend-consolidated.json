{
  "generatedAt": "2026-02-11T13:09:30.202Z",
  "root": "/Users/amankumarshrestha/LapenInns Project/googlereview",
  "scope": {
    "include": [
      "app",
      "components"
    ],
    "exclude": [
      "app/api/**"
    ],
    "extensions": [
      ".ts",
      ".tsx",
      ".css",
      ".scss",
      ".mdx"
    ],
    "extras": [
      "tailwind.config.ts",
      "postcss.config.mjs",
      "next.config.ts",
      "components.json"
    ]
  },
  "fileCount": 60,
  "files": [
    {
      "path": "app/(app)/inbox/inbox-ui.tsx",
      "content": "\"use client\"\n\nimport * as React from \"react\"\nimport { motion } from \"framer-motion\"\nimport { toast } from \"sonner\"\nimport { cn } from \"@/lib/utils\"\nimport { formatAge, type ReviewRow } from \"@/lib/hooks\"\nimport { Button } from \"@/components/ui/button\"\nimport { Card, CardContent } from \"@/components/ui/card\"\nimport { Checkbox } from \"@/components/ui/checkbox\"\nimport { Textarea } from \"@/components/ui/textarea\"\nimport {\n  AlertTriangle,\n  CheckCircle2,\n  ChevronRight,\n  Globe,\n  MapPin,\n  MoreHorizontal,\n  RefreshCw,\n  Send,\n  Sparkles,\n  Star,\n  X,\n  Zap,\n} from \"@/components/icons\"\n\nfunction Stars({ rating, size = \"default\" }: { rating: number; size?: \"sm\" | \"default\" }) {\n  const sizeClass = size === \"sm\" ? \"h-3.5 w-3.5\" : \"h-4 w-4\"\n  return (\n    <div className=\"flex items-center gap-0.5\">\n      {Array.from({ length: 5 }).map((_, i) => (\n        <Star\n          key={`star-${rating}-${String(i)}`}\n          className={cn(sizeClass, i < rating ? \"fill-yellow-400 text-yellow-400\" : \"text-zinc-200\")}\n        />\n      ))}\n    </div>\n  )\n}\n\nexport function ReviewItem({\n  review,\n  isSelected,\n  onToggle,\n  onGenerate,\n  onSave,\n  onPublish,\n}: {\n  review: ReviewRow\n  isSelected: boolean\n  onToggle: () => void\n  onGenerate: (reviewId: string) => Promise<void>\n  onSave: (reviewId: string, text: string) => Promise<void>\n  onPublish: (reviewId: string, text: string, row: ReviewRow) => Promise<void>\n}) {\n  const [isEditing, setIsEditing] = React.useState(false)\n  const [draft, setDraft] = React.useState(review.currentDraft?.text ?? \"\")\n  const [busy, setBusy] = React.useState<\"generate\" | \"save\" | \"publish\" | null>(null)\n\n  React.useEffect(() => {\n    setDraft(review.currentDraft?.text ?? \"\")\n    setIsEditing(false)\n  }, [review.id, review.currentDraft?.id, review.currentDraft?.text])\n\n  const statusClass =\n    review.status === \"pending\"\n      ? \"bg-yellow-50 text-yellow-700 border-yellow-200\"\n      : \"bg-green-50 text-green-700 border-green-200\"\n\n  const run = async (action: \"generate\" | \"save\" | \"publish\", fn: () => Promise<void>) => {\n    setBusy(action)\n    try {\n      await fn()\n    } catch (e) {\n      toast.error(e instanceof Error ? e.message : \"Action failed\")\n    } finally {\n      setBusy(null)\n    }\n  }\n\n  return (\n    <Card className={cn(\"group bg-white rounded-xl transition-all\", isSelected ? \"border-blue-500 ring-1 ring-blue-500 shadow-md\" : \"border-zinc-200 hover:border-zinc-300 shadow-sm\")}>\n      <CardContent className=\"flex items-start p-5 gap-4\">\n        <div className=\"pt-1\">\n          <Checkbox\n            checked={isSelected}\n            onCheckedChange={onToggle}\n            aria-label={`Select review by ${review.reviewer.displayName ?? \"anonymous reviewer\"}`}\n            className={cn(\n              \"h-5 w-5 rounded border transition-colors\",\n              isSelected\n                ? \"bg-blue-600 border-blue-600 text-white data-[state=checked]:bg-blue-600 data-[state=checked]:border-blue-600\"\n                : \"bg-white border-zinc-300 group-hover:border-blue-400\"\n            )}\n          />\n        </div>\n\n        <div className=\"flex-1 min-w-0\">\n          <div className=\"flex items-center justify-between mb-1\">\n            <div className=\"flex items-center gap-2 min-w-0\">\n              <span className=\"font-bold text-zinc-900 truncate\">{review.reviewer.displayName ?? \"Anonymous\"}</span>\n              <span className=\"text-xs text-zinc-400\">â€¢</span>\n              <span className=\"text-xs text-zinc-500 shrink-0\">{formatAge(review.createTimeIso)} ago</span>\n            </div>\n            <div className={cn(\"px-2 py-0.5 rounded-full text-[10px] font-bold uppercase border\", statusClass)}>{review.status}</div>\n          </div>\n\n          <div className=\"flex items-center gap-3 mb-3\">\n            <Stars rating={review.starRating} size=\"sm\" />\n            <div className=\"flex items-center gap-1 text-xs text-zinc-500\">\n              <MapPin className=\"h-3 w-3\" />\n              {review.location.displayName}\n            </div>\n            {review.draftStatus === \"BLOCKED_BY_VERIFIER\" ? (\n              <div className=\"inline-flex items-center gap-1 text-[10px] font-bold uppercase text-rose-700 bg-rose-50 border border-rose-100 px-2 py-0.5 rounded-full\">\n                <AlertTriangle className=\"h-3 w-3\" />\n                Flagged\n              </div>\n            ) : null}\n          </div>\n\n          <p className=\"text-sm text-zinc-700 leading-relaxed mb-4\">{review.comment || \"No written comment provided.\"}</p>\n\n          {review.status === \"pending\" ? (\n            <Card className=\"bg-blue-50/50 border-blue-100 rounded-xl\">\n              <CardContent className=\"p-4\">\n              <div className=\"flex items-center justify-between mb-3\">\n                <div className=\"flex items-center gap-2 text-blue-700 text-xs font-bold uppercase tracking-wide\">\n                  <Sparkles className=\"h-3.5 w-3.5\" />\n                  AI Suggested Draft\n                </div>\n                <div className=\"flex items-center gap-3\">\n                  <Button variant=\"ghost\" size=\"sm\" onClick={() => setIsEditing((v) => !v)} className=\"text-xs font-semibold text-blue-600 hover:underline h-auto p-0\">\n                    {isEditing ? \"Cancel\" : \"Edit Draft\"}\n                  </Button>\n                  <Button\n                    type=\"button\"\n                    variant=\"ghost\"\n                    size=\"sm\"\n                    onClick={() => run(\"generate\", () => onGenerate(review.id))}\n                    className=\"text-xs font-semibold text-blue-600 hover:underline inline-flex items-center gap-1 h-auto p-0\"\n                  >\n                    {busy === \"generate\" ? <RefreshCw className=\"h-3.5 w-3.5 animate-spin\" /> : <Sparkles className=\"h-3.5 w-3.5\" />}\n                    Regenerate\n                  </Button>\n                </div>\n              </div>\n\n              {isEditing ? (\n                <Textarea\n                  className=\"w-full bg-white border border-blue-200 rounded-lg p-3 text-sm focus-visible:ring-2 focus-visible:ring-blue-500 mb-3 min-h-[100px]\"\n                  value={draft}\n                  onChange={(e) => setDraft(e.target.value)}\n                />\n              ) : (\n                <p className=\"text-sm text-blue-900 italic mb-4\">&quot;{draft || \"No draft yet. Click regenerate.\"}&quot;</p>\n              )}\n\n              <div className=\"flex gap-2\">\n                {isEditing ? (\n                  <Button\n                    onClick={() => run(\"save\", () => onSave(review.id, draft))}\n                    className=\"bg-zinc-800 hover:bg-zinc-900 text-white px-4 py-2 rounded-lg text-xs font-bold transition-all inline-flex items-center gap-2\"\n                  >\n                    {busy === \"save\" ? <RefreshCw className=\"h-3 w-3 animate-spin\" /> : <CheckCircle2 className=\"h-3 w-3\" />}\n                    Save Draft\n                  </Button>\n                ) : null}\n                <Button\n                  onClick={() => run(\"publish\", () => onPublish(review.id, draft, review))}\n                  className=\"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg text-xs font-bold transition-all flex items-center gap-2 disabled:opacity-70\"\n                  disabled={!draft.trim() || busy === \"publish\"}\n                >\n                  {busy === \"publish\" ? <RefreshCw className=\"h-3 w-3 animate-spin\" /> : <Send className=\"h-3 w-3\" />}\n                  Approve & Post\n                </Button>\n              </div>\n              </CardContent>\n            </Card>\n          ) : (\n            <div className=\"mt-4 pt-4 border-t border-zinc-100 flex gap-3\">\n              <div className=\"h-8 w-8 bg-zinc-100 rounded-lg flex items-center justify-center shrink-0\">\n                <Globe className=\"h-4 w-4 text-zinc-400\" />\n              </div>\n              <Card className=\"bg-zinc-50 rounded-xl flex-1 border-zinc-100\">\n                <CardContent className=\"p-3\">\n                <p className=\"text-xs font-bold text-zinc-500 uppercase mb-1\">Your Response</p>\n                <p className=\"text-sm text-zinc-700\">{review.reply.comment}</p>\n                </CardContent>\n              </Card>\n            </div>\n          )}\n        </div>\n\n        <Button type=\"button\" variant=\"ghost\" size=\"icon\" className=\"p-1 text-zinc-300 hover:text-zinc-500 transition-colors h-7 w-7\">\n          <MoreHorizontal className=\"h-5 w-5\" />\n        </Button>\n      </CardContent>\n    </Card>\n  )\n}\n\nexport function BlitzMode({\n  reviews,\n  onClose,\n  onGenerate,\n  onPublish,\n}: {\n  reviews: ReviewRow[]\n  onClose: () => void\n  onGenerate: (reviewId: string) => Promise<void>\n  onPublish: (reviewId: string, text: string, row: ReviewRow) => Promise<void>\n}) {\n  const [index, setIndex] = React.useState(0)\n  const current = reviews[index]\n  const [draft, setDraft] = React.useState(\"\")\n  const [busy, setBusy] = React.useState<\"generate\" | \"publish\" | null>(null)\n\n  React.useEffect(() => {\n    if (!current) return\n    setDraft(current.currentDraft?.text ?? \"\")\n  }, [current])\n\n  if (!current) return null\n\n  const goNext = () => {\n    if (index < reviews.length - 1) setIndex((v) => v + 1)\n    else onClose()\n  }\n\n  const run = async (action: \"generate\" | \"publish\", fn: () => Promise<void>) => {\n    setBusy(action)\n    try {\n      await fn()\n    } catch (e) {\n      toast.error(e instanceof Error ? e.message : \"Action failed\")\n    } finally {\n      setBusy(null)\n    }\n  }\n\n  return (\n    <motion.div initial={{ opacity: 0 }} animate={{ opacity: 1 }} exit={{ opacity: 0 }} className=\"fixed inset-0 bg-white z-[100] flex flex-col\">\n      <header className=\"h-20 border-b border-zinc-200 flex items-center justify-between px-8\">\n        <div className=\"flex items-center gap-6\">\n          <Button type=\"button\" variant=\"ghost\" size=\"icon\" onClick={onClose} className=\"p-2 hover:bg-zinc-100 rounded-full transition-colors h-10 w-10\">\n            <X className=\"h-6 w-6 text-zinc-500\" />\n          </Button>\n          <div className=\"h-1 bg-zinc-100 w-48 rounded-full overflow-hidden\">\n            <motion.div className=\"h-full bg-blue-600\" animate={{ width: `${((index + 1) / reviews.length) * 100}%` }} />\n          </div>\n          <span className=\"text-sm font-bold text-zinc-500\">{index + 1} / {reviews.length}</span>\n        </div>\n        <div className=\"flex items-center gap-2 text-blue-600 bg-blue-50 px-4 py-2 rounded-full text-xs font-black uppercase tracking-widest\">\n          <Zap className=\"h-4 w-4\" />\n          Quick Reply Mode\n        </div>\n      </header>\n\n      <div className=\"flex-1 flex flex-col lg:flex-row overflow-hidden\">\n        <div className=\"lg:w-1/2 p-8 lg:p-20 overflow-y-auto bg-[#f9fafb] border-r border-zinc-200 flex items-center justify-center\">\n          <div className=\"max-w-md w-full\">\n            <div className=\"flex items-center gap-4 mb-8\">\n              <div className=\"h-14 w-14 rounded-full bg-white shadow-sm border border-zinc-100 flex items-center justify-center text-xl font-black text-blue-600\">\n                {(current.reviewer.displayName ?? \"A\").slice(0, 1).toUpperCase()}\n              </div>\n              <div>\n                <h2 className=\"text-2xl font-black text-zinc-900\">{current.reviewer.displayName ?? \"Anonymous\"}</h2>\n                <p className=\"text-zinc-500 font-medium\">{current.location.displayName}</p>\n              </div>\n            </div>\n            <div className=\"flex items-center gap-2 mb-4\">\n              <Stars rating={current.starRating} />\n              <span className=\"text-sm text-zinc-400 font-bold ml-2 uppercase tracking-tighter\">Posted {formatAge(current.createTimeIso)} ago</span>\n            </div>\n            <blockquote className=\"text-2xl font-serif text-zinc-800 leading-snug mb-10\">&quot;{current.comment}&quot;</blockquote>\n          </div>\n        </div>\n\n        <div className=\"lg:w-1/2 p-8 lg:p-20 flex flex-col justify-center\">\n          <div className=\"max-w-xl w-full mx-auto\">\n            <div className=\"flex items-center justify-between mb-4\">\n              <label className=\"text-sm font-black text-zinc-500 uppercase tracking-widest\">AI Proposed Response</label>\n              <Button type=\"button\" variant=\"ghost\" size=\"sm\" onClick={() => run(\"generate\", () => onGenerate(current.id))} className=\"flex items-center gap-2 text-blue-600 text-xs font-bold hover:underline h-auto p-0\">\n                {busy === \"generate\" ? <RefreshCw className=\"h-4 w-4 animate-spin\" /> : <Sparkles className=\"h-4 w-4\" />} Regenerate\n              </Button>\n            </div>\n\n            <Textarea\n              className=\"w-full h-64 border-2 border-blue-600 rounded-3xl p-8 text-lg text-zinc-800 focus:outline-none focus:ring-4 focus:ring-blue-100 transition-all shadow-xl shadow-blue-500/5 mb-8\"\n              value={draft}\n              onChange={(e) => setDraft(e.target.value)}\n            />\n\n            <div className=\"flex items-center gap-4\">\n              <Button type=\"button\" variant=\"secondary\" onClick={goNext} className=\"flex-1 py-5 bg-zinc-100 hover:bg-zinc-200 text-zinc-700 font-black uppercase tracking-widest rounded-2xl transition-all h-auto\">\n                Skip\n              </Button>\n              <Button\n                onClick={() => run(\"publish\", async () => { await onPublish(current.id, draft, current); goNext() })}\n                className=\"flex-[2] py-5 bg-blue-600 hover:bg-blue-700 text-white font-black uppercase tracking-widest rounded-2xl transition-all shadow-lg shadow-blue-200 flex items-center justify-center gap-3 disabled:opacity-70\"\n                disabled={!draft.trim() || busy === \"publish\"}\n              >\n                {busy === \"publish\" ? <RefreshCw className=\"h-6 w-6 animate-spin\" /> : \"Publish & Next\"}\n                <ChevronRight className=\"h-6 w-6\" />\n              </Button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </motion.div>\n  )\n}\n"
    },
    {
      "path": "app/(app)/inbox/InboxClient.tsx",
      "content": "\"use client\"\nimport * as React from \"react\"\nimport { AnimatePresence, motion } from \"framer-motion\"\nimport { toast } from \"sonner\"\nimport { cn } from \"@/lib/utils\"\nimport { withIdempotencyHeader } from \"@/lib/api/client-idempotency\"\nimport { usePaginatedReviews, type ReviewDetail, type ReviewFilter, type ReviewRow } from \"@/lib/hooks\"\nimport { BlitzMode, ReviewItem } from \"@/app/(app)/inbox/inbox-ui\"\nimport { Badge } from \"@/components/ui/badge\"\nimport { Button } from \"@/components/ui/button\"\nimport { Card, CardContent } from \"@/components/ui/card\"\nimport { Input } from \"@/components/ui/input\"\nimport { ScrollArea } from \"@/components/ui/scroll-area\"\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\"\nimport { ToggleGroup, ToggleGroupItem } from \"@/components/ui/toggle-group\"\nimport {\n  CheckCircle2,\n  Filter,\n  MessageSquare,\n  RefreshCw,\n  Search,\n  Sparkles,\n} from \"@/components/icons\"\ntype LocationOption = {\n  id: string\n  displayName: string\n}\nfunction resolveRemoteFilter(baseFilter: ReviewFilter, tab: \"all\" | \"pending\" | \"replied\"): ReviewFilter {\n  if (tab === \"replied\") {\n    return baseFilter === \"unanswered\" || baseFilter === \"urgent\" ? \"all\" : baseFilter\n  }\n  if (tab === \"all\") {\n    return baseFilter === \"unanswered\" ? \"all\" : baseFilter\n  }\n  return baseFilter\n}\ntype Props = {\n  initialFilter: ReviewFilter\n  initialMention: string | null\n  mentionKeywords: string[]\n  bulkApproveEnabled: boolean\n  locations: LocationOption[]\n  initialPage: {\n    filter: ReviewFilter\n    mention?: string | null\n    rows: ReviewRow[]\n    counts?: {\n      unanswered: number\n      urgent: number\n      five_star: number\n      mentions_total: number\n    }\n    nextCursor: string | null\n  } | null\n}\ntype ReviewMutationResponse = {\n  worker?: { claimed?: number }\n  review?: ReviewDetail | null\n}\nfunction useDebouncedValue<T>(value: T, delayMs: number) {\n  const [debounced, setDebounced] = React.useState(value)\n  React.useEffect(() => {\n    const timer = window.setTimeout(() => setDebounced(value), delayMs)\n    return () => window.clearTimeout(timer)\n  }, [value, delayMs])\n  return debounced\n}\nasync function apiCall<T>(url: string, method: string, body?: unknown): Promise<T> {\n  const upper = method.toUpperCase()\n  const mutating = [\"POST\", \"PUT\", \"PATCH\", \"DELETE\"].includes(upper)\n  const baseHeaders = body ? { \"content-type\": \"application/json\" } : undefined\n  const headers = mutating ? withIdempotencyHeader(baseHeaders) : baseHeaders\n  const res = await fetch(url, {\n    method: upper,\n    headers,\n    body: body ? JSON.stringify(body) : undefined,\n  })\n  const data = await res.json().catch(() => null)\n  if (!res.ok) {\n    const message = data?.error ?? res.statusText\n    throw new Error(message)\n  }\n  return data as T\n}\nfunction canBulkApprove(row: ReviewRow) {\n  return row.status === \"pending\" && row.starRating === 5 && row.draftStatus === \"READY\"\n}\nconst POLL_INTERVAL_MS = 450\nfunction sleep(ms: number) {\n  return new Promise((resolve) => setTimeout(resolve, ms))\n}\nasync function fetchReviewDetail(reviewId: string): Promise<ReviewDetail | null> {\n  const res = await fetch(`/api/reviews/${reviewId}`)\n  if (!res.ok) return null\n  const data = await res.json().catch(() => null)\n  return data as ReviewDetail | null\n}\nfunction mapDetailToRow(existing: ReviewRow, detail: ReviewDetail): ReviewRow {\n  const draftUpdatedAt =\n    typeof (detail.currentDraft as { updatedAt?: string } | null)?.updatedAt === \"string\"\n      ? ((detail.currentDraft as { updatedAt?: string }).updatedAt as string)\n      : existing.currentDraft?.updatedAtIso ?? new Date().toISOString()\n  return {\n    ...existing,\n    starRating: detail.starRating,\n    snippet: (detail.comment ?? \"\").slice(0, 120),\n    comment: detail.comment ?? \"\",\n    reviewer: {\n      displayName: detail.reviewer.displayName,\n      isAnonymous: detail.reviewer.isAnonymous,\n    },\n    createTimeIso: detail.createTime,\n    location: {\n      id: detail.location.id,\n      displayName: detail.location.name,\n    },\n    unanswered: detail.reply.comment == null,\n    status: detail.reply.comment == null ? \"pending\" : \"replied\",\n    reply: {\n      comment: detail.reply.comment,\n      updateTimeIso: detail.reply.updateTime,\n    },\n    currentDraft: detail.currentDraft\n      ? {\n          id: detail.currentDraft.id,\n          text: detail.currentDraft.text,\n          status: detail.currentDraft.status,\n          version: detail.currentDraft.version,\n          updatedAtIso: draftUpdatedAt,\n        }\n      : null,\n    draftStatus: detail.currentDraft?.status ?? null,\n    mentions: detail.mentions,\n  }\n}\nfunction applyDetailSnapshot(reviewId: string, detail: ReviewDetail | null | undefined, updateRow: (id: string, updater: (row: ReviewRow) => ReviewRow) => void) {\n  if (!detail) return false\n  updateRow(reviewId, (row) => mapDetailToRow(row, detail))\n  return true\n}\nfunction getVerifierBlockedMessage(detail: ReviewDetail | null) {\n  const violations = (\n    (detail?.currentDraft?.verifierResultJson as { dspy?: { verifier?: { violations?: Array<{ message?: string }> } } } | null)\n      ?.dspy?.verifier?.violations ?? []\n  )\n  const firstMessage = violations.find((item) => typeof item?.message === \"string\")?.message\n  return firstMessage?.trim() || \"Draft was blocked by verifier. Please adjust and retry.\"\n}\nasync function waitForReviewState(\n  reviewId: string,\n  predicate: (detail: ReviewDetail) => boolean,\n  timeoutMs: number,\n) {\n  const start = Date.now()\n  while (Date.now() - start < timeoutMs) {\n    const detail = await fetchReviewDetail(reviewId)\n    if (detail && predicate(detail)) {\n      return detail\n    }\n    await sleep(POLL_INTERVAL_MS)\n  }\n  return null\n}\nexport function InboxClient({\n  initialFilter,\n  initialMention,\n  mentionKeywords,\n  bulkApproveEnabled,\n  locations,\n  initialPage,\n}: Props) {\n  const normalizedMentionKeywords = React.useMemo(() => {\n    return Array.from(\n      new Set(\n        mentionKeywords\n          .map((keyword) => keyword.trim().toLowerCase())\n          .filter((keyword) => keyword.length > 0)\n      )\n    )\n  }, [mentionKeywords])\n  const initialTab = initialFilter === \"all\" ? \"all\" : \"pending\"\n  const [selectedIds, setSelectedIds] = React.useState<string[]>([])\n  const [baseFilter, setBaseFilter] = React.useState<ReviewFilter>(initialFilter)\n  const [mentionFilter, setMentionFilter] = React.useState(initialMention ?? normalizedMentionKeywords[0] ?? \"\")\n  const [searchQuery, setSearchQuery] = React.useState(\"\")\n  const [locationFilter, setLocationFilter] = React.useState(\"all\")\n  const [ratingFilter, setRatingFilter] = React.useState(\"all\")\n  const [activeTab, setActiveTab] = React.useState<\"all\" | \"pending\" | \"replied\">(initialTab)\n  const [isBulkActionLoading, setIsBulkActionLoading] = React.useState(false)\n  const [blitzMode, setBlitzMode] = React.useState(false)\n  const debouncedSearch = useDebouncedValue(searchQuery, 320)\n  const mentionSelection = mentionFilter.trim().toLowerCase()\n  const effectiveBaseFilter =\n    baseFilter === \"mentions\" && mentionSelection.length === 0 ? \"all\" : baseFilter\n  const remoteFilter = resolveRemoteFilter(effectiveBaseFilter, activeTab)\n  const normalizedMention =\n    effectiveBaseFilter === \"mentions\"\n      ? mentionSelection || undefined\n      : undefined\n  const remoteStatus = activeTab === \"pending\" ? \"pending\" : activeTab === \"replied\" ? \"replied\" : \"all\"\n  const normalizedSearch = debouncedSearch.trim()\n  const normalizedLocation = locationFilter === \"all\" ? undefined : locationFilter\n  const normalizedRating = ratingFilter === \"all\" ? undefined : Number(ratingFilter)\n  const { rows, counts, loading, loadingMore, error, hasMore, loadMore, refresh, updateRow } = usePaginatedReviews({\n    filter: remoteFilter,\n    mention: normalizedMention,\n    status: remoteStatus,\n    search: normalizedSearch || undefined,\n    locationId: normalizedLocation,\n    rating: Number.isFinite(normalizedRating) ? normalizedRating : undefined,\n    initialPage,\n  })\n  React.useEffect(() => {\n    if (!error) return\n    if (error === \"mention is required when filter=mentions.\") {\n      toast.error(\"Pick a keyword before using the mentions queue.\")\n      return\n    }\n    toast.error(error === \"SESSION_EXPIRED\" ? \"Session expired. Please sign in again.\" : error)\n  }, [error])\n  React.useEffect(() => {\n    const open = () => setBlitzMode(true)\n    window.addEventListener(\"replyai:open-blitz\", open)\n    return () => window.removeEventListener(\"replyai:open-blitz\", open)\n  }, [])\n  React.useEffect(() => {\n    setSelectedIds((prev) => prev.filter((id) => rows.some((row) => row.id === id)))\n  }, [rows])\n  React.useEffect(() => {\n    if (remoteFilter !== \"mentions\") return\n    if (mentionFilter.trim()) return\n    if (normalizedMentionKeywords.length === 0) return\n    setMentionFilter(normalizedMentionKeywords[0])\n  }, [remoteFilter, mentionFilter, normalizedMentionKeywords])\n  React.useEffect(() => {\n    if (baseFilter !== \"mentions\") return\n    if (normalizedMentionKeywords.length > 0) return\n    setBaseFilter(\"all\")\n  }, [baseFilter, normalizedMentionKeywords])\n  const pendingCount = counts?.unanswered ?? rows.filter((r) => r.status === \"pending\").length\n  const urgentCount = counts?.urgent ?? rows.filter((r) => r.status === \"pending\" && r.starRating <= 2).length\n  const fiveStarCount = counts?.five_star ?? rows.filter((r) => r.starRating === 5).length\n  const mentionCount = counts?.mentions_total ?? rows.filter((r) => r.mentions.length > 0).length\n  const eligibleSelectedIds = React.useMemo(\n    () =>\n      selectedIds.filter((id) => {\n        const row = rows.find((r) => r.id === id)\n        return row ? canBulkApprove(row) : false\n      }),\n    [rows, selectedIds]\n  )\n  const pendingForBlitz = React.useMemo(() => rows.filter((r) => r.status === \"pending\"), [rows])\n  const showInitialLoading = loading && rows.length === 0\n  const toggleSelect = (id: string) => {\n    setSelectedIds((prev) => (prev.includes(id) ? prev.filter((x) => x !== id) : [...prev, id]))\n  }\n  const selectAllFiveStars = () => {\n    setSelectedIds(rows.filter(canBulkApprove).map((r) => r.id))\n  }\n  const applyFilter = (next: ReviewFilter) => {\n    setBaseFilter(next)\n    if ((next === \"unanswered\" || next === \"urgent\") && activeTab === \"replied\") {\n      setActiveTab(\"pending\")\n    }\n    if (next === \"mentions\" && !mentionFilter.trim() && normalizedMentionKeywords[0]) {\n      setMentionFilter(normalizedMentionKeywords[0])\n    }\n  }\n  const syncRowFromServer = async (reviewId: string) => {\n    const detail = await fetchReviewDetail(reviewId)\n    if (detail) {\n      updateRow(reviewId, (row) => mapDetailToRow(row, detail))\n    }\n    return detail\n  }\n  const generateDraft = async (reviewId: string) => {\n    const previousDraftId = rows.find((row) => row.id === reviewId)?.currentDraft?.id ?? null\n    updateRow(reviewId, (row) => ({\n      ...row,\n      draftStatus: \"NEEDS_APPROVAL\",\n      currentDraft: row.currentDraft\n        ? {\n            ...row.currentDraft,\n            status: \"NEEDS_APPROVAL\",\n          }\n        : row.currentDraft,\n    }))\n    const result = await apiCall<ReviewMutationResponse>(`/api/reviews/${reviewId}/drafts/generate`, \"POST\")\n    if (applyDetailSnapshot(reviewId, result.review, updateRow)) {\n      toast.success(\"Draft regenerated\")\n      return\n    }\n    const claimed = Number(result?.worker?.claimed ?? 0)\n    if (claimed > 0) {\n      await syncRowFromServer(reviewId)\n      toast.success(\"Draft regenerated\")\n    } else {\n      const changed = await waitForReviewState(\n        reviewId,\n        (detail) => {\n          const currentDraftId = detail.currentDraft?.id ?? null\n          return previousDraftId == null ? currentDraftId != null : currentDraftId !== previousDraftId\n        },\n        5000,\n      )\n      if (changed) {\n        updateRow(reviewId, (row) => mapDetailToRow(row, changed))\n        toast.success(\"Draft regenerated\")\n      } else {\n        toast.success(\"Draft generation queued\")\n      }\n    }\n  }\n  const saveDraft = async (reviewId: string, text: string) => {\n    const result = await apiCall<ReviewMutationResponse>(`/api/reviews/${reviewId}/drafts/edit`, \"POST\", { text })\n    if (applyDetailSnapshot(reviewId, result.review, updateRow)) {\n      if (result.review?.currentDraft?.status === \"BLOCKED_BY_VERIFIER\") {\n        toast.error(getVerifierBlockedMessage(result.review))\n      } else {\n        toast.success(\"Draft saved and verified\")\n      }\n      return\n    }\n    const claimed = Number(result?.worker?.claimed ?? 0)\n    if (claimed > 0) {\n      await syncRowFromServer(reviewId)\n      toast.success(\"Draft saved and verified\")\n    } else {\n      const settled = await waitForReviewState(\n        reviewId,\n        (detail) => {\n          const status = detail.currentDraft?.status\n          return status === \"READY\" || status === \"BLOCKED_BY_VERIFIER\"\n        },\n        5500,\n      )\n      if (settled) {\n        updateRow(reviewId, (row) => mapDetailToRow(row, settled))\n        if (settled.currentDraft?.status === \"BLOCKED_BY_VERIFIER\") {\n          toast.error(getVerifierBlockedMessage(settled))\n        } else {\n          toast.success(\"Draft saved and verified\")\n        }\n      } else {\n        toast.success(\"Draft saved; verification queued\")\n      }\n    }\n  }\n  const publishReply = async (reviewId: string, text: string, row: ReviewRow) => {\n    if (!text.trim()) throw new Error(\"Draft is empty.\")\n    const current = row.currentDraft?.text.trim() ?? \"\"\n    const incoming = text.trim()\n    let verified: ReviewDetail | null = null\n    if (current !== incoming) {\n      const editResult = await apiCall<ReviewMutationResponse>(`/api/reviews/${reviewId}/drafts/edit`, \"POST\", { text: incoming })\n      if (applyDetailSnapshot(reviewId, editResult.review, updateRow)) {\n        verified = editResult.review ?? null\n      }\n      const editClaimed = Number(editResult?.worker?.claimed ?? 0)\n      if (!verified) {\n        const afterEdit = await waitForReviewState(\n          reviewId,\n          (detail) => {\n            const currentText = detail.currentDraft?.text.trim() ?? \"\"\n            const status = detail.currentDraft?.status\n            return currentText === incoming && (status === \"READY\" || status === \"BLOCKED_BY_VERIFIER\")\n          },\n          editClaimed > 0 ? 5000 : 6500,\n        )\n        if (afterEdit) {\n          updateRow(reviewId, (nextRow) => mapDetailToRow(nextRow, afterEdit))\n          verified = afterEdit\n        }\n      }\n    }\n    if (!verified) {\n      const verifyResult = await apiCall<ReviewMutationResponse>(`/api/reviews/${reviewId}/drafts/verify`, \"POST\")\n      if (applyDetailSnapshot(reviewId, verifyResult.review, updateRow)) {\n        verified = verifyResult.review ?? null\n      }\n      const verifyClaimed = Number(verifyResult?.worker?.claimed ?? 0)\n      if (!verified) {\n        verified = await waitForReviewState(\n          reviewId,\n          (detail) => {\n            const status = detail.currentDraft?.status\n            return status === \"READY\" || status === \"BLOCKED_BY_VERIFIER\"\n          },\n          verifyClaimed > 0 ? 5000 : 7000,\n        )\n      }\n    }\n    if (!verified) {\n      throw new Error(\"Verification is still processing. Please try publishing again in a few seconds.\")\n    }\n    updateRow(reviewId, (nextRow) => mapDetailToRow(nextRow, verified))\n    if (verified.currentDraft?.status !== \"READY\") {\n      throw new Error(getVerifierBlockedMessage(verified))\n    }\n    const postResult = await apiCall<ReviewMutationResponse>(`/api/reviews/${reviewId}/reply/post`, \"POST\")\n    if (applyDetailSnapshot(reviewId, postResult.review, updateRow) && postResult.review?.reply.comment) {\n      toast.success(\"Reply published\")\n      void refresh()\n      return\n    }\n    const postClaimed = Number(postResult?.worker?.claimed ?? 0)\n    const posted = await waitForReviewState(\n      reviewId,\n      (detail) => detail.reply.comment != null,\n      postClaimed > 0 ? 4500 : 7000,\n    )\n    if (posted) {\n      updateRow(reviewId, (nextRow) => mapDetailToRow(nextRow, posted))\n      toast.success(\"Reply published\")\n    } else {\n      toast.success(\"Reply posting queued\")\n    }\n    void refresh()\n  }\n  const handleBulkApprove = async () => {\n    if (!bulkApproveEnabled) {\n      toast.error(\"Bulk approve is disabled in settings.\")\n      return\n    }\n    if (eligibleSelectedIds.length === 0) {\n      toast.error(\"Select 5-star pending reviews with READY drafts.\")\n      return\n    }\n    setIsBulkActionLoading(true)\n    try {\n      await apiCall<ReviewMutationResponse>(\"/api/replies/bulk-approve\", \"POST\", { reviewIds: eligibleSelectedIds.slice(0, 50) })\n      toast.success(\"Bulk approve requested\")\n      setSelectedIds([])\n      void refresh()\n    } catch (e) {\n      toast.error(e instanceof Error ? e.message : \"Bulk approve failed\")\n    } finally {\n      setIsBulkActionLoading(false)\n    }\n  }\n  const queueCards: Array<{\n    value: ReviewFilter\n    label: string\n    count: number\n    tone: string\n  }> = [\n    { value: \"all\", label: \"All Reviews\", count: rows.length, tone: \"from-zinc-50 to-white\" },\n    { value: \"unanswered\", label: \"Needs Reply\", count: pendingCount, tone: \"from-amber-50 to-white\" },\n    { value: \"urgent\", label: \"Critical\", count: urgentCount, tone: \"from-rose-50 to-white\" },\n    { value: \"five_star\", label: \"5-Star\", count: fiveStarCount, tone: \"from-emerald-50 to-white\" },\n    { value: \"mentions\", label: \"Mentions\", count: mentionCount, tone: \"from-blue-50 to-white\" },\n  ]\n  const showMentionSelector = remoteFilter === \"mentions\" && normalizedMentionKeywords.length > 0\n  const loadingFiltered = loading && rows.length > 0\n  const disableMentionsFilter = normalizedMentionKeywords.length === 0\n  return (\n    <div className=\"flex h-full flex-col [font-family:var(--font-inbox-body)]\">\n      <Card className=\"sticky top-0 z-10 overflow-hidden rounded-none border-x-0 border-t-0 border-zinc-200 bg-white/90 backdrop-blur-xl\">\n        <div className=\"pointer-events-none absolute inset-x-0 top-0 h-24 bg-gradient-to-r from-amber-100/60 via-emerald-100/40 to-blue-100/50\" />\n        <CardContent className=\"relative flex flex-col gap-4 px-6 py-5\">\n          <div className=\"flex flex-wrap items-start justify-between gap-3\">\n            <div>\n              <p className=\"text-[10px] font-semibold uppercase tracking-[0.18em] text-zinc-500\">Review Command</p>\n              <h1 className=\"text-2xl font-semibold text-zinc-900 [font-family:var(--font-inbox-display)]\">Inbox Studio</h1>\n            </div>\n            <div className=\"flex items-center gap-2\">\n              <Badge variant=\"secondary\" className=\"border border-amber-200 bg-amber-50 px-2.5 py-1 text-xs font-semibold text-amber-800\">\n                {pendingCount} pending\n              </Badge>\n              {loadingFiltered ? (\n                <Badge variant=\"secondary\" className=\"border border-blue-200 bg-blue-50 px-2.5 py-1 text-xs font-semibold text-blue-700\">\n                  <RefreshCw className=\"mr-1 h-3 w-3 animate-spin\" />\n                  Updating\n                </Badge>\n              ) : null}\n            </div>\n          </div>\n          <div className=\"grid gap-2 md:grid-cols-3 xl:grid-cols-5\">\n            {queueCards.map((card) => (\n              <Button\n                key={card.value}\n                type=\"button\"\n                variant=\"ghost\"\n                onClick={() => applyFilter(card.value)}\n                disabled={card.value === \"mentions\" && disableMentionsFilter}\n                className={cn(\n                  \"h-auto min-h-16 flex-col items-start rounded-xl border px-3 py-2 text-left transition-all\",\n                  `bg-gradient-to-br ${card.tone}`,\n                  baseFilter === card.value\n                    ? \"border-zinc-800 shadow-sm\"\n                    : \"border-zinc-200 hover:border-zinc-300\",\n                  card.value === \"mentions\" && disableMentionsFilter ? \"cursor-not-allowed opacity-50\" : \"\"\n                )}\n              >\n                <span className=\"text-[11px] font-semibold uppercase tracking-wide text-zinc-500\">{card.label}</span>\n                <span className=\"mt-1 text-lg font-semibold text-zinc-900\">{card.count}</span>\n              </Button>\n            ))}\n          </div>\n          <div className=\"flex flex-wrap items-center gap-3\">\n            <div className=\"relative flex-1 min-w-[240px]\">\n              <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-zinc-400\" />\n              <Input\n                type=\"text\"\n                placeholder=\"Search by author, location or keywords...\"\n                className=\"h-10 border-zinc-200 bg-white pl-10 text-sm\"\n                value={searchQuery}\n                onChange={(e) => setSearchQuery(e.target.value)}\n              />\n            </div>\n            <Select value={locationFilter} onValueChange={setLocationFilter}>\n              <SelectTrigger className=\"h-10 w-[180px] border-zinc-200 bg-white text-sm font-medium\">\n                <SelectValue placeholder=\"All Locations\" />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"all\">All Locations</SelectItem>\n                {locations.map((l) => (\n                  <SelectItem key={l.id} value={l.id}>\n                    {l.displayName}\n                  </SelectItem>\n                ))}\n              </SelectContent>\n            </Select>\n            <Select value={ratingFilter} onValueChange={setRatingFilter}>\n              <SelectTrigger className=\"h-10 w-[150px] border-zinc-200 bg-white text-sm font-medium\">\n                <SelectValue placeholder=\"Any Rating\" />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"all\">Any Rating</SelectItem>\n                <SelectItem value=\"5\">5 Stars Only</SelectItem>\n                <SelectItem value=\"4\">4 Stars</SelectItem>\n                <SelectItem value=\"3\">3 Stars</SelectItem>\n                <SelectItem value=\"2\">2 Stars</SelectItem>\n                <SelectItem value=\"1\">1 Star</SelectItem>\n              </SelectContent>\n            </Select>\n            {showMentionSelector ? (\n              <Select value={mentionFilter} onValueChange={setMentionFilter}>\n                <SelectTrigger className=\"h-10 min-w-[180px] max-w-[220px] border-blue-200 bg-blue-50 text-sm font-medium text-blue-700\">\n                  <SelectValue placeholder=\"Pick mention keyword\" />\n                </SelectTrigger>\n                <SelectContent>\n                  {normalizedMentionKeywords.map((keyword) => (\n                    <SelectItem key={keyword} value={keyword}>\n                      @{keyword}\n                    </SelectItem>\n                  ))}\n                </SelectContent>\n              </Select>\n            ) : null}\n          </div>\n          <div className=\"flex flex-wrap items-center justify-between gap-3\">\n            <ToggleGroup\n              type=\"single\"\n              value={activeTab}\n              onValueChange={(value) => {\n                if (value === \"all\" || value === \"pending\" || value === \"replied\") {\n                  setActiveTab(value)\n                }\n              }}\n              className=\"gap-1 rounded-lg border border-zinc-200 bg-zinc-100/80 p-1\"\n            >\n              {([\"all\", \"pending\", \"replied\"] as const).map((tab) => (\n                <ToggleGroupItem\n                  key={tab}\n                  value={tab}\n                  className={cn(\n                    \"rounded-md px-4 py-1.5 text-sm font-medium capitalize transition-all\",\n                    \"data-[state=on]:bg-white data-[state=on]:text-zinc-900 data-[state=on]:shadow-sm\",\n                    \"text-zinc-500 hover:text-zinc-700\"\n                  )}\n                >\n                  {tab}\n                </ToggleGroupItem>\n              ))}\n            </ToggleGroup>\n            <div className=\"flex items-center gap-2\">\n              <Button\n                type=\"button\"\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={selectAllFiveStars}\n                className=\"h-auto rounded px-2 py-1.5 text-xs font-semibold text-emerald-700 hover:bg-emerald-50\"\n              >\n                <Filter className=\"mr-1 h-3.5 w-3.5\" />\n                Select 5-Stars\n              </Button>\n              <Button\n                type=\"button\"\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={() => void refresh()}\n                className=\"inline-flex h-auto items-center gap-1 rounded px-2 py-1.5 text-xs font-semibold text-zinc-500 hover:bg-zinc-50\"\n              >\n                <RefreshCw className={cn(\"h-3.5 w-3.5\", loading && \"animate-spin\")} />\n                Refresh\n              </Button>\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n      <AnimatePresence>\n        {selectedIds.length > 0 ? (\n          <motion.div\n            initial={{ y: 50, opacity: 0 }}\n            animate={{ y: 0, opacity: 1 }}\n            exit={{ y: 50, opacity: 0 }}\n            className=\"fixed bottom-20 left-1/2 z-50 flex -translate-x-1/2 items-center gap-6 rounded-2xl border border-zinc-700 bg-zinc-900 px-6 py-4 text-white shadow-2xl lg:bottom-10\"\n          >\n            <div className=\"flex items-center gap-3 border-r border-white/20 pr-6\">\n              <div className=\"flex h-8 w-8 items-center justify-center rounded-full bg-emerald-500 text-sm font-bold\">\n                {selectedIds.length}\n              </div>\n              <p className=\"text-sm font-medium\">Reviews selected</p>\n            </div>\n            <div className=\"flex items-center gap-4\">\n              <Button\n                onClick={handleBulkApprove}\n                disabled={isBulkActionLoading}\n                className=\"flex items-center gap-2 rounded-lg bg-emerald-500 px-4 py-2 text-sm font-semibold text-white transition-colors hover:bg-emerald-600 disabled:opacity-70\"\n              >\n                {isBulkActionLoading ? <RefreshCw className=\"h-4 w-4 animate-spin\" /> : <CheckCircle2 className=\"h-4 w-4\" />}\n                <span>Approve & Publish</span>\n              </Button>\n              <Button type=\"button\" variant=\"ghost\" onClick={() => setSelectedIds([])} className=\"h-auto p-0 text-sm font-medium text-zinc-400 transition-colors hover:text-white\">\n                Cancel\n              </Button>\n            </div>\n          </motion.div>\n        ) : null}\n      </AnimatePresence>\n      <ScrollArea className=\"flex-1 bg-[radial-gradient(circle_at_top_right,rgba(16,185,129,0.07),transparent_48%),radial-gradient(circle_at_bottom_left,rgba(245,158,11,0.08),transparent_52%),linear-gradient(180deg,#ffffff,#fcfcfb)]\">\n        <div className=\"space-y-4 p-6\">\n          {showInitialLoading ? (\n            <Card className=\"flex h-full min-h-[360px] flex-col items-center justify-center border-zinc-200 py-20 text-center\">\n              <CardContent className=\"pt-6\">\n                <div className=\"mx-auto mb-4 flex h-16 w-16 items-center justify-center rounded-full bg-zinc-100\">\n                  <RefreshCw className=\"h-8 w-8 text-zinc-300 animate-spin\" />\n                </div>\n                <h3 className=\"text-lg font-medium text-zinc-900 [font-family:var(--font-inbox-display)]\">Loading reviews</h3>\n                <p className=\"text-zinc-500 max-w-xs\">Fetching the latest inbox data.</p>\n              </CardContent>\n            </Card>\n          ) : rows.length === 0 ? (\n            <Card className=\"flex h-full min-h-[360px] flex-col items-center justify-center border-zinc-200 py-20 text-center\">\n              <CardContent className=\"pt-6\">\n                <div className=\"mx-auto mb-4 flex h-16 w-16 items-center justify-center rounded-full bg-zinc-100\">\n                  <MessageSquare className=\"h-8 w-8 text-zinc-300\" />\n                </div>\n                <h3 className=\"text-lg font-medium text-zinc-900 [font-family:var(--font-inbox-display)]\">No reviews found</h3>\n                <p className=\"max-w-xs text-zinc-500\">\n                  {remoteFilter === \"mentions\" && disableMentionsFilter\n                    ? \"Add mention keywords in settings to activate the mentions queue.\"\n                    : \"Try adjusting your filters or search query.\"}\n                </p>\n              </CardContent>\n            </Card>\n          ) : (\n            rows.map((review) => (\n              <ReviewItem\n                key={review.id}\n                review={review}\n                isSelected={selectedIds.includes(review.id)}\n                onToggle={() => toggleSelect(review.id)}\n                onGenerate={generateDraft}\n                onSave={saveDraft}\n                onPublish={publishReply}\n              />\n            ))\n          )}\n          {hasMore ? (\n            <div className=\"pt-2\">\n              <Button\n                type=\"button\"\n                variant=\"outline\"\n                className=\"w-full border-zinc-300 bg-white/80 font-medium hover:bg-zinc-50\"\n                onClick={loadMore}\n                disabled={loadingMore}\n              >\n                {loadingMore ? (\n                  <>\n                    <RefreshCw className=\"mr-2 h-4 w-4 animate-spin\" />\n                    Loading\n                  </>\n                ) : (\n                  <>\n                    <Sparkles className=\"mr-2 h-4 w-4 text-amber-500\" />\n                    Load more reviews\n                  </>\n                )}\n              </Button>\n            </div>\n          ) : null}\n        </div>\n      </ScrollArea>\n      <AnimatePresence>\n        {blitzMode ? (\n          <BlitzMode\n            reviews={pendingForBlitz}\n            onClose={() => setBlitzMode(false)}\n            onGenerate={generateDraft}\n            onPublish={publishReply}\n          />\n        ) : null}\n      </AnimatePresence>\n    </div>\n  )\n}\n"
    },
    {
      "path": "app/(app)/inbox/page.tsx",
      "content": "import { redirect } from \"next/navigation\"\nimport { Fraunces, Manrope } from \"next/font/google\"\nimport { getSession } from \"@/lib/session\"\nimport { InboxClient } from \"@/app/(app)/inbox/InboxClient\"\nimport { getInboxSidebarData } from \"@/lib/sidebar-data\"\nimport { listReviewsPage } from \"@/lib/reviews/query\"\nimport { REVIEWS_PAGE_SIZE } from \"@/lib/reviews/constants\"\nimport type { ReviewFilter } from \"@/lib/hooks\"\n\nconst inboxDisplayFont = Fraunces({\n  subsets: [\"latin\"],\n  variable: \"--font-inbox-display\",\n  weight: [\"500\", \"700\"],\n})\n\nconst inboxBodyFont = Manrope({\n  subsets: [\"latin\"],\n  variable: \"--font-inbox-body\",\n  weight: [\"400\", \"500\", \"600\", \"700\"],\n})\n\nfunction parseFilter(input: string | undefined): ReviewFilter {\n  const v = (input ?? \"\").toLowerCase()\n  if (v === \"unanswered\" || v === \"urgent\" || v === \"five_star\" || v === \"mentions\" || v === \"all\") {\n    return v\n  }\n  return \"unanswered\"\n}\n\nexport default async function InboxPage({\n  searchParams,\n}: {\n  searchParams: Promise<{ filter?: string; mention?: string }>\n}) {\n  const session = await getSession()\n  if (!session?.user?.id || !session.orgId) redirect(\"/signin\")\n\n  const sp = await searchParams\n  const parsedFilter = parseFilter(sp.filter)\n  const initialRemoteFilter: ReviewFilter = parsedFilter\n  const initialMention = sp.mention?.trim().toLowerCase() ?? null\n\n  const initialPage = await listReviewsPage({\n    orgId: session.orgId,\n    filter: initialRemoteFilter,\n    mention: initialMention ?? undefined,\n    limit: REVIEWS_PAGE_SIZE,\n  })\n\n  const { settings, locations } = await getInboxSidebarData(session.orgId)\n\n  return (\n    <div className={`${inboxDisplayFont.variable} ${inboxBodyFont.variable}`}>\n      <InboxClient\n        initialFilter={parsedFilter}\n        initialMention={initialMention}\n        mentionKeywords={settings?.mentionKeywords ?? []}\n        bulkApproveEnabled={settings?.bulkApproveEnabledForFiveStar ?? true}\n        locations={locations}\n        initialPage={{\n          filter: initialRemoteFilter,\n          mention: initialMention,\n          rows: initialPage.rows,\n          counts: initialPage.counts,\n          nextCursor: initialPage.nextCursor,\n        }}\n      />\n    </div>\n  )\n}\n"
    },
    {
      "path": "app/(app)/layout.tsx",
      "content": "import type { ReactNode } from \"react\"\nimport { redirect } from \"next/navigation\"\nimport { getSession } from \"@/lib/session\"\nimport { AppShell } from \"@/components/AppShell\"\n\nexport default async function AppLayout({ children }: { children: ReactNode }) {\n  const session = await getSession()\n  if (!session?.user?.id || !session.orgId) redirect(\"/signin\")\n\n  return (\n    <AppShell\n      user={{\n        name: session.user.name ?? null,\n        email: session.user.email ?? null,\n        image: session.user.image ?? null,\n        role: session.role ?? \"\",\n      }}\n    >\n      {children}\n    </AppShell>\n  )\n}\n\n"
    },
    {
      "path": "app/(app)/loading.tsx",
      "content": "export default function AppSectionLoading() {\n  return (\n    <div className=\"p-6 lg:p-8 space-y-4 animate-pulse\">\n      <div className=\"h-8 w-40 rounded-lg bg-zinc-200\" />\n      <div className=\"h-4 w-64 rounded bg-zinc-100\" />\n\n      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4 pt-4\">\n        <div className=\"h-28 rounded-2xl bg-white border border-zinc-200\" />\n        <div className=\"h-28 rounded-2xl bg-white border border-zinc-200\" />\n        <div className=\"h-28 rounded-2xl bg-white border border-zinc-200\" />\n      </div>\n\n      <div className=\"h-80 rounded-2xl bg-white border border-zinc-200\" />\n    </div>\n  )\n}\n"
    },
    {
      "path": "app/(app)/locations/page.tsx",
      "content": "import { redirect } from \"next/navigation\"\nimport { getSession } from \"@/lib/session\"\nimport { LocationSelectorClient } from \"@/app/(app)/onboarding/locations/location-selector-client\"\nimport { getLocationsSidebarData } from \"@/lib/sidebar-data\"\n\nexport default async function LocationsPage() {\n  const session = await getSession()\n  if (!session?.user?.id || !session.orgId) redirect(\"/signin\")\n\n  const locations = await getLocationsSidebarData(session.orgId)\n\n  return <LocationSelectorClient mode=\"manage\" locations={locations} />\n}\n"
    },
    {
      "path": "app/(app)/onboarding/locations/location-selector-client.tsx",
      "content": "\"use client\"\n\nimport * as React from \"react\"\nimport { useRouter } from \"next/navigation\"\nimport { toast } from \"sonner\"\nimport { useGlobalSearch } from \"@/components/search-context\"\nimport { Button } from \"@/components/ui/button\"\nimport { Card, CardContent } from \"@/components/ui/card\"\nimport { Checkbox } from \"@/components/ui/checkbox\"\nimport { Badge } from \"@/components/ui/badge\"\nimport { Avatar, AvatarFallback } from \"@/components/ui/avatar\"\nimport { RefreshCw, Search, MapPin, Loader2, LayoutDashboard, CheckCircle2 } from \"@/components/icons\"\nimport { withIdempotencyHeader } from \"@/lib/api/client-idempotency\"\nimport { cn } from \"@/lib/utils\"\n\ntype LocationRow = {\n  id: string\n  displayName: string\n  storeCode: string | null\n  addressSummary: string | null\n  enabled: boolean\n}\n\nexport function LocationSelectorClient({\n  mode,\n  locations,\n}: {\n  mode: \"onboarding\" | \"manage\"\n  locations: LocationRow[]\n}) {\n  const router = useRouter()\n  const { query } = useGlobalSearch()\n\n  const [busy, setBusy] = React.useState(false)\n  const [syncing, setSyncing] = React.useState(false)\n  const [selected, setSelected] = React.useState<Set<string>>(\n    () => new Set(locations.filter((l) => l.enabled).map((l) => l.id))\n  )\n\n  React.useEffect(() => {\n    setSelected(new Set(locations.filter((l) => l.enabled).map((l) => l.id)))\n  }, [locations])\n\n  const visible = React.useMemo(() => {\n    const q = query.trim().toLowerCase()\n    if (!q) return locations\n    return locations.filter((l) => {\n      return (\n        l.displayName.toLowerCase().includes(q) ||\n        (l.storeCode ?? \"\").toLowerCase().includes(q) ||\n        (l.addressSummary ?? \"\").toLowerCase().includes(q)\n      )\n    })\n  }, [locations, query])\n\n  const selectAll = () => setSelected(new Set(visible.map((l) => l.id)))\n  const deselectAll = () => setSelected(new Set())\n\n  const toggle = (id: string, val: boolean) => {\n    setSelected((prev) => {\n      const next = new Set(prev)\n      if (val) next.add(id)\n      else next.delete(id)\n      return next\n    })\n  }\n\n  const runSyncPolling = async () => {\n    const start = Date.now()\n    while (Date.now() - start < 20_000) {\n      await new Promise((r) => setTimeout(r, 2000))\n      router.refresh()\n    }\n  }\n\n  const syncFromGoogle = async () => {\n    setSyncing(true)\n    try {\n      const res = await fetch(\"/api/google/sync-locations\", {\n        method: \"POST\",\n        headers: withIdempotencyHeader(),\n      })\n      if (res.status === 401) {\n        router.replace(\"/signin\")\n        return\n      }\n      const data = await res.json().catch(() => null)\n      if (!res.ok) throw new Error(data?.error ?? res.statusText)\n      toast.success(\"Sync started\", { description: data?.jobId ? `Job ${data.jobId}` : undefined })\n      void runSyncPolling()\n    } catch (e) {\n      toast.error(e instanceof Error ? e.message : String(e))\n    } finally {\n      setSyncing(false)\n    }\n  }\n\n  const save = async () => {\n    setBusy(true)\n    try {\n      const res = await fetch(\"/api/locations/select\", {\n        method: \"POST\",\n        headers: withIdempotencyHeader({ \"content-type\": \"application/json\" }),\n        body: JSON.stringify({ enabledLocationIds: Array.from(selected) }),\n      })\n      if (res.status === 401) {\n        router.replace(\"/signin\")\n        return\n      }\n      const data = await res.json().catch(() => null)\n      if (!res.ok) throw new Error(data?.error ?? res.statusText)\n      toast.success(\"Saved\", { description: data?.worker?.claimed ? `Worker claimed ${data.worker.claimed}` : undefined })\n      router.refresh()\n      if (mode === \"onboarding\") router.push(\"/inbox\")\n    } catch (e) {\n      toast.error(e instanceof Error ? e.message : String(e))\n    } finally {\n      setBusy(false)\n    }\n  }\n\n  return (\n    <div className=\"p-6 lg:p-8 space-y-8 max-w-4xl mx-auto\">\n      {/* Header */}\n      <div className=\"flex items-start justify-between gap-4\">\n        <div className=\"flex items-center gap-4\">\n          <div className=\"h-12 w-12 rounded-2xl bg-muted flex items-center justify-center border border-border\">\n            <LayoutDashboard className=\"size-5 text-muted-foreground\" />\n          </div>\n          <div>\n            <h1 className=\"text-2xl font-bold tracking-tight text-foreground\">\n              {mode === \"onboarding\" ? \"Choose Locations\" : \"Locations\"}\n            </h1>\n            <p className=\"text-sm text-muted-foreground font-medium\">\n              Enable locations to sync and manage reviews\n            </p>\n          </div>\n        </div>\n        <Button\n          type=\"button\"\n          variant=\"outline\"\n          size=\"sm\"\n          className=\"rounded-xl gap-2 h-9 text-xs border-border font-semibold\"\n          onClick={syncFromGoogle}\n          disabled={syncing}\n        >\n          {syncing ? <Loader2 className=\"size-3.5 animate-spin\" /> : <RefreshCw className=\"size-3.5\" />}\n          {syncing ? \"Syncingâ€¦\" : \"Sync from Google\"}\n        </Button>\n      </div>\n\n      {/* Selection bar */}\n      <Card className=\"rounded-2xl border-border bg-card shadow-card\">\n        <CardContent className=\"p-4\">\n          <div className=\"flex items-center gap-3\">\n            <Badge variant=\"secondary\" className=\"rounded-md text-[11px] tabular-nums h-6 px-2.5 bg-muted text-muted-foreground font-semibold\">\n              {selected.size} selected\n            </Badge>\n            <div className=\"ml-auto flex items-center gap-2\">\n              <Button type=\"button\" size=\"sm\" variant=\"ghost\" className=\"rounded-xl h-8 text-xs text-muted-foreground font-medium\" onClick={selectAll}>\n                Select all\n              </Button>\n              <Button type=\"button\" size=\"sm\" variant=\"ghost\" className=\"rounded-xl h-8 text-xs text-muted-foreground font-medium\" onClick={deselectAll}>\n                Deselect all\n              </Button>\n              <Button\n                type=\"button\"\n                size=\"sm\"\n                className=\"rounded-xl h-8 text-xs gap-2 bg-primary hover:bg-primary/90 text-primary-foreground shadow-elevated min-w-[90px]\"\n                onClick={save}\n                disabled={busy}\n              >\n                {busy ? <Loader2 className=\"size-3 animate-spin\" /> : null}\n                {busy ? \"Savingâ€¦\" : \"Save\"}\n              </Button>\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Location cards */}\n      <div className=\"space-y-3\">\n        {visible.length === 0 ? (\n          <div className=\"flex flex-col items-center justify-center py-24\">\n            <div className=\"h-24 w-24 bg-card shadow-sm rounded-3xl flex items-center justify-center mb-6 border border-border\">\n              <Search className=\"h-10 w-10 opacity-20\" />\n            </div>\n            <p className=\"text-sm font-medium text-foreground\">No locations found</p>\n            <p className=\"text-xs text-muted-foreground mt-1.5\">Try adjusting your search or sync from Google.</p>\n          </div>\n        ) : (\n          visible.map((l) => {\n            const isEnabled = selected.has(l.id)\n\n            return (\n              <div key={l.id}>\n                <Card\n                  className={cn(\n                    \"rounded-2xl border-border bg-card shadow-card cursor-pointer transition-all hover:shadow-elevated\",\n                    isEnabled ? \"border-primary/30 bg-primary/10\" : \"\"\n                  )}\n                  onClick={() => toggle(l.id, !isEnabled)}\n                >\n                  <CardContent className=\"p-5\">\n                    <div className=\"flex items-center gap-4\">\n                      <Checkbox\n                        checked={isEnabled}\n                        onCheckedChange={(v) => toggle(l.id, Boolean(v))}\n                        onClick={(e) => e.stopPropagation()}\n                      />\n\n                      <Avatar className=\"h-11 w-11 border border-border shadow-sm\">\n                        <AvatarFallback className={cn(\"font-semibold text-xs\", isEnabled ? \"bg-primary/10 text-primary\" : \"bg-muted text-muted-foreground\")}>\n                          <MapPin className=\"size-4\" />\n                        </AvatarFallback>\n                      </Avatar>\n\n                      <div className=\"min-w-0 flex-1\">\n                        <div className=\"flex items-center gap-2.5\">\n                          <span className=\"text-sm font-bold truncate text-foreground\">{l.displayName}</span>\n                          {isEnabled && (\n                            <Badge variant=\"secondary\" className=\"rounded-md text-[9px] px-2 h-5 gap-1 bg-emerald-100 text-emerald-700 font-bold uppercase tracking-wider\">\n                              <CheckCircle2 className=\"size-2.5\" /> enabled\n                            </Badge>\n                          )}\n                        </div>\n                        <div className=\"flex items-center gap-2 mt-1\">\n                          {l.storeCode && (\n                            <>\n                              <Badge variant=\"secondary\" className=\"rounded-md text-[9px] font-mono h-5 px-2 bg-muted text-muted-foreground\">\n                                {l.storeCode}\n                              </Badge>\n                              <span className=\"text-muted-foreground/60\">â€¢</span>\n                            </>\n                          )}\n                          <span className=\"text-xs text-muted-foreground truncate font-medium\">\n                            {l.addressSummary ?? \"â€”\"}\n                          </span>\n                        </div>\n                      </div>\n                    </div>\n                  </CardContent>\n                </Card>\n              </div>\n            )\n          })\n        )}\n      </div>\n    </div>\n  )\n}\n"
    },
    {
      "path": "app/(app)/onboarding/locations/page.tsx",
      "content": "import { redirect } from \"next/navigation\"\nimport { prisma } from \"@/lib/db\"\nimport { getSession } from \"@/lib/session\"\nimport { LocationSelectorClient } from \"@/app/(app)/onboarding/locations/location-selector-client\"\n\nexport default async function OnboardingLocationsPage() {\n  const session = await getSession()\n  if (!session?.user?.id || !session.orgId) redirect(\"/signin\")\n\n  const locations = await prisma.location.findMany({\n    where: { orgId: session.orgId },\n    orderBy: { displayName: \"asc\" },\n    select: {\n      id: true,\n      displayName: true,\n      storeCode: true,\n      addressSummary: true,\n      enabled: true,\n    },\n  })\n\n  return <LocationSelectorClient mode=\"onboarding\" locations={locations} />\n}\n\n"
    },
    {
      "path": "app/(app)/performance/page.tsx",
      "content": "import type { ReactNode } from \"react\"\nimport { redirect } from \"next/navigation\"\nimport { getSession } from \"@/lib/session\"\nimport { getPerformanceSidebarData } from \"@/lib/sidebar-data\"\nimport { Badge } from \"@/components/ui/badge\"\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\"\nimport { BarChart, CheckCircle2, Sparkles, Star } from \"@/components/icons\"\n\nfunction formatPct(value: number) {\n  return `${(value * 100).toFixed(1)}%`\n}\n\nexport default async function PerformancePage() {\n  const session = await getSession()\n  if (!session?.user?.id || !session.orgId) redirect(\"/signin\")\n\n  const { summary, aiDraftedInRange } = await getPerformanceSidebarData(session.orgId)\n\n  const aiContribution =\n    summary.kpis.totalReviews > 0 ? aiDraftedInRange / summary.kpis.totalReviews : 0\n\n  return (\n    <div className=\"max-w-6xl mx-auto p-10 space-y-10\">\n      <div className=\"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-5 gap-6\">\n        <StatItem\n          label=\"Response Rate\"\n          value={formatPct(summary.kpis.replyRate)}\n          trend={`${summary.kpis.totalReviews} reviews`}\n          icon={<CheckCircle2 className=\"h-5 w-5\" />}\n          color=\"blue\"\n        />\n        <StatItem\n          label=\"Avg Rating\"\n          value={summary.kpis.avgRating.toFixed(1)}\n          trend={`Flagged ${summary.kpis.flaggedClaims}`}\n          icon={<Star className=\"h-5 w-5\" />}\n          color=\"yellow\"\n        />\n        <StatItem\n          label=\"AI Contribution\"\n          value={formatPct(aiContribution)}\n          trend={`${aiDraftedInRange} drafted`}\n          icon={<Sparkles className=\"h-5 w-5\" />}\n          color=\"indigo\"\n        />\n        <StatItem\n          label=\"SEO Coverage\"\n          value={formatPct(summary.kpis.avgSeoKeywordCoverage)}\n          trend={`${summary.kpis.seoStuffingRiskCount} stuffing risks`}\n          icon={<Sparkles className=\"h-5 w-5\" />}\n          color=\"blue\"\n        />\n        <StatItem\n          label=\"AI Block Rate\"\n          value={formatPct(summary.kpis.aiBlockedRate)}\n          trend={`${formatPct(summary.kpis.requiredKeywordUsageRate)} keyword usage`}\n          icon={<CheckCircle2 className=\"h-5 w-5\" />}\n          color=\"yellow\"\n        />\n      </div>\n\n      <Card className=\"border-zinc-200 rounded-3xl shadow-sm h-[400px] flex items-center justify-center text-zinc-400\">\n        <CardContent className=\"text-center p-8\">\n          <BarChart className=\"h-12 w-12 mx-auto mb-4 opacity-20\" />\n          <p className=\"font-medium\">Response Trend ({summary.range.days} days)</p>\n          <p className=\"text-sm opacity-60\">\n            {summary.series.daily.reduce((sum, d) => sum + d.replied, 0)} replies posted in current window\n          </p>\n        </CardContent>\n      </Card>\n\n      <Card className=\"border-zinc-200 rounded-3xl shadow-sm\">\n        <CardHeader className=\"pb-2\">\n          <CardTitle className=\"text-lg\">DSPy Program Quality</CardTitle>\n        </CardHeader>\n        <CardContent className=\"space-y-3\">\n          <p className=\"text-sm text-zinc-600\">\n            Active program:{\" \"}\n            <span className=\"font-mono text-zinc-900\">\n              {summary.dspy.activeProgramVersion ?? \"unknown\"}\n            </span>\n          </p>\n          {summary.dspy.programVersions.length ? (\n            <div className=\"space-y-2\">\n              {summary.dspy.programVersions.map((item) => (\n                <div\n                  key={`${item.version}:${item.draftArtifactVersion}:${item.verifyArtifactVersion}`}\n                  className=\"rounded-xl border border-zinc-200 p-3\"\n                >\n                  <p className=\"text-xs font-semibold text-zinc-700\">\n                    <span className=\"font-mono\">{item.version}</span> Â· {item.runs} runs\n                  </p>\n                  <p className=\"text-xs text-zinc-500 mt-1\">\n                    Blocked: {formatPct(item.blockedRate)} Â· Coverage: {formatPct(item.avgKeywordCoverage)} Â· Required keyword usage: {formatPct(item.requiredKeywordUsageRate)}\n                  </p>\n                </div>\n              ))}\n            </div>\n          ) : (\n            <p className=\"text-sm text-zinc-500\">No DSPy runs in the selected range.</p>\n          )}\n        </CardContent>\n      </Card>\n    </div>\n  )\n}\n\nfunction StatItem({\n  label,\n  value,\n  trend,\n  icon,\n  color,\n}: {\n  label: string\n  value: string\n  trend: string\n  icon: ReactNode\n  color: \"blue\" | \"yellow\" | \"indigo\"\n}) {\n  const colors = {\n    blue: \"bg-blue-50 text-blue-600\",\n    yellow: \"bg-yellow-50 text-yellow-600\",\n    indigo: \"bg-indigo-50 text-indigo-600\",\n  } as const\n\n  return (\n    <Card className=\"border-zinc-200 rounded-2xl shadow-sm\">\n      <CardHeader className=\"p-6 pb-3\">\n        <div className=\"flex items-center justify-between\">\n          <div className={`p-2 rounded-lg ${colors[color]}`}>{icon}</div>\n          <Badge variant=\"secondary\" className=\"text-xs font-bold text-zinc-600 bg-zinc-100 px-2 py-1 rounded-full border-transparent\">\n            {trend}\n          </Badge>\n        </div>\n      </CardHeader>\n      <CardContent className=\"px-6 pb-6 pt-0\">\n        <p className=\"text-sm font-bold text-zinc-500 uppercase tracking-wider mb-1\">{label}</p>\n        <CardTitle className=\"text-3xl font-black text-zinc-900\">{value}</CardTitle>\n      </CardContent>\n    </Card>\n  )\n}\n"
    },
    {
      "path": "app/(app)/reviews/[id]/page.tsx",
      "content": "import { redirect } from \"next/navigation\"\nimport { getSession } from \"@/lib/session\"\nimport { ReviewPageClient } from \"@/app/(app)/reviews/[id]/review-page-client\"\n\nexport default async function ReviewPage({ params }: { params: Promise<{ id: string }> }) {\n  const session = await getSession()\n  if (!session?.user?.id || !session.orgId) redirect(\"/signin\")\n\n  const { id } = await params\n  return <ReviewPageClient reviewId={id} />\n}\n\n"
    },
    {
      "path": "app/(app)/reviews/[id]/review-page-client.tsx",
      "content": "\"use client\"\n\nimport { motion } from \"framer-motion\"\nimport { ReviewDetail } from \"@/components/ReviewDetail\"\n\nexport function ReviewPageClient({ reviewId }: { reviewId: string }) {\n  return (\n    <motion.div\n      initial={{ opacity: 0, y: 8 }}\n      animate={{ opacity: 1, y: 0 }}\n      transition={{ duration: 0.25 }}\n      className=\"h-full flex flex-col bg-background\"\n    >\n      <div className=\"flex-1 overflow-hidden\">\n        <ReviewDetail reviewId={reviewId} backHref=\"/inbox\" />\n      </div>\n    </motion.div>\n  )\n}\n"
    },
    {
      "path": "app/(app)/settings/page.tsx",
      "content": "import { redirect } from \"next/navigation\"\nimport { getSession } from \"@/lib/session\"\nimport { SettingsClient } from \"@/app/(app)/settings/settings-client\"\nimport { getSettingsSidebarData } from \"@/lib/sidebar-data\"\nimport { DEFAULT_AUTODRAFT_RATINGS, DEFAULT_MENTION_KEYWORDS } from \"@/lib/policy\"\n\nexport default async function SettingsPage() {\n  const session = await getSession()\n  if (!session?.user?.id || !session.orgId) redirect(\"/signin\")\n\n  const { org, settings, google, locations } = await getSettingsSidebarData(session.orgId)\n\n  return (\n    <SettingsClient\n      orgName={org?.name ?? \"Organization\"}\n      googleConnection={google}\n      locations={locations}\n      showBulkApprove\n      settings={{\n        tonePreset: settings?.tonePreset ?? \"friendly\",\n        toneCustomInstructions: settings?.toneCustomInstructions ?? null,\n        autoDraftEnabled: settings?.autoDraftEnabled ?? true,\n        autoDraftForRatings: settings?.autoDraftForRatings ?? [...DEFAULT_AUTODRAFT_RATINGS],\n        bulkApproveEnabledForFiveStar: settings?.bulkApproveEnabledForFiveStar ?? true,\n        mentionKeywords: settings?.mentionKeywords ?? [...DEFAULT_MENTION_KEYWORDS],\n      }}\n    />\n  )\n}\n"
    },
    {
      "path": "app/(app)/settings/seo-profiles-editor.tsx",
      "content": "\"use client\"\n\nimport * as React from \"react\"\nimport { toast } from \"sonner\"\nimport { Badge } from \"@/components/ui/badge\"\nimport { Button } from \"@/components/ui/button\"\nimport { Card, CardContent } from \"@/components/ui/card\"\nimport { Input } from \"@/components/ui/input\"\nimport { Label } from \"@/components/ui/label\"\nimport { Separator } from \"@/components/ui/separator\"\nimport { Save, Globe, Loader2, MapPin, Plus, X } from \"@/components/icons\"\nimport { SEO_PROFILE_LIMITS } from \"@/lib/policy\"\nimport { cn } from \"@/lib/utils\"\n\ntype KeywordBucket = \"primaryKeywords\" | \"secondaryKeywords\" | \"geoTerms\"\n\ntype EditorState = {\n  primaryKeywords: string\n  secondaryKeywords: string\n  geoTerms: string\n}\n\nexport type SeoLocationProfilePayload = {\n  locationId: string\n  displayName: string\n  primaryKeywords: string[]\n  secondaryKeywords: string[]\n  geoTerms: string[]\n}\n\ntype SeoProfilesEditorProps = {\n  initialProfiles: SeoLocationProfilePayload[]\n  saving: boolean\n  onSave: (profiles: SeoLocationProfilePayload[]) => Promise<void>\n}\n\nconst BUCKET_CONFIG: Record<\n  KeywordBucket,\n  { label: string; hint: string; max: number; placeholder: string }\n> = {\n  primaryKeywords: {\n    label: \"Primary Keywords\",\n    hint: \"Main phrases your business should rank for.\",\n    max: SEO_PROFILE_LIMITS.PRIMARY_MAX,\n    placeholder: \"e.g. tikka masala\",\n  },\n  secondaryKeywords: {\n    label: \"Secondary Keywords\",\n    hint: \"Supporting terms that can appear naturally.\",\n    max: SEO_PROFILE_LIMITS.SECONDARY_MAX,\n    placeholder: \"e.g. family dinner\",\n  },\n  geoTerms: {\n    label: \"Geo Terms\",\n    hint: \"Local area modifiers for location relevance.\",\n    max: SEO_PROFILE_LIMITS.GEO_MAX,\n    placeholder: \"e.g. downtown austin\",\n  },\n}\n\nfunction normalizeKeyword(raw: string) {\n  const value = raw.trim().toLowerCase()\n  if (!value) return null\n  if (value.length > SEO_PROFILE_LIMITS.KEYWORD_MAX_LENGTH) return null\n  return value\n}\n\nfunction emptyInputState() {\n  return {\n    primaryKeywords: \"\",\n    secondaryKeywords: \"\",\n    geoTerms: \"\",\n  } satisfies EditorState\n}\n\nexport function SeoProfilesEditor({ initialProfiles, saving, onSave }: SeoProfilesEditorProps) {\n  const [profiles, setProfiles] = React.useState<SeoLocationProfilePayload[]>(initialProfiles)\n  const [inputs, setInputs] = React.useState<Record<string, EditorState>>({})\n\n  React.useEffect(() => {\n    setProfiles(initialProfiles)\n  }, [initialProfiles])\n\n  const setInputValue = (locationId: string, bucket: KeywordBucket, value: string) => {\n    setInputs((previous) => ({\n      ...previous,\n      [locationId]: {\n        ...(previous[locationId] ?? emptyInputState()),\n        [bucket]: value,\n      },\n    }))\n  }\n\n  const addKeyword = (locationId: string, bucket: KeywordBucket) => {\n    const nextValue = normalizeKeyword(inputs[locationId]?.[bucket] ?? \"\")\n    if (!nextValue) {\n      toast.error(`Keyword must be 1-${SEO_PROFILE_LIMITS.KEYWORD_MAX_LENGTH} characters.`)\n      return\n    }\n\n    const limit = BUCKET_CONFIG[bucket].max\n    let duplicate = false\n    let overLimit = false\n    setProfiles((previous) =>\n      previous.map((profile) => {\n        if (profile.locationId !== locationId) return profile\n        const bucketValues = profile[bucket]\n        if (bucketValues.includes(nextValue)) {\n          duplicate = true\n          return profile\n        }\n        if (bucketValues.length >= limit) {\n          overLimit = true\n          return profile\n        }\n        return { ...profile, [bucket]: [...bucketValues, nextValue] }\n      }),\n    )\n\n    if (duplicate) {\n      setInputValue(locationId, bucket, \"\")\n      return\n    }\n    if (overLimit) {\n      toast.error(`Maximum ${limit} keywords for ${BUCKET_CONFIG[bucket].label.toLowerCase()}.`)\n      return\n    }\n    setInputValue(locationId, bucket, \"\")\n  }\n\n  const removeKeyword = (locationId: string, bucket: KeywordBucket, keyword: string) => {\n    setProfiles((previous) =>\n      previous.map((profile) => {\n        if (profile.locationId !== locationId) return profile\n        return {\n          ...profile,\n          [bucket]: profile[bucket].filter((value) => value !== keyword),\n        }\n      }),\n    )\n  }\n\n  return (\n    <Card className=\"rounded-2xl border-border bg-card shadow-card\">\n      <CardContent className=\"p-6 space-y-6\">\n        <div className=\"flex items-start justify-between gap-3\">\n          <div className=\"space-y-1\">\n            <div className=\"text-sm font-bold text-foreground\">Location SEO Profiles</div>\n            <p className=\"text-xs text-muted-foreground leading-relaxed font-medium max-w-xl\">\n              DSPy will use these keywords to produce replies that are locally relevant and SEO aligned without\n              keyword stuffing.\n            </p>\n          </div>\n          <Badge variant=\"secondary\" className=\"rounded-md font-mono text-[9px] h-5 px-2 bg-muted text-muted-foreground\">\n            {profiles.length} location{profiles.length === 1 ? \"\" : \"s\"}\n          </Badge>\n        </div>\n\n        {profiles.length === 0 ? (\n          <div className=\"rounded-2xl border-2 border-dashed border-border p-8 text-center\">\n            <p className=\"text-sm text-muted-foreground font-medium\">No enabled locations available.</p>\n            <p className=\"text-xs text-muted-foreground mt-1\">Enable locations first to configure SEO profiles.</p>\n          </div>\n        ) : (\n          <div className=\"space-y-4\">\n            {profiles.map((profile) => (\n              <div key={profile.locationId} className=\"rounded-2xl border border-border bg-muted/30 p-4 space-y-4\">\n                <div className=\"flex items-center gap-2 min-w-0\">\n                  <div className=\"h-7 w-7 rounded-lg border border-border bg-card flex items-center justify-center shrink-0\">\n                    <MapPin className=\"size-3.5 text-muted-foreground\" />\n                  </div>\n                  <div className=\"text-sm font-semibold text-foreground truncate\">{profile.displayName}</div>\n                </div>\n\n                <KeywordBucketEditor\n                  bucket=\"primaryKeywords\"\n                  values={profile.primaryKeywords}\n                  inputValue={inputs[profile.locationId]?.primaryKeywords ?? \"\"}\n                  onInputChange={(value) => setInputValue(profile.locationId, \"primaryKeywords\", value)}\n                  onAdd={() => addKeyword(profile.locationId, \"primaryKeywords\")}\n                  onRemove={(keyword) => removeKeyword(profile.locationId, \"primaryKeywords\", keyword)}\n                />\n                <Separator className=\"bg-border\" />\n                <KeywordBucketEditor\n                  bucket=\"secondaryKeywords\"\n                  values={profile.secondaryKeywords}\n                  inputValue={inputs[profile.locationId]?.secondaryKeywords ?? \"\"}\n                  onInputChange={(value) => setInputValue(profile.locationId, \"secondaryKeywords\", value)}\n                  onAdd={() => addKeyword(profile.locationId, \"secondaryKeywords\")}\n                  onRemove={(keyword) => removeKeyword(profile.locationId, \"secondaryKeywords\", keyword)}\n                />\n                <Separator className=\"bg-border\" />\n                <KeywordBucketEditor\n                  bucket=\"geoTerms\"\n                  values={profile.geoTerms}\n                  inputValue={inputs[profile.locationId]?.geoTerms ?? \"\"}\n                  onInputChange={(value) => setInputValue(profile.locationId, \"geoTerms\", value)}\n                  onAdd={() => addKeyword(profile.locationId, \"geoTerms\")}\n                  onRemove={(keyword) => removeKeyword(profile.locationId, \"geoTerms\", keyword)}\n                />\n              </div>\n            ))}\n          </div>\n        )}\n\n        <div className=\"flex justify-end\">\n          <Button\n            type=\"button\"\n            size=\"sm\"\n            className=\"rounded-xl gap-2 h-9 text-xs bg-primary hover:bg-primary/90 text-primary-foreground shadow-elevated min-w-[120px]\"\n            disabled={saving || profiles.length === 0}\n            onClick={() => onSave(profiles)}\n          >\n            {saving ? <Loader2 className=\"size-3.5 animate-spin\" /> : <Save className=\"size-3.5\" />}\n            {saving ? \"Savingâ€¦\" : \"Save SEO Profiles\"}\n          </Button>\n        </div>\n      </CardContent>\n    </Card>\n  )\n}\n\ntype KeywordBucketEditorProps = {\n  bucket: KeywordBucket\n  values: string[]\n  inputValue: string\n  onInputChange: (value: string) => void\n  onAdd: () => void\n  onRemove: (keyword: string) => void\n}\n\nfunction KeywordBucketEditor({\n  bucket,\n  values,\n  inputValue,\n  onInputChange,\n  onAdd,\n  onRemove,\n}: KeywordBucketEditorProps) {\n  const config = BUCKET_CONFIG[bucket]\n\n  return (\n    <div className=\"space-y-3\">\n      <div className=\"flex items-center justify-between gap-2\">\n        <div className=\"space-y-1\">\n          <Label className=\"text-xs font-bold text-muted-foreground uppercase tracking-widest\">{config.label}</Label>\n          <p className=\"text-xs text-muted-foreground font-medium\">{config.hint}</p>\n        </div>\n        <Badge variant=\"secondary\" className=\"rounded-md font-mono text-[9px] h-5 px-2 bg-muted text-muted-foreground\">\n          {values.length}/{config.max}\n        </Badge>\n      </div>\n\n      <div className=\"flex items-center gap-2\">\n        <Input\n          className={cn(\"rounded-xl h-9 text-sm border-border\", values.length >= config.max && \"opacity-50\")}\n          value={inputValue}\n          placeholder={config.placeholder}\n          onChange={(event) => onInputChange(event.target.value)}\n          onKeyDown={(event) => {\n            if (event.key !== \"Enter\") return\n            event.preventDefault()\n            onAdd()\n          }}\n          disabled={values.length >= config.max}\n        />\n        <Button\n          type=\"button\"\n          variant=\"outline\"\n          size=\"sm\"\n          className=\"rounded-xl h-9 text-xs border-border font-semibold shrink-0\"\n          onClick={onAdd}\n          disabled={values.length >= config.max}\n        >\n          <Plus className=\"size-3\" />\n        </Button>\n      </div>\n\n      {values.length > 0 ? (\n        <div className=\"flex flex-wrap gap-2\">\n          {values.map((value) => (\n            <Badge\n              key={value}\n              variant=\"secondary\"\n              className=\"rounded-lg gap-1.5 px-2.5 h-7 text-xs bg-card text-muted-foreground border border-border\"\n            >\n              <Globe className=\"size-3\" />\n              {value}\n              <Button\n                type=\"button\"\n                variant=\"ghost\"\n                size=\"icon\"\n                className=\"text-muted-foreground hover:text-foreground rounded-sm p-0.5 transition-colors h-4 w-4\"\n                onClick={() => onRemove(value)}\n                aria-label={`Remove ${value}`}\n              >\n                <X className=\"size-3\" />\n              </Button>\n            </Badge>\n          ))}\n        </div>\n      ) : null}\n    </div>\n  )\n}\n"
    },
    {
      "path": "app/(app)/settings/settings-client.tsx",
      "content": "\"use client\"\n\nimport * as React from \"react\"\nimport { useRouter } from \"next/navigation\"\nimport { toast } from \"sonner\"\nimport { Button } from \"@/components/ui/button\"\nimport { Card, CardContent } from \"@/components/ui/card\"\nimport { Input } from \"@/components/ui/input\"\nimport { Label } from \"@/components/ui/label\"\nimport { Separator } from \"@/components/ui/separator\"\nimport { Switch } from \"@/components/ui/switch\"\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\"\nimport { Textarea } from \"@/components/ui/textarea\"\nimport { ToggleGroup, ToggleGroupItem } from \"@/components/ui/toggle-group\"\nimport { Badge } from \"@/components/ui/badge\"\nimport { withIdempotencyHeader } from \"@/lib/api/client-idempotency\"\nimport { cn } from \"@/lib/utils\"\nimport { X, Star, Settings, Sparkles, Zap, Globe, Loader2, CheckCircle2 } from \"@/components/icons\"\nimport { SeoProfilesEditor, type SeoLocationProfilePayload } from \"@/app/(app)/settings/seo-profiles-editor\"\n\ntype SettingsShape = {\n  tonePreset: string\n  toneCustomInstructions: string | null\n  autoDraftEnabled: boolean\n  autoDraftForRatings: number[]\n  bulkApproveEnabledForFiveStar: boolean\n  mentionKeywords: string[]\n}\n\ntype Props = {\n  orgName: string\n  googleConnection: { status: string; googleEmail: string; scopes: string[] } | null\n  locations: Array<{\n    id: string\n    displayName: string\n    seoPrimaryKeywords: string[]\n    seoSecondaryKeywords: string[]\n    seoGeoTerms: string[]\n  }>\n  settings: SettingsShape\n  showBulkApprove?: boolean\n}\n\nconst TONE_PRESETS = [\"friendly\", \"professional\", \"empathetic\", \"concise\", \"upbeat\"] as const\n\nfunction isValidKeyword(raw: string) {\n  const v = raw.trim().toLowerCase()\n  if (v.length < 1 || v.length > 32) return null\n  return v\n}\n\nexport function SettingsClient({\n  orgName,\n  googleConnection,\n  locations,\n  settings,\n  showBulkApprove = true,\n}: Props) {\n  const router = useRouter()\n\n  const [saving, setSaving] = React.useState(false)\n  const [savingSeo, setSavingSeo] = React.useState(false)\n  const [draft, setDraft] = React.useState<SettingsShape>(settings)\n  const [keywordInput, setKeywordInput] = React.useState(\"\")\n\n  const ratings = [1, 2, 3, 4, 5] as const\n  const selectedRatings = React.useMemo(() => new Set(draft.autoDraftForRatings), [draft.autoDraftForRatings])\n\n  const submit = async (patch: Partial<SettingsShape>) => {\n    setSaving(true)\n    try {\n      const res = await fetch(\"/api/settings/update\", {\n        method: \"POST\",\n        headers: withIdempotencyHeader({ \"content-type\": \"application/json\" }),\n        body: JSON.stringify(patch),\n      })\n      if (res.status === 401) {\n        router.replace(\"/signin\")\n        return\n      }\n      const body = await res.json().catch(() => null)\n      if (!res.ok) throw new Error(body?.error ?? res.statusText)\n      toast.success(\"Settings saved\")\n    } catch (e) {\n      toast.error(e instanceof Error ? e.message : String(e))\n    } finally {\n      setSaving(false)\n      router.refresh()\n    }\n  }\n\n  const saveSeoProfiles = async (profiles: SeoLocationProfilePayload[]) => {\n    setSavingSeo(true)\n    try {\n      const res = await fetch(\"/api/settings/seo-locations\", {\n        method: \"POST\",\n        headers: withIdempotencyHeader({ \"content-type\": \"application/json\" }),\n        body: JSON.stringify({\n          locations: profiles.map((profile) => ({\n            locationId: profile.locationId,\n            primaryKeywords: profile.primaryKeywords,\n            secondaryKeywords: profile.secondaryKeywords,\n            geoTerms: profile.geoTerms,\n          })),\n        }),\n      })\n      if (res.status === 401) {\n        router.replace(\"/signin\")\n        return\n      }\n      const body = await res.json().catch(() => null)\n      if (!res.ok) throw new Error(body?.error ?? res.statusText)\n      toast.success(\"SEO profiles saved\")\n    } catch (e) {\n      toast.error(e instanceof Error ? e.message : String(e))\n    } finally {\n      setSavingSeo(false)\n      router.refresh()\n    }\n  }\n\n  const addKeyword = () => {\n    const v = isValidKeyword(keywordInput)\n    if (!v) {\n      toast.error(\"Keyword must be 1-32 characters.\")\n      return\n    }\n    if (draft.mentionKeywords.includes(v)) {\n      setKeywordInput(\"\")\n      return\n    }\n    if (draft.mentionKeywords.length >= 30) {\n      toast.error(\"Maximum 30 keywords.\")\n      return\n    }\n    setDraft((prev) => ({ ...prev, mentionKeywords: [...prev.mentionKeywords, v] }))\n    setKeywordInput(\"\")\n  }\n\n  const removeKeyword = (k: string) => {\n    setDraft((prev) => ({ ...prev, mentionKeywords: prev.mentionKeywords.filter((x) => x !== k) }))\n  }\n\n  return (\n    <div className=\"p-6 lg:p-8 space-y-8 max-w-3xl mx-auto\">\n      {/* Header */}\n      <div className=\"flex items-center gap-4\">\n        <div className=\"h-12 w-12 rounded-2xl bg-muted flex items-center justify-center border border-border\">\n          <Settings className=\"size-5 text-muted-foreground\" />\n        </div>\n        <div>\n          <h1 className=\"text-2xl font-bold tracking-tight text-foreground\">Settings</h1>\n          <p className=\"text-sm text-muted-foreground font-medium\">Configure automation and AI behavior</p>\n        </div>\n      </div>\n\n      <Tabs defaultValue=\"general\" className=\"space-y-6\">\n        <TabsList className=\"bg-muted p-1 rounded-xl h-10 border border-border\">\n          <TabsTrigger value=\"general\" className=\"text-xs rounded-lg data-[state=active]:bg-card data-[state=active]:shadow-card data-[state=active]:text-foreground text-muted-foreground font-medium\">General</TabsTrigger>\n          <TabsTrigger value=\"automation\" className=\"text-xs rounded-lg data-[state=active]:bg-card data-[state=active]:shadow-card data-[state=active]:text-foreground text-muted-foreground font-medium\">Automation</TabsTrigger>\n          <TabsTrigger value=\"seo\" className=\"text-xs rounded-lg data-[state=active]:bg-card data-[state=active]:shadow-card data-[state=active]:text-foreground text-muted-foreground font-medium\">SEO</TabsTrigger>\n          <TabsTrigger value=\"tone\" className=\"text-xs rounded-lg data-[state=active]:bg-card data-[state=active]:shadow-card data-[state=active]:text-foreground text-muted-foreground font-medium\">AI Tone</TabsTrigger>\n        </TabsList>\n\n        {/* â”€â”€â”€ General â”€â”€â”€ */}\n        <TabsContent value=\"general\" className=\"space-y-5\">\n          <Card className=\"rounded-2xl border-border bg-card shadow-card\">\n            <CardContent className=\"p-6 space-y-6\">\n              <div className=\"flex items-center gap-4\">\n                <div className=\"h-10 w-10 rounded-xl bg-muted flex items-center justify-center border border-border\">\n                  <Globe className=\"size-4 text-muted-foreground\" />\n                </div>\n                <div className=\"min-w-0\">\n                  <div className=\"text-sm font-bold text-foreground\">Organization</div>\n                  <div className=\"text-xs text-muted-foreground truncate font-medium\">{orgName}</div>\n                </div>\n              </div>\n\n              <Separator className=\"bg-border\" />\n\n              <div className=\"space-y-4\">\n                <div className=\"text-sm font-bold text-foreground\">Google Connection</div>\n                {googleConnection ? (\n                  <div className=\"rounded-2xl border border-border bg-muted/50 p-5 space-y-3\">\n                    <div className=\"flex items-center gap-3\">\n                      <div className=\"h-10 w-10 rounded-xl bg-card border border-border flex items-center justify-center shadow-sm\">\n                        <Globe className=\"size-4 text-muted-foreground\" />\n                      </div>\n                      <div className=\"min-w-0 flex-1\">\n                        <div className=\"text-sm font-semibold truncate text-foreground\">{googleConnection.googleEmail}</div>\n                      </div>\n                      <Badge\n                        variant=\"secondary\"\n                        className={cn(\n                          \"rounded-lg px-3 py-1.5 text-xs font-medium\",\n                          googleConnection.status === \"ACTIVE\"\n                            ? \"bg-emerald-100 text-emerald-700\"\n                            : \"bg-rose-100 text-rose-700\"\n                        )}\n                      >\n                        {googleConnection.status === \"ACTIVE\" ? (\n                          <span className=\"flex items-center gap-1.5\">\n                            <CheckCircle2 className=\"size-3\" /> Active\n                          </span>\n                        ) : (\n                          googleConnection.status\n                        )}\n                      </Badge>\n                    </div>\n                    <div className=\"flex gap-2\">\n                      <Badge variant=\"secondary\" className=\"rounded-md font-mono text-[9px] px-2 h-5 bg-muted text-muted-foreground\">\n                        {googleConnection.scopes.length} scope{googleConnection.scopes.length !== 1 ? \"s\" : \"\"}\n                      </Badge>\n                    </div>\n                  </div>\n                ) : (\n                  <div className=\"rounded-2xl border-2 border-dashed border-border p-8 text-center\">\n                    <p className=\"text-sm text-muted-foreground font-medium\">Not connected</p>\n                    <p className=\"text-xs text-muted-foreground mt-1\">Connect your Google account to sync reviews</p>\n                  </div>\n                )}\n              </div>\n            </CardContent>\n          </Card>\n        </TabsContent>\n\n        {/* â”€â”€â”€ Automation â”€â”€â”€ */}\n        <TabsContent value=\"automation\" className=\"space-y-5\">\n          <Card className=\"rounded-2xl border-border bg-card shadow-card\">\n            <CardContent className=\"p-6 space-y-6\">\n              {/* Auto-draft */}\n              <div className=\"flex items-start justify-between gap-4\">\n                <div className=\"flex items-start gap-4\">\n                  <div className=\"h-10 w-10 rounded-xl bg-primary/10 flex items-center justify-center border border-primary/20 mt-0.5\">\n                    <Sparkles className=\"size-4 text-primary\" />\n                  </div>\n                  <div className=\"space-y-1\">\n                    <div className=\"text-sm font-bold text-foreground\">Auto draft</div>\n                    <div className=\"text-xs text-muted-foreground leading-relaxed max-w-[280px] font-medium\">\n                      Automatically generate AI drafts for incoming reviews.\n                    </div>\n                  </div>\n                </div>\n                <Switch\n                  checked={draft.autoDraftEnabled}\n                  onCheckedChange={(v) => setDraft((p) => ({ ...p, autoDraftEnabled: v }))}\n                />\n              </div>\n\n              <div className={cn(\"pl-14 space-y-3\", !draft.autoDraftEnabled && \"opacity-40 pointer-events-none\")}>\n                <div className=\"text-xs font-bold text-muted-foreground uppercase tracking-widest\">Draft for ratings</div>\n                <ToggleGroup\n                  type=\"multiple\"\n                  value={draft.autoDraftForRatings.map(String)}\n                  disabled={!draft.autoDraftEnabled}\n                  onValueChange={(values) => {\n                    const next = values\n                      .map((value) => Number(value))\n                      .filter((value): value is number => Number.isInteger(value) && value >= 1 && value <= 5)\n                      .sort((a, b) => a - b)\n                    setDraft((p) => ({ ...p, autoDraftForRatings: next }))\n                  }}\n                  className=\"flex flex-wrap justify-start gap-2 bg-transparent p-0\"\n                >\n                  {ratings.map((r) => {\n                    const active = selectedRatings.has(r)\n                    return (\n                      <ToggleGroupItem\n                        key={r}\n                        value={String(r)}\n                        className={cn(\n                          \"h-9 px-4 rounded-xl text-xs font-semibold inline-flex items-center gap-1.5 transition-all border\",\n                          active\n                            ? \"bg-primary/10 text-primary border-primary/30\"\n                            : \"bg-card text-muted-foreground border-border hover:bg-accent\"\n                        )}\n                      >\n                        {r}\n                        <Star className=\"size-3\" weight={active ? \"fill\" : \"regular\"} />\n                      </ToggleGroupItem>\n                    )\n                  })}\n                </ToggleGroup>\n              </div>\n\n              {showBulkApprove ? (\n                <>\n                  <Separator className=\"bg-border\" />\n\n                  {/* Bulk approve */}\n                  <div className=\"flex items-start justify-between gap-4\">\n                    <div className=\"flex items-start gap-4\">\n                      <div className=\"h-10 w-10 rounded-xl bg-emerald-50 flex items-center justify-center border border-emerald-100 mt-0.5\">\n                        <Zap className=\"size-4 text-emerald-600\" />\n                      </div>\n                      <div className=\"space-y-1\">\n                        <div className=\"text-sm font-bold text-foreground\">Bulk approve 5-star</div>\n                        <div className=\"text-xs text-muted-foreground leading-relaxed max-w-[280px] font-medium\">\n                          Enable one-click bulk posting for ready 5-star drafts.\n                        </div>\n                      </div>\n                    </div>\n                    <Switch\n                      checked={draft.bulkApproveEnabledForFiveStar}\n                      onCheckedChange={(v) => setDraft((p) => ({ ...p, bulkApproveEnabledForFiveStar: v }))}\n                    />\n                  </div>\n                </>\n              ) : null}\n\n              <div className=\"flex justify-end pt-2\">\n                <Button\n                  type=\"button\"\n                  size=\"sm\"\n                  className=\"rounded-xl gap-2 h-9 text-xs bg-primary hover:bg-primary/90 text-primary-foreground shadow-elevated min-w-[100px]\"\n                  disabled={saving}\n                  onClick={() =>\n                    submit({\n                      autoDraftEnabled: draft.autoDraftEnabled,\n                      autoDraftForRatings: draft.autoDraftForRatings,\n                      ...(showBulkApprove\n                        ? { bulkApproveEnabledForFiveStar: draft.bulkApproveEnabledForFiveStar }\n                        : {}),\n                    })\n                  }\n                >\n                  {saving ? <Loader2 className=\"size-3.5 animate-spin\" /> : null}\n                  {saving ? \"Savingâ€¦\" : \"Save changes\"}\n                </Button>\n              </div>\n            </CardContent>\n          </Card>\n        </TabsContent>\n\n        {/* â”€â”€â”€ SEO Profiles â”€â”€â”€ */}\n        <TabsContent value=\"seo\" className=\"space-y-5\">\n          <SeoProfilesEditor\n            initialProfiles={locations.map((location) => ({\n              locationId: location.id,\n              displayName: location.displayName,\n              primaryKeywords: location.seoPrimaryKeywords,\n              secondaryKeywords: location.seoSecondaryKeywords,\n              geoTerms: location.seoGeoTerms,\n            }))}\n            saving={savingSeo}\n            onSave={saveSeoProfiles}\n          />\n        </TabsContent>\n\n        {/* â”€â”€â”€ AI Tone â”€â”€â”€ */}\n        <TabsContent value=\"tone\" className=\"space-y-5\">\n          <Card className=\"rounded-2xl border-border bg-card shadow-card\">\n            <CardContent className=\"p-6 space-y-6\">\n              <div className=\"space-y-3\">\n                <Label className=\"text-xs font-bold text-muted-foreground uppercase tracking-widest\">Model Runtime</Label>\n                <div className=\"rounded-xl border border-border bg-muted/50 px-3 py-2 text-sm text-muted-foreground\">\n                  OpenAI via DSPy service\n                </div>\n              </div>\n\n              <Separator className=\"bg-border\" />\n\n              {/* Tone Preset */}\n              <div className=\"space-y-3\">\n                <Label className=\"text-xs font-bold text-muted-foreground uppercase tracking-widest\">Tone Preset</Label>\n                <ToggleGroup\n                  type=\"single\"\n                  value={draft.tonePreset}\n                  onValueChange={(value) => {\n                    if (!value) return\n                    setDraft((p) => ({ ...p, tonePreset: value }))\n                  }}\n                  className=\"flex flex-wrap justify-start gap-2 bg-transparent p-0\"\n                >\n                  {TONE_PRESETS.map((t) => {\n                    const active = draft.tonePreset === t\n                    return (\n                      <ToggleGroupItem\n                        key={t}\n                        value={t}\n                        className={cn(\n                          \"h-9 px-4 rounded-xl text-xs font-semibold capitalize transition-all border\",\n                          active\n                            ? \"bg-primary/10 text-primary border-primary/30\"\n                            : \"bg-card text-muted-foreground border-border hover:bg-accent\"\n                        )}\n                      >\n                        {t}\n                      </ToggleGroupItem>\n                    )\n                  })}\n                </ToggleGroup>\n              </div>\n\n              {/* Custom Instructions */}\n              <div className=\"space-y-3\">\n                <Label className=\"text-xs font-bold text-muted-foreground uppercase tracking-widest\">Custom Instructions</Label>\n                <Textarea\n                  className=\"rounded-xl resize-none text-sm border-border focus-visible:ring-ring/30 focus-visible:ring-4\"\n                  value={draft.toneCustomInstructions ?? \"\"}\n                  onChange={(e) => setDraft((p) => ({ ...p, toneCustomInstructions: e.target.value || null }))}\n                  placeholder=\"Optional. Example: Keep replies under 70 words and avoid exclamation marks.\"\n                  rows={4}\n                />\n              </div>\n\n              <Separator className=\"bg-border\" />\n\n              {/* Mention Keywords */}\n              <div className=\"space-y-3\">\n                <div className=\"flex items-center justify-between\">\n                  <Label className=\"text-xs font-bold text-muted-foreground uppercase tracking-widest\">Mention Keywords</Label>\n                  <Badge variant=\"secondary\" className=\"rounded-md font-mono text-[9px] h-5 px-2 bg-muted text-muted-foreground\">\n                    {draft.mentionKeywords.length}/30\n                  </Badge>\n                </div>\n                <div className=\"flex items-center gap-2\">\n                  <Input\n                    className=\"rounded-xl h-10 text-sm border-border\"\n                    value={keywordInput}\n                    placeholder=\"Add keyword (e.g., staff)\"\n                    onChange={(e) => setKeywordInput(e.target.value)}\n                    onKeyDown={(e) => {\n                      if (e.key === \"Enter\") {\n                        e.preventDefault()\n                        addKeyword()\n                      }\n                    }}\n                  />\n                  <Button\n                    type=\"button\"\n                    variant=\"outline\"\n                    size=\"sm\"\n                    className=\"rounded-xl h-10 text-xs border-border font-semibold\"\n                    onClick={addKeyword}\n                  >\n                    Add\n                  </Button>\n                </div>\n                {draft.mentionKeywords.length > 0 && (\n                  <div className=\"flex flex-wrap gap-2 pt-1\">\n                    {draft.mentionKeywords.map((k) => (\n                      <Badge key={k} variant=\"secondary\" className=\"rounded-lg gap-2 px-3 h-7 text-xs bg-muted text-muted-foreground hover:bg-accent border border-border\">\n                        {k}\n                        <Button\n                          type=\"button\"\n                          variant=\"ghost\"\n                          size=\"icon\"\n                          className=\"text-muted-foreground hover:text-foreground rounded-sm p-0.5 transition-colors h-4 w-4\"\n                          onClick={() => removeKeyword(k)}\n                          aria-label={`Remove ${k}`}\n                        >\n                          <X className=\"size-3\" />\n                        </Button>\n                      </Badge>\n                    ))}\n                  </div>\n                )}\n              </div>\n\n              <div className=\"flex justify-end pt-2\">\n                <Button\n                  type=\"button\"\n                  size=\"sm\"\n                  className=\"rounded-xl gap-2 h-9 text-xs bg-primary hover:bg-primary/90 text-primary-foreground shadow-elevated min-w-[100px]\"\n                  disabled={saving}\n                  onClick={() =>\n                    submit({\n                      tonePreset: draft.tonePreset,\n                      toneCustomInstructions: draft.toneCustomInstructions,\n                      mentionKeywords: draft.mentionKeywords,\n                    })\n                  }\n                >\n                  {saving ? <Loader2 className=\"size-3.5 animate-spin\" /> : null}\n                  {saving ? \"Savingâ€¦\" : \"Save changes\"}\n                </Button>\n              </div>\n            </CardContent>\n          </Card>\n        </TabsContent>\n      </Tabs>\n    </div>\n  )\n}\n"
    },
    {
      "path": "app/(app)/users/page.tsx",
      "content": "import { redirect } from \"next/navigation\"\nimport { getSession } from \"@/lib/session\"\nimport { UsersClient } from \"@/app/(app)/users/users-client\"\nimport { getUsersSidebarData } from \"@/lib/sidebar-data\"\n\nexport default async function UsersPage() {\n  const session = await getSession()\n  if (!session?.user?.id || !session.orgId) redirect(\"/signin\")\n\n  const { memberships, invites } = await getUsersSidebarData(session.orgId)\n\n  return (\n    <UsersClient\n      members={memberships.map((m) => ({\n        userId: m.userId,\n        email: m.user.email,\n        name: m.user.name,\n        role: m.role,\n        createdAtIso: m.createdAt.toISOString(),\n      }))}\n      invites={invites.map((i) => ({\n        inviteId: i.id,\n        email: i.email,\n        role: i.role,\n        expiresAtIso: i.expiresAt.toISOString(),\n        createdAtIso: i.createdAt.toISOString(),\n      }))}\n      canManage={session.role === \"OWNER\"}\n    />\n  )\n}\n"
    },
    {
      "path": "app/(app)/users/users-client.tsx",
      "content": "\"use client\"\n\nimport * as React from \"react\"\nimport { toast } from \"sonner\"\nimport { withIdempotencyHeader } from \"@/lib/api/client-idempotency\"\nimport { cn } from \"@/lib/utils\"\nimport { Badge } from \"@/components/ui/badge\"\nimport { Button } from \"@/components/ui/button\"\nimport { Input } from \"@/components/ui/input\"\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\"\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from \"@/components/ui/table\"\nimport { Plus, Trash2, Users } from \"@/components/icons\"\n\ntype MemberRow = {\n  userId: string\n  email: string\n  name: string | null\n  role: string\n  createdAtIso: string\n}\n\ntype InviteRow = {\n  inviteId: string\n  email: string\n  role: string\n  expiresAtIso: string\n  createdAtIso: string\n}\n\nfunction getInitials(name: string | null, email: string) {\n  const source = name?.trim() || email\n  const parts = source.split(/\\s+/)\n  const a = parts[0]?.[0] ?? \"U\"\n  const b = parts.length > 1 ? parts[parts.length - 1]?.[0] ?? \"\" : \"\"\n  return `${a}${b}`.toUpperCase()\n}\n\nexport function UsersClient({\n  members: initialMembers,\n  invites: initialInvites,\n  canManage,\n}: {\n  members: MemberRow[]\n  invites: InviteRow[]\n  canManage: boolean\n}) {\n  const [members] = React.useState(initialMembers)\n  const [invites, setInvites] = React.useState(initialInvites)\n  const [showInvite, setShowInvite] = React.useState(false)\n  const [saving, setSaving] = React.useState(false)\n  const [email, setEmail] = React.useState(\"\")\n  const [role, setRole] = React.useState<\"OWNER\" | \"MANAGER\" | \"STAFF\">(\"STAFF\")\n\n  const inviteMember = async () => {\n    const normalized = email.trim().toLowerCase()\n    if (!normalized) {\n      toast.error(\"Email is required.\")\n      return\n    }\n    setSaving(true)\n    try {\n      const res = await fetch(\"/api/team/invite\", {\n        method: \"POST\",\n        headers: withIdempotencyHeader({ \"content-type\": \"application/json\" }),\n        body: JSON.stringify({ email: normalized, role }),\n      })\n      const data = await res.json().catch(() => null)\n      if (!res.ok) throw new Error(data?.error ?? res.statusText)\n      setInvites((prev) => [\n        {\n          inviteId: data.inviteId,\n          email: normalized,\n          role,\n          expiresAtIso: data.expiresAt,\n          createdAtIso: new Date().toISOString(),\n        },\n        ...prev,\n      ])\n      setEmail(\"\")\n      setRole(\"STAFF\")\n      setShowInvite(false)\n      toast.success(\"Invite created\")\n    } catch (e) {\n      toast.error(e instanceof Error ? e.message : \"Invite failed\")\n    } finally {\n      setSaving(false)\n    }\n  }\n\n  const revokeInvite = async (inviteId: string) => {\n    setSaving(true)\n    try {\n      const res = await fetch(\"/api/team/invite/revoke\", {\n        method: \"POST\",\n        headers: withIdempotencyHeader({ \"content-type\": \"application/json\" }),\n        body: JSON.stringify({ inviteId }),\n      })\n      const data = await res.json().catch(() => null)\n      if (!res.ok) throw new Error(data?.error ?? res.statusText)\n      setInvites((prev) => prev.filter((x) => x.inviteId !== inviteId))\n      toast.success(\"Invite revoked\")\n    } catch (e) {\n      toast.error(e instanceof Error ? e.message : \"Revoke failed\")\n    } finally {\n      setSaving(false)\n    }\n  }\n\n  return (\n    <div className=\"max-w-5xl mx-auto p-10 space-y-8\">\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h3 className=\"text-2xl font-bold\">Team Members</h3>\n          <p className=\"text-zinc-500\">Manage who has access to your review inboxes.</p>\n        </div>\n        {canManage ? (\n          <Button\n            onClick={() => setShowInvite((v) => !v)}\n            className=\"bg-blue-600 hover:bg-blue-700 text-white px-5 py-2.5 rounded-xl font-bold text-sm shadow-sm transition-all flex items-center gap-2\"\n          >\n            <Plus className=\"h-4 w-4\" />\n            Invite Colleague\n          </Button>\n        ) : null}\n      </div>\n\n      {showInvite ? (\n        <div className=\"bg-white border border-zinc-200 rounded-2xl p-5 shadow-sm\">\n          <div className=\"grid grid-cols-1 md:grid-cols-3 gap-3\">\n            <Input\n              type=\"email\"\n              className=\"h-10 border-zinc-200 rounded-lg text-sm\"\n              placeholder=\"colleague@company.com\"\n              value={email}\n              onChange={(e) => setEmail(e.target.value)}\n            />\n            <Select value={role} onValueChange={(value) => setRole(value as \"OWNER\" | \"MANAGER\" | \"STAFF\")}>\n              <SelectTrigger className=\"h-10 border-zinc-200 rounded-lg text-sm font-medium\">\n                <SelectValue placeholder=\"Select role\" />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"STAFF\">Staff</SelectItem>\n                <SelectItem value=\"MANAGER\">Manager</SelectItem>\n                <SelectItem value=\"OWNER\">Owner</SelectItem>\n              </SelectContent>\n            </Select>\n            <Button\n              onClick={inviteMember}\n              disabled={saving}\n              className=\"bg-zinc-900 text-white rounded-lg text-sm font-semibold px-4 py-2 hover:bg-zinc-800 disabled:opacity-70\"\n            >\n              {saving ? \"Sending...\" : \"Send Invite\"}\n            </Button>\n          </div>\n        </div>\n      ) : null}\n\n      <div className=\"bg-white border border-zinc-200 rounded-2xl overflow-hidden shadow-sm\">\n        <Table className=\"text-left\">\n          <TableHeader className=\"bg-zinc-50 border-b border-zinc-200\">\n            <TableRow className=\"hover:bg-transparent\">\n              <TableHead className=\"px-6 py-4 text-xs font-bold text-zinc-500 uppercase h-auto\">User</TableHead>\n              <TableHead className=\"px-6 py-4 text-xs font-bold text-zinc-500 uppercase h-auto\">Role</TableHead>\n              <TableHead className=\"px-6 py-4 text-xs font-bold text-zinc-500 uppercase h-auto\">Status</TableHead>\n              <TableHead className=\"px-6 py-4 h-auto\" />\n            </TableRow>\n          </TableHeader>\n          <TableBody className=\"divide-y divide-zinc-100\">\n            {members.map((member) => (\n              <TableRow key={member.userId} className=\"hover:bg-zinc-50 transition-colors\">\n                <TableCell className=\"px-6 py-4\">\n                  <div className=\"flex items-center gap-3\">\n                    <div className=\"h-10 w-10 bg-blue-100 rounded-full flex items-center justify-center text-blue-700 font-bold text-sm\">\n                      {getInitials(member.name, member.email)}\n                    </div>\n                    <div>\n                      <p className=\"font-bold text-zinc-900\">{member.name ?? member.email}</p>\n                      <p className=\"text-xs text-zinc-500\">{member.email}</p>\n                    </div>\n                  </div>\n                </TableCell>\n                <TableCell className=\"px-6 py-4\">\n                  <span className=\"text-sm font-medium text-zinc-700\">{member.role}</span>\n                </TableCell>\n                <TableCell className=\"px-6 py-4\">\n                  <Badge variant=\"secondary\" className=\"px-2.5 py-1 rounded-full text-[10px] font-bold uppercase bg-green-100 text-green-700 border-transparent\">\n                    Active\n                  </Badge>\n                </TableCell>\n                <TableCell className=\"px-6 py-4 text-right text-xs text-zinc-400\">\n                  {new Date(member.createdAtIso).toLocaleDateString(\"en-US\", { month: \"short\", day: \"numeric\", year: \"numeric\" })}\n                </TableCell>\n              </TableRow>\n            ))}\n\n            {invites.map((invite) => (\n              <TableRow key={invite.inviteId} className=\"hover:bg-zinc-50 transition-colors\">\n                <TableCell className=\"px-6 py-4\">\n                  <div className=\"flex items-center gap-3\">\n                    <div className=\"h-10 w-10 bg-zinc-100 rounded-full flex items-center justify-center text-zinc-600\">\n                      <Users className=\"h-4 w-4\" />\n                    </div>\n                    <div>\n                      <p className=\"font-bold text-zinc-900\">{invite.email}</p>\n                      <p className=\"text-xs text-zinc-500\">Invite pending</p>\n                    </div>\n                  </div>\n                </TableCell>\n                <TableCell className=\"px-6 py-4\">\n                  <span className=\"text-sm font-medium text-zinc-700\">{invite.role}</span>\n                </TableCell>\n                <TableCell className=\"px-6 py-4\">\n                  <Badge variant=\"secondary\" className={cn(\"px-2.5 py-1 rounded-full text-[10px] font-bold uppercase border-transparent\", \"bg-zinc-100 text-zinc-600\")}>\n                    Pending\n                  </Badge>\n                </TableCell>\n                <TableCell className=\"px-6 py-4 text-right\">\n                  {canManage ? (\n                    <Button\n                      onClick={() => revokeInvite(invite.inviteId)}\n                      disabled={saving}\n                      variant=\"ghost\"\n                      size=\"icon\"\n                      className=\"text-zinc-400 hover:text-red-500 transition-colors h-8 w-8\"\n                    >\n                      <Trash2 className=\"h-4 w-4\" />\n                    </Button>\n                  ) : (\n                    <span className=\"text-xs text-zinc-400\">\n                      Expires {new Date(invite.expiresAtIso).toLocaleDateString(\"en-US\", { month: \"short\", day: \"numeric\" })}\n                    </span>\n                  )}\n                </TableCell>\n              </TableRow>\n            ))}\n          </TableBody>\n        </Table>\n      </div>\n    </div>\n  )\n}\n"
    },
    {
      "path": "app/globals.css",
      "content": "/* Tailwind v4 (PostCSS): single entry import + explicit config link. */\n@import \"tailwindcss\";\n@config \"../tailwind.config.ts\";\n\n/* Tailwind v4 animation utilities used by shadcn components. */\n@import \"tw-animate-css\";\n\n/* shadcn Tailwind v4 helpers (custom variants/utilities). */\n@import \"shadcn/tailwind.css\";\n\n/*\n  Design system preset (manual cutover; do not run `shadcn create`):\n  - base: radix\n  - style: nova (zinc)\n  - theme: blue\n  - radius: large\n  - rtl: false\n  - font: noto-sans (via `next/font/google`, `--font-sans`)\n*/\n\n/*\n  Tailwind v4: expose design tokens as theme variables so utilities like\n  `bg-background`, `text-foreground`, `border-border`, `ring-ring`, etc work.\n*/\n@theme inline {\n  --color-border: hsl(var(--border));\n  --color-input: hsl(var(--input));\n  --color-ring: hsl(var(--ring));\n  --color-background: hsl(var(--background));\n  --color-foreground: hsl(var(--foreground));\n\n  --color-primary: hsl(var(--primary));\n  --color-primary-foreground: hsl(var(--primary-foreground));\n  --color-secondary: hsl(var(--secondary));\n  --color-secondary-foreground: hsl(var(--secondary-foreground));\n  --color-destructive: hsl(var(--destructive));\n  --color-destructive-foreground: hsl(var(--destructive-foreground));\n  --color-muted: hsl(var(--muted));\n  --color-muted-foreground: hsl(var(--muted-foreground));\n  --color-accent: hsl(var(--accent));\n  --color-accent-foreground: hsl(var(--accent-foreground));\n  --color-popover: hsl(var(--popover));\n  --color-popover-foreground: hsl(var(--popover-foreground));\n  --color-card: hsl(var(--card));\n  --color-card-foreground: hsl(var(--card-foreground));\n\n  /* Extended palette for reviews & accents */\n  --color-emerald-50: oklch(0.97 0.038 160);\n  --color-emerald-100: oklch(0.93 0.06 160);\n  --color-emerald-400: oklch(0.72 0.17 162);\n  --color-emerald-500: oklch(0.65 0.17 162);\n  --color-emerald-600: oklch(0.58 0.16 162);\n  --color-emerald-700: oklch(0.50 0.14 162);\n  --color-emerald-900: oklch(0.35 0.10 162);\n  --color-amber-50: oklch(0.98 0.04 90);\n  --color-amber-100: oklch(0.94 0.07 85);\n  --color-amber-400: oklch(0.82 0.19 84);\n  --color-amber-500: oklch(0.75 0.18 80);\n  --color-amber-600: oklch(0.68 0.18 80);\n  --color-amber-700: oklch(0.60 0.16 80);\n  --color-rose-50: oklch(0.97 0.03 15);\n  --color-rose-100: oklch(0.93 0.06 12);\n  --color-rose-500: oklch(0.62 0.2 15);\n  --color-rose-700: oklch(0.50 0.18 15);\n  --color-blue-50: oklch(0.97 0.02 250);\n  --color-blue-100: oklch(0.93 0.05 250);\n  --color-blue-200: oklch(0.88 0.08 250);\n  --color-blue-400: oklch(0.72 0.17 255);\n  --color-blue-500: oklch(0.62 0.22 260);\n  --color-blue-600: oklch(0.55 0.24 262);\n  --color-blue-700: oklch(0.48 0.22 262);\n  --color-blue-900: oklch(0.35 0.15 262);\n  --color-indigo-50: oklch(0.97 0.02 270);\n  --color-indigo-100: oklch(0.93 0.04 270);\n  --color-indigo-600: oklch(0.52 0.22 270);\n  --color-purple-50: oklch(0.97 0.02 300);\n  --color-purple-100: oklch(0.93 0.04 300);\n  --color-purple-600: oklch(0.52 0.22 300);\n  --color-zinc-50: oklch(0.985 0 0);\n  --color-zinc-100: oklch(0.96 0.003 264);\n  --color-zinc-200: oklch(0.92 0.004 264);\n  --color-zinc-300: oklch(0.87 0.006 264);\n  --color-zinc-400: oklch(0.71 0.01 264);\n  --color-zinc-500: oklch(0.55 0.014 264);\n  --color-zinc-600: oklch(0.44 0.015 264);\n  --color-zinc-700: oklch(0.37 0.013 264);\n  --color-zinc-800: oklch(0.27 0.006 264);\n  --color-zinc-900: oklch(0.21 0.006 264);\n  --color-zinc-950: oklch(0.15 0.004 264);\n\n  /* Spacing tokens */\n  --spacing-safe-bottom: env(safe-area-inset-bottom, 0px);\n}\n\n@layer base {\n  :root {\n    /* Modern Minimal (Zinc) */\n    --background: 0 0% 100%;\n    --foreground: 240 10% 3.9%;\n    --card: 0 0% 100%;\n    --card-foreground: 240 10% 3.9%;\n    --popover: 0 0% 100%;\n    --popover-foreground: 240 10% 3.9%;\n    --primary: 240 5.9% 10%;\n    --primary-foreground: 0 0% 98%;\n    --secondary: 240 4.8% 95.9%;\n    --secondary-foreground: 240 5.9% 10%;\n    --muted: 240 4.8% 95.9%;\n    --muted-foreground: 240 3.8% 46.1%;\n    --accent: 240 4.8% 95.9%;\n    --accent-foreground: 240 5.9% 10%;\n    --destructive: 0 84.2% 60.2%;\n    --destructive-foreground: 0 0% 98%;\n    --border: 240 5.9% 90%;\n    --input: 240 5.9% 90%;\n    --ring: 240 5.9% 10%;\n    --radius: 0.5rem;\n\n    /* Layout & depth */\n    --shadow-glass: 0 0 0 1px rgba(0,0,0,0.05), 0 2px 8px rgba(0,0,0,0.04);\n    --shadow-card: 0 1px 2px rgba(0,0,0,0.04), 0 1px 2px rgba(0,0,0,0.06);\n    --shadow-elevated: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);\n    --shadow-floating: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);\n\n    /* App layout */\n    --sidebar: var(--card);\n    --sidebar-foreground: var(--foreground);\n    --sidebar-muted: var(--muted);\n    --sidebar-border: var(--border);\n\n    /* Legacy compat */\n    --shadow-google-sm: var(--shadow-card);\n    --shadow-google-md: var(--shadow-elevated);\n    --shadow-google-lg: var(--shadow-floating);\n    --shadow-google-xl: 0 25px 50px -12px rgba(0, 0, 0, 0.25);\n  }\n\n  .dark {\n    /* Modern Minimal (Dark Zinc) */\n    --background: 240 10% 3.9%;\n    --foreground: 0 0% 98%;\n    --card: 240 10% 3.9%;\n    --card-foreground: 0 0% 98%;\n    --popover: 240 10% 3.9%;\n    --popover-foreground: 0 0% 98%;\n    --primary: 0 0% 98%;\n    --primary-foreground: 240 5.9% 10%;\n    --secondary: 240 3.7% 15.9%;\n    --secondary-foreground: 0 0% 98%;\n    --muted: 240 3.7% 15.9%;\n    --muted-foreground: 240 5% 64.9%;\n    --accent: 240 3.7% 15.9%;\n    --accent-foreground: 0 0% 98%;\n    --destructive: 0 62.8% 30.6%;\n    --destructive-foreground: 0 0% 98%;\n    --border: 240 3.7% 15.9%;\n    --input: 240 3.7% 15.9%;\n    --ring: 240 4.9% 83.9%;\n\n    --shadow-glass: 0 0 0 1px rgba(255,255,255,0.05), 0 2px 8px rgba(0,0,0,0.2);\n    --shadow-card: 0 1px 2px rgba(0,0,0,0.2), 0 1px 2px rgba(0,0,0,0.3);\n    --shadow-elevated: 0 4px 6px -1px rgba(0, 0, 0, 0.3), 0 2px 4px -1px rgba(0, 0, 0, 0.1);\n    --shadow-floating: 0 20px 25px -5px rgba(0, 0, 0, 0.3), 0 10px 10px -5px rgba(0, 0, 0, 0.2);\n\n    --sidebar: var(--card);\n    --sidebar-foreground: var(--foreground);\n    --sidebar-muted: var(--muted);\n    --sidebar-border: var(--border);\n  }\n\n  html {\n    font-size: 14px;\n  }\n\n  body {\n    @apply bg-background text-foreground antialiased;\n    font-feature-settings: \"cv11\", \"ss01\";\n    -webkit-font-smoothing: antialiased;\n    -moz-osx-font-smoothing: grayscale;\n  }\n\n  * {\n    @apply border-border outline-ring/50;\n  }\n\n  /* Reduced motion: hard-disable animation/transitions app-wide. */\n  @media (prefers-reduced-motion: reduce) {\n    * {\n      animation-duration: 1ms !important;\n      animation-iteration-count: 1 !important;\n      transition-duration: 1ms !important;\n      scroll-behavior: auto !important;\n    }\n  }\n}\n\n@layer utilities {\n\n  /* Shadow system */\n  .shadow-glass {\n    box-shadow: var(--shadow-glass);\n  }\n\n  .shadow-glow-primary {\n    box-shadow: 0 0 20px -5px hsl(var(--primary) / 0.5);\n  }\n\n  .shadow-glow-emerald {\n    box-shadow: 0 0 20px -5px var(--color-emerald-500);\n  }\n  \n  .shadow-dock {\n    box-shadow: 0 8px 32px -4px rgba(0, 0, 0, 0.1), 0 4px 16px -2px rgba(0, 0, 0, 0.05);\n  }\n\n  .shadow-card {\n    box-shadow: var(--shadow-card);\n  }\n\n  .shadow-elevated {\n    box-shadow: var(--shadow-elevated);\n  }\n\n  .shadow-floating {\n    box-shadow: var(--shadow-floating);\n  }\n\n  /* Legacy compat */\n  .shadow-google-sm {\n    box-shadow: var(--shadow-card);\n  }\n\n  .shadow-google-md {\n    box-shadow: var(--shadow-elevated);\n  }\n\n  .shadow-google-lg {\n    box-shadow: var(--shadow-floating);\n  }\n\n  .shadow-google-xl {\n    box-shadow: var(--shadow-google-xl);\n  }\n\n  /* Animations */\n  .animate-fade-in {\n    animation: fadeIn 0.4s ease-out both;\n  }\n\n  .animate-fade-in-up {\n    animation: fadeInUp 0.4s ease-out both;\n  }\n\n  .animate-slide-in-right {\n    animation: slideInRight 0.3s ease-out both;\n  }\n\n  .animate-scale-in {\n    animation: scaleIn 0.2s ease-out both;\n  }\n\n  .animate-shimmer {\n    animation: shimmer 2s linear infinite;\n    background-size: 200% 100%;\n  }\n\n  @keyframes fadeIn {\n    from {\n      opacity: 0;\n    }\n\n    to {\n      opacity: 1;\n    }\n  }\n\n  @keyframes fadeInUp {\n    from {\n      opacity: 0;\n      transform: translateY(12px);\n    }\n\n    to {\n      opacity: 1;\n      transform: translateY(0);\n    }\n  }\n\n  @keyframes slideInRight {\n    from {\n      opacity: 0;\n      transform: translateX(20px);\n    }\n\n    to {\n      opacity: 1;\n      transform: translateX(0);\n    }\n  }\n\n  @keyframes scaleIn {\n    from {\n      opacity: 0;\n      transform: scale(0.95);\n    }\n\n    to {\n      opacity: 1;\n      transform: scale(1);\n    }\n  }\n\n  @keyframes shimmer {\n    from {\n      background-position: 200% 0;\n    }\n\n    to {\n      background-position: -200% 0;\n    }\n  }\n\n  /* Scrollbars */\n  .scrollbar-thin {\n    scrollbar-width: thin;\n    scrollbar-color: oklch(0.87 0 0) transparent;\n  }\n\n  .scrollbar-thin::-webkit-scrollbar {\n    width: 5px;\n    height: 5px;\n  }\n\n  .scrollbar-thin::-webkit-scrollbar-track {\n    background: transparent;\n  }\n\n  .scrollbar-thin::-webkit-scrollbar-thumb {\n    background-color: oklch(0.87 0 0);\n    border-radius: 999px;\n  }\n\n  /* Glass surfaces */\n  .glass {\n    backdrop-filter: blur(16px) saturate(180%);\n    -webkit-backdrop-filter: blur(16px) saturate(180%);\n  }\n\n  .glass-sm {\n    backdrop-filter: blur(8px) saturate(150%);\n    -webkit-backdrop-filter: blur(8px) saturate(150%);\n  }\n\n  /* Safe area */\n  .safe-area-bottom {\n    padding-bottom: env(safe-area-inset-bottom, 0px);\n  }\n\n  /* Gradient text */\n  .text-gradient {\n    background-clip: text;\n    -webkit-background-clip: text;\n    -webkit-text-fill-color: transparent;\n  }\n}\n\n.dark .scrollbar-thin {\n  scrollbar-color: oklch(0.4 0 0) transparent;\n}\n\n.dark .scrollbar-thin::-webkit-scrollbar-thumb {\n  background-color: oklch(0.4 0 0);\n}"
    },
    {
      "path": "app/invite/[token]/page.tsx",
      "content": "import Link from \"next/link\"\nimport { Card } from \"@/components/ui/card\"\nimport { Button } from \"@/components/ui/button\"\n\nexport default async function InvitePage({ params }: { params: Promise<{ token: string }> }) {\n  const { token } = await params\n\n  return (\n    <div className=\"min-h-screen grid place-items-center px-4 py-10\">\n      <Card className=\"w-full max-w-md rounded-3xl p-8 space-y-5 shadow-xl border\">\n        <h1 className=\"text-xl font-bold tracking-tight\">Invite Link</h1>\n        <p className=\"text-sm text-muted-foreground leading-relaxed font-medium\">\n          Invites are currently disabled for this deployment. If you expected to be invited,\n          contact your administrator.\n        </p>\n        <div className=\"rounded-xl bg-muted p-4 border\">\n          <p className=\"text-xs text-muted-foreground font-mono break-all\">\n            Token: {token}\n          </p>\n        </div>\n        <div className=\"flex justify-end\">\n          <Link href=\"/signin\">\n            <Button type=\"button\" className=\"rounded-xl shadow-google-sm\">Go to sign in</Button>\n          </Link>\n        </div>\n      </Card>\n    </div>\n  )\n}\n"
    },
    {
      "path": "app/layout.tsx",
      "content": "import type { Metadata } from \"next\"\nimport { Inter } from \"next/font/google\"\nimport \"@/app/globals.css\"\nimport { cn } from \"@/lib/utils\"\nimport { Providers } from \"@/components/Providers\"\n\nconst inter = Inter({\n  subsets: [\"latin\"],\n  variable: \"--font-sans\",\n})\n\nexport const metadata: Metadata = {\n  title: \"GBP Reviews\",\n  description: \"Google Business Profile Review Manager\",\n}\n\nexport default function RootLayout({ children }: { children: React.ReactNode }) {\n  return (\n    <html\n      lang=\"en\"\n      suppressHydrationWarning\n      dir=\"ltr\"\n      className={cn(inter.variable, \"font-sans\")}\n    >\n      <body className=\"min-h-screen bg-background text-foreground\">\n        <Providers>{children}</Providers>\n      </body>\n    </html>\n  )\n}\n"
    },
    {
      "path": "app/page.tsx",
      "content": "import { redirect } from \"next/navigation\"\nimport { getSession } from \"@/lib/session\"\nimport { prisma } from \"@/lib/db\"\n\nexport default async function Page() {\n  const session = await getSession()\n  if (!session?.user?.id || !session.orgId) redirect(\"/signin\")\n\n  const hasEnabledLocation = await prisma.location.findFirst({\n    where: { orgId: session.orgId, enabled: true },\n    select: { id: true },\n  })\n\n  if (!hasEnabledLocation) redirect(\"/onboarding/locations\")\n  redirect(\"/inbox\")\n}\n\n"
    },
    {
      "path": "app/signin/page.tsx",
      "content": "\"use client\"\n\nimport { signIn } from \"next-auth/react\"\nimport { motion } from \"framer-motion\"\nimport { Button } from \"@/components/ui/button\"\nimport { MapPin, ShieldCheck, Sparkles, MessageSquare } from \"@/components/icons\"\n\nexport default function SignInPage() {\n  return (\n    <div className=\"min-h-screen bg-background flex items-center justify-center p-4\">\n      <motion.div\n        initial={{ opacity: 0, y: 20 }}\n        animate={{ opacity: 1, y: 0 }}\n        transition={{ duration: 0.3 }}\n        className=\"w-full max-w-md\"\n      >\n        <div className=\"rounded-3xl border border-border shadow-floating bg-card p-8\">\n          <div className=\"flex items-center gap-4 mb-8\">\n            <div className=\"flex h-14 w-14 items-center justify-center rounded-2xl bg-primary text-primary-foreground shadow-elevated\">\n              <MapPin className=\"h-7 w-7\" />\n            </div>\n            <div>\n              <div className=\"text-xl font-bold text-foreground tracking-tight\">Business Profile</div>\n              <div className=\"text-sm font-medium text-muted-foreground\">Review Manager</div>\n            </div>\n          </div>\n\n          <div className=\"rounded-2xl bg-muted/60 border border-border p-5 text-sm text-muted-foreground leading-relaxed font-medium\">\n            Sign in to manage reviews, verify AI drafts, and keep all your locations synced.\n          </div>\n\n          <div className=\"mt-8 space-y-4\">\n            <Button\n              type=\"button\"\n              onClick={() => signIn(\"google\", { callbackUrl: \"/inbox\" })}\n              className=\"w-full rounded-2xl bg-primary hover:bg-primary/90 h-14 text-base font-semibold shadow-elevated text-primary-foreground transition-colors flex items-center justify-center gap-3\"\n            >\n              <svg className=\"size-5\" viewBox=\"0 0 48 48\" fill=\"none\">\n                <path d=\"M47.532 24.553c0-1.632-.132-3.272-.414-4.877H24.48v9.242h12.963a11.089 11.089 0 0 1-4.804 7.27l7.766 6.028c4.543-4.19 7.127-10.365 7.127-17.663Z\" fill=\"#4285F4\" />\n                <path d=\"M24.48 48.002c6.502 0 11.964-2.148 15.946-5.834l-7.766-6.028c-2.148 1.44-4.903 2.28-8.174 2.28-6.28 0-11.597-4.242-13.498-9.947l-7.968 6.14c3.95 7.862 12.074 13.389 21.466 13.389Z\" fill=\"#34A853\" />\n                <path d=\"M10.982 28.473a14.44 14.44 0 0 1 0-8.954l-7.968-6.14A24.01 24.01 0 0 0 .412 24.001c0 3.87.924 7.534 2.602 10.622l7.968-6.15Z\" fill=\"#FBBC05\" />\n                <path d=\"M24.48 9.571c3.44-.054 6.758 1.248 9.28 3.604l6.934-6.934C36.396 2.304 30.61.002 24.48.002 15.088.002 6.964 5.53 3.014 13.379l7.968 6.14c1.9-5.7 7.218-9.948 13.498-9.948Z\" fill=\"#EA4335\" />\n              </svg>\n              Continue with Google\n            </Button>\n          </div>\n\n          {/* Feature Cards */}\n          <div className=\"mt-8 grid grid-cols-3 gap-3\">\n            <div className=\"rounded-2xl border border-border bg-card p-4 text-center shadow-card\">\n              <div className=\"h-10 w-10 mx-auto rounded-xl bg-purple-50 flex items-center justify-center mb-3 border border-purple-100\">\n                <Sparkles className=\"h-5 w-5 text-purple-600\" />\n              </div>\n              <div className=\"text-xs font-bold text-foreground\">AI Drafting</div>\n              <div className=\"text-[10px] text-muted-foreground mt-1\">Generate smart replies instantly</div>\n            </div>\n            <div className=\"rounded-2xl border border-border bg-card p-4 text-center shadow-card\">\n              <div className=\"h-10 w-10 mx-auto rounded-xl bg-emerald-50 flex items-center justify-center mb-3 border border-emerald-100\">\n                <ShieldCheck className=\"h-5 w-5 text-emerald-600\" />\n              </div>\n              <div className=\"text-xs font-bold text-foreground\">Claim Verify</div>\n              <div className=\"text-[10px] text-muted-foreground mt-1\">Automated fact-checking</div>\n            </div>\n            <div className=\"rounded-2xl border border-border bg-card p-4 text-center shadow-card\">\n              <div className=\"h-10 w-10 mx-auto rounded-xl bg-primary/10 flex items-center justify-center mb-3 border border-primary/20\">\n                <MessageSquare className=\"h-5 w-5 text-primary\" />\n              </div>\n              <div className=\"text-xs font-bold text-foreground\">Smart Inbox</div>\n              <div className=\"text-[10px] text-muted-foreground mt-1\">Unified review management</div>\n            </div>\n          </div>\n\n          <div className=\"mt-8 text-xs text-center text-muted-foreground font-medium\">\n            Requires Google Business Profile access to sync reviews\n          </div>\n        </div>\n      </motion.div>\n    </div>\n  )\n}\n"
    },
    {
      "path": "app/signin/SignInClient.tsx",
      "content": "\"use client\"\n\nimport Image from \"next/image\"\nimport { signIn } from \"next-auth/react\"\nimport { Button } from \"@/components/ui/button\"\n\nexport function SignInClient({ callbackUrl }: { callbackUrl: string }) {\n  return (\n    <Button\n      type=\"button\"\n      className=\"w-full justify-center gap-3 rounded-2xl h-14 text-base font-semibold shadow-google-md\"\n      onClick={() => signIn(\"google\", { callbackUrl })}\n    >\n      <Image\n        src=\"https://www.gstatic.com/images/branding/product/1x/gsa_512dp.png\"\n        alt=\"Google\"\n        width={18}\n        height={18}\n      />\n      Continue with Google\n    </Button>\n  )\n}\n"
    },
    {
      "path": "components.json",
      "content": "{\n  \"$schema\": \"https://ui.shadcn.com/schema.json\",\n  \"style\": \"nova\",\n  \"rsc\": true,\n  \"tsx\": true,\n  \"tailwind\": {\n    \"config\": \"tailwind.config.ts\",\n    \"css\": \"app/globals.css\",\n    \"baseColor\": \"zinc\",\n    \"cssVariables\": true\n  },\n  \"iconLibrary\": \"phosphor\",\n  \"aliases\": {\n    \"components\": \"@/components\",\n    \"utils\": \"@/lib/utils\",\n    \"ui\": \"@/components/ui\"\n  }\n}"
    },
    {
      "path": "components/AppShell.tsx",
      "content": "\"use client\"\n\nimport * as React from \"react\"\nimport Link from \"next/link\"\nimport { usePathname } from \"next/navigation\"\nimport { signOut } from \"next-auth/react\"\nimport { SearchProvider } from \"@/components/search-context\"\nimport { cn } from \"@/lib/utils\"\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\"\nimport { Badge } from \"@/components/ui/badge\"\nimport { Button } from \"@/components/ui/button\"\nimport { ScrollArea } from \"@/components/ui/scroll-area\"\nimport { Separator } from \"@/components/ui/separator\"\nimport { DropdownMenu, DropdownMenuContent, DropdownMenuItem, DropdownMenuTrigger } from \"@/components/ui/dropdown-menu\"\nimport {\n  Bell,\n  ChevronDown,\n  ChevronLeft,\n  ChevronRight,\n  Globe,\n  LayoutDashboard,\n  MessageSquare,\n  Settings,\n  Sparkles,\n  Users,\n  BarChart,\n  LogOut,\n} from \"@/components/icons\"\n\ntype UserShape = {\n  name: string | null\n  email: string | null\n  image: string | null\n  role: string\n}\n\ntype NavItem = {\n  href: string\n  label: string\n  mobileLabel: string\n  Icon: React.ElementType\n}\n\nconst SIDEBAR_COLLAPSE_STORAGE_KEY = \"replyai.sidebarCollapsed\"\nconst UNANSWERED_CACHE_TTL_MS = 20_000\nlet unansweredCountCache = {\n  value: 0,\n  updatedAt: 0,\n}\n\nfunction isNavItemActive(pathname: string, href: string) {\n  return pathname === href || pathname.startsWith(`${href}/`)\n}\n\nfunction useUnansweredCountPolling() {\n  const [count, setCount] = React.useState<number>(() => unansweredCountCache.value)\n  const pathname = usePathname()\n  const pollEnabled = pathname.startsWith(\"/inbox\")\n  const [isVisible, setIsVisible] = React.useState(() => {\n    if (typeof document === \"undefined\") return true\n    return document.visibilityState === \"visible\"\n  })\n\n  React.useEffect(() => {\n    const onVisibilityChange = () => {\n      setIsVisible(document.visibilityState === \"visible\")\n    }\n\n    document.addEventListener(\"visibilitychange\", onVisibilityChange)\n    return () => {\n      document.removeEventListener(\"visibilitychange\", onVisibilityChange)\n    }\n  }, [])\n\n  React.useEffect(() => {\n    if (!pollEnabled || !isVisible) return\n\n    let mounted = true\n    let timer: ReturnType<typeof setInterval> | null = null\n    let inflightController: AbortController | null = null\n\n    const run = async () => {\n      inflightController?.abort()\n      inflightController = new AbortController()\n      try {\n        const res = await fetch(\"/api/reviews/unanswered-count\", {\n          signal: inflightController.signal,\n          cache: \"no-store\",\n        })\n        if (!mounted || !res.ok) return\n        const data = await res.json()\n        const next = Number(data?.count)\n        if (Number.isFinite(next)) {\n          unansweredCountCache = { value: next, updatedAt: Date.now() }\n          setCount(next)\n        }\n      } catch {\n        // ignore polling failures\n      }\n    }\n\n    const cacheIsFresh = Date.now() - unansweredCountCache.updatedAt < UNANSWERED_CACHE_TTL_MS\n    if (cacheIsFresh) {\n      setCount(unansweredCountCache.value)\n    } else {\n      void run()\n    }\n    timer = setInterval(run, 20_000)\n    return () => {\n      mounted = false\n      inflightController?.abort()\n      if (timer) clearInterval(timer)\n    }\n  }, [pollEnabled, isVisible])\n\n  return count\n}\n\nfunction viewLabelForPath(pathname: string) {\n  if (pathname.startsWith(\"/inbox\") || pathname.startsWith(\"/reviews/\")) return \"Inbox\"\n  if (pathname.startsWith(\"/performance\")) return \"Insights\"\n  if (pathname.startsWith(\"/locations\")) return \"Locations\"\n  if (pathname.startsWith(\"/users\")) return \"Team\"\n  if (pathname.startsWith(\"/settings\")) return \"Settings\"\n  return \"Inbox\"\n}\n\nfunction initials(name: string | null | undefined) {\n  if (!name) return \"U\"\n  const parts = name.trim().split(/\\s+/)\n  const a = parts[0]?.[0] ?? \"U\"\n  const b = parts.length > 1 ? parts[parts.length - 1]?.[0] ?? \"\" : \"\"\n  return `${a}${b}`.toUpperCase()\n}\n\nexport function AppShell({\n  user,\n  children,\n}: {\n  user: UserShape\n  children: React.ReactNode\n}) {\n  const pathname = usePathname()\n  const unanswered = useUnansweredCountPolling()\n  const viewLabel = viewLabelForPath(pathname)\n  const [sidebarCollapsed, setSidebarCollapsed] = React.useState(false)\n\n  React.useEffect(() => {\n    try {\n      const raw = window.localStorage.getItem(SIDEBAR_COLLAPSE_STORAGE_KEY)\n      if (raw) setSidebarCollapsed(raw === \"1\")\n    } catch {\n      // Ignore storage failures.\n    }\n  }, [])\n\n  React.useEffect(() => {\n    try {\n      window.localStorage.setItem(SIDEBAR_COLLAPSE_STORAGE_KEY, sidebarCollapsed ? \"1\" : \"0\")\n    } catch {\n      // Ignore storage failures.\n    }\n  }, [sidebarCollapsed])\n\n  const items: NavItem[] = [\n    { href: \"/inbox\", label: \"Inbox\", mobileLabel: \"Inbox\", Icon: MessageSquare },\n    { href: \"/performance\", label: \"Insights\", mobileLabel: \"Insights\", Icon: BarChart },\n    { href: \"/locations\", label: \"Locations\", mobileLabel: \"Places\", Icon: LayoutDashboard },\n    { href: \"/users\", label: \"Team\", mobileLabel: \"Team\", Icon: Users },\n    { href: \"/settings\", label: \"Settings\", mobileLabel: \"Settings\", Icon: Settings },\n  ]\n\n  return (\n    <SearchProvider>\n      <div className=\"flex h-screen w-full bg-[#f9fafb] text-zinc-900 overflow-hidden\">\n        <aside\n          className={cn(\n            \"hidden lg:flex border-r border-zinc-200 bg-white flex-col shrink-0 transition-[width] duration-200\",\n            sidebarCollapsed ? \"w-20\" : \"w-64\"\n          )}\n        >\n          <div className=\"p-6 border-b border-zinc-200\">\n            <div className=\"flex items-center justify-between mb-1\">\n              <div className=\"flex items-center gap-2\">\n                <div className=\"bg-blue-600 p-1.5 rounded-lg\">\n                  <Sparkles className=\"h-5 w-5 text-white\" />\n                </div>\n                {!sidebarCollapsed ? <span className=\"text-xl font-bold tracking-tight text-zinc-900\">ReplyAI</span> : null}\n              </div>\n              {!sidebarCollapsed ? (\n                <Button\n                  type=\"button\"\n                  variant=\"ghost\"\n                  size=\"icon\"\n                  className=\"h-7 w-7 text-zinc-500 hover:text-zinc-700\"\n                  onClick={() => setSidebarCollapsed(true)}\n                  aria-label=\"Collapse sidebar\"\n                >\n                  <ChevronLeft className=\"h-4 w-4\" />\n                </Button>\n              ) : (\n                <Button\n                  type=\"button\"\n                  variant=\"ghost\"\n                  size=\"icon\"\n                  className=\"h-7 w-7 text-zinc-500 hover:text-zinc-700\"\n                  onClick={() => setSidebarCollapsed(false)}\n                  aria-label=\"Expand sidebar\"\n                >\n                  <ChevronRight className=\"h-4 w-4\" />\n                </Button>\n              )}\n            </div>\n            {!sidebarCollapsed ? (\n              <p className=\"text-xs text-zinc-500 font-semibold uppercase tracking-wider\">Business Inbox</p>\n            ) : null}\n          </div>\n\n          <ScrollArea className=\"flex-1 p-4\">\n            <nav className=\"space-y-1\">\n              {items.map((item) => {\n                const active = isNavItemActive(pathname, item.href)\n                const count = item.href === \"/inbox\" ? unanswered : 0\n                return (\n                  <Button\n                    key={item.href}\n                    asChild\n                    variant=\"ghost\"\n                    className={cn(\n                      \"w-full h-auto rounded-lg transition-all relative group\",\n                      sidebarCollapsed ? \"px-2 py-2.5 justify-center\" : \"px-3 py-2.5 justify-start\",\n                      active ? \"bg-blue-50 text-blue-700 shadow-sm hover:bg-blue-50\" : \"text-zinc-500 hover:text-zinc-900 hover:bg-zinc-50\"\n                    )}\n                  >\n                    <Link href={item.href} className={cn(\"flex w-full items-center\", sidebarCollapsed ? \"justify-center\" : \"gap-3\")}>\n                      <item.Icon className={cn(\"h-5 w-5\", active ? \"text-blue-600\" : \"text-zinc-400 group-hover:text-zinc-600\")} />\n                      {!sidebarCollapsed ? <span className=\"text-sm font-semibold flex-1 text-left\">{item.label}</span> : null}\n                      {count > 0 && !sidebarCollapsed ? (\n                        <Badge className=\"bg-blue-600 text-white text-[10px] font-black px-1.5 py-0.5 rounded-md min-w-[20px] text-center border-transparent\">\n                          {count > 99 ? \"99+\" : count}\n                        </Badge>\n                      ) : null}\n                      {count > 0 && sidebarCollapsed ? (\n                        <Badge className=\"absolute -top-0.5 right-1 h-2.5 w-2.5 rounded-full bg-blue-600 border-transparent p-0\" />\n                      ) : null}\n                      {active && !sidebarCollapsed ? <div className=\"absolute left-0 top-2 bottom-2 w-1 bg-blue-600 rounded-full\" /> : null}\n                    </Link>\n                  </Button>\n                )\n              })}\n            </nav>\n          </ScrollArea>\n\n          <div className=\"p-4 border-t border-zinc-100\">\n            <DropdownMenu>\n              <DropdownMenuTrigger asChild>\n                <Button\n                  type=\"button\"\n                  variant=\"ghost\"\n                  className={cn(\n                    \"w-full p-2 rounded-lg hover:bg-zinc-50 transition-colors h-auto\",\n                    sidebarCollapsed ? \"justify-center\" : \"flex items-center gap-3 justify-start\"\n                  )}\n                >\n                  <Avatar className=\"h-8 w-8 border border-blue-100\">\n                    <AvatarImage src={user.image ?? undefined} alt={user.name ?? \"User\"} />\n                    <AvatarFallback className=\"bg-blue-100 text-blue-700 font-bold text-xs\">\n                      {initials(user.name)}\n                    </AvatarFallback>\n                  </Avatar>\n                  {!sidebarCollapsed ? (\n                    <>\n                      <div className=\"flex-1 min-w-0 text-left\">\n                        <p className=\"text-sm font-medium text-zinc-900 truncate\">{user.name ?? \"User\"}</p>\n                        <p className=\"text-xs text-zinc-500 truncate\">{user.email ?? \"No email\"}</p>\n                      </div>\n                      <ChevronDown className=\"h-4 w-4 text-zinc-400\" />\n                    </>\n                  ) : null}\n                </Button>\n              </DropdownMenuTrigger>\n              <DropdownMenuContent align=\"end\" className=\"w-56\">\n                <DropdownMenuItem\n                  onSelect={() => signOut({ callbackUrl: \"/signin\" })}\n                  className=\"cursor-pointer\"\n                >\n                  <LogOut className=\"size-4\" />\n                  Sign out\n                </DropdownMenuItem>\n              </DropdownMenuContent>\n            </DropdownMenu>\n          </div>\n        </aside>\n\n        <main className=\"flex-1 flex flex-col relative overflow-hidden\">\n          <header className=\"h-16 bg-white border-b border-zinc-200 flex items-center justify-between px-6 shrink-0 z-10\">\n            <div className=\"flex items-center gap-4\">\n              <h2 className=\"text-lg font-semibold text-zinc-900 capitalize\">{viewLabel}</h2>\n              <Separator orientation=\"vertical\" className=\"h-4 bg-zinc-200\" />\n              <div className=\"flex items-center gap-2 text-sm text-zinc-500\">\n                <Globe className=\"h-4 w-4\" />\n                <span>Google Business Profile</span>\n              </div>\n            </div>\n\n            <div className=\"flex items-center gap-3\">\n              {pathname.startsWith(\"/inbox\") && unanswered > 0 ? (\n                <Button\n                  type=\"button\"\n                  onClick={() => window.dispatchEvent(new Event(\"replyai:open-blitz\"))}\n                  className=\"flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg text-sm font-medium shadow-sm\"\n                >\n                  <Sparkles className=\"h-4 w-4\" />\n                  <span>Quick Reply</span>\n                </Button>\n              ) : null}\n              <Button type=\"button\" variant=\"ghost\" size=\"icon\" className=\"p-2 text-zinc-400 hover:text-zinc-600 relative h-9 w-9\">\n                <Bell className=\"h-5 w-5\" />\n                <div className=\"absolute top-2 right-2 h-2 w-2 bg-red-500 border-2 border-white rounded-full\" />\n              </Button>\n            </div>\n          </header>\n\n          <div className=\"flex-1 overflow-y-auto\">{children}</div>\n\n          <div className=\"lg:hidden h-16 bg-white border-t border-zinc-200 flex items-center justify-around px-2 shrink-0\">\n            {items.map((item) => {\n              const active = isNavItemActive(pathname, item.href)\n              return (\n                <Button\n                  key={item.href}\n                  asChild\n                  variant=\"ghost\"\n                  className={cn(\n                    \"flex flex-col items-center justify-center gap-1 flex-1 h-full rounded-none\",\n                    active ? \"text-blue-600 hover:text-blue-600\" : \"text-zinc-400\"\n                  )}\n                >\n                  <Link href={item.href}>\n                    <item.Icon className=\"h-5 w-5\" />\n                    <span className=\"text-[10px] font-bold uppercase tracking-tight\">{item.mobileLabel}</span>\n                  </Link>\n                </Button>\n              )\n            })}\n          </div>\n        </main>\n      </div>\n    </SearchProvider>\n  )\n}\n\nexport function ShellBadge({\n  children,\n  className,\n}: {\n  children: React.ReactNode\n  className?: string\n}) {\n  return (\n    <Badge className={cn(\"bg-zinc-900 text-white\", className)}>{children}</Badge>\n  )\n}\n"
    },
    {
      "path": "components/DraftEditor.tsx",
      "content": "\"use client\"\n\nimport * as React from \"react\"\nimport { toast } from \"sonner\"\nimport { cn } from \"@/lib/utils\"\nimport {\n  type ReviewDetail,\n} from \"@/lib/hooks\"\nimport { Button } from \"@/components/ui/button\"\nimport { Badge } from \"@/components/ui/badge\"\nimport { Textarea } from \"@/components/ui/textarea\"\nimport { ToggleGroup, ToggleGroupItem } from \"@/components/ui/toggle-group\"\nimport { withIdempotencyHeader } from \"@/lib/api/client-idempotency\"\nimport {\n  Sparkles,\n  RefreshCw,\n  ShieldCheck,\n  AlertTriangle,\n  Save,\n  Copy,\n  ArrowUpRight,\n} from \"@/components/icons\"\n\ntype Props = {\n  reviewId: string\n  review: ReviewDetail\n  refresh: () => void\n}\n\nexport function DraftEditor({ reviewId, review, refresh }: Props) {\n  const draft = review.currentDraft\n  const [text, setText] = React.useState(draft?.text ?? \"\")\n  const [busy, setBusy] = React.useState<false | \"generate\" | \"save\" | \"verify\" | \"publish\">(false)\n  const [tone, setTone] = React.useState(\"professional\")\n  const isRegenTarget = React.useRef(false)\n\n  React.useEffect(() => {\n    setText(draft?.text ?? \"\")\n  }, [draft?.id, draft?.text])\n\n  const isDirty = text !== (draft?.text ?? \"\")\n  const wordCount = text.trim().split(/\\s+/).filter(Boolean).length\n  const hasText = text.trim().length > 0\n  const isReplied = Boolean(review.reply.comment)\n  const isBlocked = draft?.status === \"BLOCKED_BY_VERIFIER\"\n\n  // Parse verifier results\n  const verifierJson = draft?.verifierResultJson as null | { pass?: boolean; issues?: string[] }\n  const verifierIssues = verifierJson?.issues ?? []\n\n  const apiCall = async (url: string, method: string, body?: unknown) => {\n    const normalizedMethod = method.toUpperCase()\n    const requiresIdempotency =\n      normalizedMethod === \"POST\" ||\n      normalizedMethod === \"PUT\" ||\n      normalizedMethod === \"PATCH\" ||\n      normalizedMethod === \"DELETE\"\n    const baseHeaders = body ? { \"content-type\": \"application/json\" } : undefined\n    const headers = requiresIdempotency ? withIdempotencyHeader(baseHeaders) : baseHeaders\n    const res = await fetch(url, {\n      method: normalizedMethod,\n      headers,\n      body: body ? JSON.stringify(body) : undefined,\n    })\n    if (res.status === 401) { window.location.href = \"/signin\"; return null }\n    const data = await res.json().catch(() => null)\n    if (!res.ok) throw new Error(data?.error ?? res.statusText)\n    return data\n  }\n\n  const generate = async () => {\n    setBusy(\"generate\")\n    isRegenTarget.current = true\n    try {\n      await apiCall(`/api/reviews/${reviewId}/drafts/generate`, \"POST\")\n      toast.success(\"Draft generated\")\n      refresh()\n    } catch (e) { toast.error(e instanceof Error ? e.message : String(e)) }\n    finally { setBusy(false) }\n  }\n\n  const save = async () => {\n    if (!hasText) return\n    setBusy(\"save\")\n    try {\n      await apiCall(`/api/reviews/${reviewId}/drafts/edit`, \"POST\", { text })\n      toast.success(\"Draft saved\")\n      refresh()\n    } catch (e) { toast.error(e instanceof Error ? e.message : String(e)) }\n    finally { setBusy(false) }\n  }\n\n  const verify = async () => {\n    setBusy(\"verify\")\n    try {\n      await apiCall(`/api/reviews/${reviewId}/drafts/verify`, \"POST\")\n      toast.success(\"Verification complete\")\n      refresh()\n    } catch (e) { toast.error(e instanceof Error ? e.message : String(e)) }\n    finally { setBusy(false) }\n  }\n\n  const publish = async () => {\n    setBusy(\"publish\")\n    try {\n      await apiCall(`/api/reviews/${reviewId}/reply/post`, \"POST\")\n      toast.success(\"Reply published!\")\n      refresh()\n    } catch (e) { toast.error(e instanceof Error ? e.message : String(e)) }\n    finally { setBusy(false) }\n  }\n\n  const copyText = () => {\n    if (!hasText) return\n    navigator.clipboard?.writeText(text).then(\n      () => toast.success(\"Copied\"),\n      () => toast.error(\"Copy failed\")\n    )\n  }\n\n  // Empty state â€” no draft yet\n  if (!draft && !isReplied) {\n    return (\n      <div className=\"space-y-4\">\n        <div className=\"flex items-center gap-2 px-1\">\n          <div className=\"h-7 w-7 rounded-full bg-primary/10 flex items-center justify-center border border-primary/20\">\n            <Sparkles className=\"h-3.5 w-3.5 text-primary\" />\n          </div>\n          <span className=\"text-sm font-semibold text-foreground\">AI Draft</span>\n        </div>\n\n        <Button\n          type=\"button\"\n          onClick={generate}\n          disabled={Boolean(busy)}\n          className=\"w-full rounded-3xl border-2 border-dashed border-border bg-card hover:border-primary/40 hover:bg-primary/10 transition-all p-10 flex flex-col items-center gap-4 group\"\n        >\n          {busy === \"generate\" ? (\n            <RefreshCw className=\"h-8 w-8 text-primary animate-spin\" />\n          ) : (\n            <div className=\"h-14 w-14 rounded-2xl bg-primary/10 flex items-center justify-center group-hover:bg-primary/20 transition-colors border border-primary/20\">\n              <Sparkles className=\"h-7 w-7 text-primary\" />\n            </div>\n          )}\n          <div className=\"text-center\">\n            <div className=\"text-sm font-bold text-foreground\">Generate AI Draft</div>\n            <div className=\"text-xs text-muted-foreground mt-1\">Create a smart reply powered by AI</div>\n          </div>\n        </Button>\n      </div>\n    )\n  }\n\n  // Already replied â€” read-only\n  if (isReplied) return null\n\n  return (\n    <div className=\"space-y-4\">\n      {/* Header */}\n      <div className=\"flex items-center justify-between px-1\">\n        <div className=\"flex items-center gap-2\">\n          <div className=\"h-7 w-7 rounded-full bg-primary/10 flex items-center justify-center border border-primary/20\">\n            <Sparkles className=\"h-3.5 w-3.5 text-primary\" />\n          </div>\n          <span className=\"text-sm font-semibold text-foreground\">AI Draft</span>\n          {isDirty && (\n            <Badge variant=\"secondary\" className=\"rounded-md text-[9px] h-5 px-2 bg-amber-100 text-amber-700 border-amber-200\">\n              Unsaved\n            </Badge>\n          )}\n        </div>\n\n        {/* Tone Picker */}\n        <ToggleGroup\n          type=\"single\"\n          value={tone}\n          onValueChange={(value) => {\n            if (value) setTone(value)\n          }}\n          className=\"flex bg-muted p-1 rounded-xl border border-border\"\n        >\n          {[\"professional\", \"friendly\", \"concise\"].map((t) => (\n            <ToggleGroupItem\n              key={t}\n              value={t}\n              className={cn(\n                \"px-3 py-1.5 text-xs font-medium rounded-lg transition-all capitalize\",\n                tone === t ? \"bg-card shadow-sm text-foreground ring-1 ring-border\" : \"text-muted-foreground hover:text-foreground\"\n              )}\n            >\n              {t}\n            </ToggleGroupItem>\n          ))}\n        </ToggleGroup>\n      </div>\n\n      {/* Editor */}\n      <div className={cn(\n        \"relative rounded-3xl border transition-all overflow-hidden bg-card group focus-within:ring-4 focus-within:ring-ring/30 shadow-card\",\n        isBlocked ? \"border-orange-200 shadow-orange-50\" : \"border-border\"\n      )}>\n        <Textarea\n          value={text}\n          onChange={(e) => setText(e.target.value)}\n          placeholder=\"Draft your reply...\"\n          className={cn(\n            \"min-h-[240px] text-base p-8 resize-none border-0 focus-visible:ring-0 leading-relaxed text-foreground placeholder:text-muted-foreground\",\n            busy === \"generate\" && \"opacity-50 blur-[1px] transition-all\"\n          )}\n        />\n\n        {busy === \"generate\" && (\n          <div className=\"absolute inset-0 flex items-center justify-center bg-background/60 backdrop-blur-sm\">\n            <RefreshCw className=\"h-8 w-8 text-primary animate-spin\" />\n          </div>\n        )}\n\n        {/* Editor Footer */}\n        <div className=\"bg-muted/60 backdrop-blur-md p-4 border-t border-border flex items-center justify-between\">\n          {isBlocked && verifierIssues.length > 0 ? (\n            <div className=\"flex items-center gap-2 text-orange-700 text-xs font-medium bg-orange-50 px-3 py-1.5 rounded-lg border border-orange-100 max-w-[70%]\">\n              <AlertTriangle className=\"h-4 w-4 shrink-0\" />\n              <span className=\"truncate\">{verifierIssues[0]}</span>\n            </div>\n          ) : draft?.status === \"READY\" ? (\n            <div className=\"flex items-center gap-2 text-emerald-700 text-xs font-medium bg-emerald-50 px-3 py-1.5 rounded-lg border border-emerald-100\">\n              <ShieldCheck className=\"h-4 w-4\" />\n              Verified facts against profile\n            </div>\n          ) : (\n            <div className=\"text-xs text-muted-foreground font-medium\">\n              Ready to verify\n            </div>\n          )}\n          <div className=\"flex items-center gap-3 text-xs text-muted-foreground font-medium\">\n            <span>{wordCount} words</span>\n            <span>{text.length} chars</span>\n          </div>\n        </div>\n      </div>\n\n      {/* Action Footer */}\n      <div className=\"flex items-center justify-between px-1\">\n        <div className=\"flex items-center gap-2\">\n          <Button\n            variant=\"ghost\"\n            size=\"sm\"\n            onClick={copyText}\n            disabled={!hasText}\n            className=\"text-muted-foreground hover:text-foreground rounded-xl h-9 text-xs\"\n          >\n            <Copy className=\"h-3.5 w-3.5 mr-1.5\" /> Copy\n          </Button>\n          <Button\n            variant=\"ghost\"\n            size=\"sm\"\n            onClick={generate}\n            disabled={Boolean(busy)}\n            className=\"text-muted-foreground hover:text-primary hover:bg-primary/10 rounded-xl h-9 text-xs\"\n          >\n            <RefreshCw className={cn(\"h-3.5 w-3.5 mr-1.5\", busy === \"generate\" && \"animate-spin\")} /> Regenerate\n          </Button>\n        </div>\n\n        <div className=\"flex items-center gap-3\">\n          <Button\n            variant=\"outline\"\n            size=\"sm\"\n            onClick={save}\n            disabled={!isDirty || Boolean(busy)}\n            className=\"rounded-xl border-border text-muted-foreground h-9 text-xs min-w-[80px]\"\n          >\n            {busy === \"save\" ? <RefreshCw className=\"h-3.5 w-3.5 animate-spin\" /> : <><Save className=\"h-3.5 w-3.5 mr-1.5\" /> Save</>}\n          </Button>\n          <Button\n            variant=\"outline\"\n            size=\"sm\"\n            onClick={verify}\n            disabled={!hasText || Boolean(busy)}\n            className=\"rounded-xl border-border text-muted-foreground h-9 text-xs min-w-[80px]\"\n          >\n            {busy === \"verify\" ? <RefreshCw className=\"h-3.5 w-3.5 animate-spin\" /> : <><ShieldCheck className=\"h-3.5 w-3.5 mr-1.5\" /> Verify</>}\n          </Button>\n          <Button\n            size=\"sm\"\n            onClick={publish}\n            disabled={!hasText || Boolean(busy)}\n            className=\"bg-primary hover:bg-primary/90 text-primary-foreground rounded-xl shadow-elevated font-medium h-9 text-xs min-w-[140px]\"\n          >\n            {busy === \"publish\" ? (\n              <RefreshCw className=\"h-3.5 w-3.5 animate-spin\" />\n            ) : (\n              <>Approve & Reply <ArrowUpRight className=\"h-3.5 w-3.5 ml-1.5\" /></>\n            )}\n          </Button>\n        </div>\n      </div>\n    </div>\n  )\n}\n"
    },
    {
      "path": "components/icons.ts",
      "content": "// Single source of truth for the app's icon library.\n// Preset: Phosphor icons (Nova / Zinc / Blue / LTR).\n//\n// All app code should import icons from here, never directly from icon packages,\n// so we can swap libraries without touching the whole codebase.\n\nexport {\n  ArrowLeft,\n  ArrowSquareOut as ExternalLink,\n  ArrowClockwise as RefreshCw,\n  Bell,\n  CaretDown as ChevronDown,\n  CaretRight as ChevronRight,\n  CaretUp as ChevronUp,\n  Check,\n  CheckCircle as CheckCircle2,\n  Circle,\n  CircleNotch as Loader2,\n  Clock,\n  Copy,\n  EnvelopeSimple as Mail,\n  FloppyDisk as Save,\n  GearSix as Settings,\n  Laptop,\n  Lightning as Zap,\n  List as Menu,\n  MagnifyingGlass as Search,\n  MapPin,\n  ChatCenteredDots as MessageSquare,\n  Moon,\n  Plus,\n  Question as CircleHelp,\n  Question as HelpCircle,\n  ShieldCheck,\n  SignOut as LogOut,\n  Sparkle as Sparkles,\n  Star,\n  Sun,\n  TrendUp as TrendingUp,\n  User,\n  Users,\n  Warning as AlertTriangle,\n  X,\n  Trash as Trash2,\n  ArrowUpRight,\n  ThumbsUp,\n  ThumbsDown,\n  ClockCounterClockwise as History,\n  ChartBar as BarChart,\n  Eye,\n  PencilSimple as Pencil,\n  FunnelSimple as Filter,\n  ArrowRight,\n  CaretLeft as ChevronLeft,\n  DotsThree as MoreHorizontal,\n  SquaresFour as LayoutDashboard,\n  Envelope,\n  PencilSimpleLine as Edit,\n  PaperPlaneRight as Send,\n  GlobeSimple as Globe,\n  ArrowUp,\n  ArrowDown,\n} from \"@phosphor-icons/react/ssr\"\n"
    },
    {
      "path": "components/JobHealthWidget.tsx",
      "content": "\"use client\"\n\nimport * as React from \"react\"\nimport { useJobSummaryPolling } from \"@/lib/hooks\"\nimport { Badge } from \"@/components/ui/badge\"\nimport { Button } from \"@/components/ui/button\"\nimport { Card } from \"@/components/ui/card\"\nimport { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle, DialogTrigger } from \"@/components/ui/dialog\"\nimport { AlertTriangle, CheckCircle2, Loader2 } from \"@/components/icons\"\nimport { cn } from \"@/lib/utils\"\n\nexport function JobHealthWidget({ compact = false }: { compact?: boolean }) {\n  const { summary, backlog, failed24h, error } = useJobSummaryPolling(20_000)\n  const aiQuality = summary?.aiQuality24h\n\n  const label = error\n    ? \"Unavailable\"\n    : failed24h > 0\n      ? `${failed24h} failed`\n      : backlog > 0\n        ? `${backlog} queued`\n        : \"All clear\"\n\n  const hasIssue = error || failed24h > 0\n\n  return (\n    <Dialog>\n      <DialogTrigger asChild>\n        <Button\n          type=\"button\"\n          variant=\"ghost\"\n          className={cn(\n            \"w-full flex items-center gap-2 text-left py-1.5 px-1.5 rounded-lg transition-colors hover:bg-muted/60 outline-none focus-visible:ring-2 focus-visible:ring-ring\",\n            compact && \"px-0\"\n          )}\n        >\n          {hasIssue ? (\n            <div className=\"size-6 rounded-md bg-destructive/10 grid place-items-center shrink-0\">\n              <AlertTriangle className=\"size-3 text-destructive\" />\n            </div>\n          ) : backlog > 0 ? (\n            <div className=\"size-6 rounded-md bg-primary/10 grid place-items-center shrink-0\">\n              <Loader2 className=\"size-3 text-primary animate-spin\" />\n            </div>\n          ) : (\n            <div className=\"size-6 rounded-md bg-emerald-500/10 grid place-items-center shrink-0\">\n              <CheckCircle2 className=\"size-3 text-emerald-500\" />\n            </div>\n          )}\n          <div className=\"flex-1 min-w-0\">\n            <div className=\"text-[10px] font-semibold leading-none\">Jobs</div>\n            <div className=\"text-[9px] text-muted-foreground truncate mt-0.5\">{label}</div>\n          </div>\n        </Button>\n      </DialogTrigger>\n\n      <DialogContent className=\"max-w-lg rounded-xl\">\n        <DialogHeader>\n          <DialogTitle className=\"text-base\">System Health</DialogTitle>\n          <DialogDescription className=\"text-xs\">\n            Worker queue status and recent failures\n          </DialogDescription>\n        </DialogHeader>\n\n        <div className={cn(\"grid gap-3\", aiQuality ? \"grid-cols-2 lg:grid-cols-4\" : \"grid-cols-2\")}>\n          <Card className=\"rounded-xl p-4 shadow-card\">\n            <div className=\"text-[9px] font-bold text-muted-foreground uppercase tracking-wider\">Backlog</div>\n            <div className=\"mt-1.5 text-2xl font-bold tabular-nums\">{backlog}</div>\n          </Card>\n          <Card className=\"rounded-xl p-4 shadow-card\">\n            <div className=\"text-[9px] font-bold text-muted-foreground uppercase tracking-wider\">Failed (24h)</div>\n            <div className={cn(\"mt-1.5 text-2xl font-bold tabular-nums\", failed24h > 0 && \"text-destructive\")}>{failed24h}</div>\n          </Card>\n          {aiQuality ? (\n            <Card className=\"rounded-xl p-4 shadow-card\">\n              <div className=\"text-[9px] font-bold text-muted-foreground uppercase tracking-wider\">SEO Coverage</div>\n              <div className=\"mt-1.5 text-2xl font-bold tabular-nums\">{(aiQuality.avgKeywordCoverage * 100).toFixed(0)}%</div>\n            </Card>\n          ) : null}\n          {aiQuality ? (\n            <Card className=\"rounded-xl p-4 shadow-card\">\n              <div className=\"text-[9px] font-bold text-muted-foreground uppercase tracking-wider\">Stuffing Risk</div>\n              <div className={cn(\"mt-1.5 text-2xl font-bold tabular-nums\", aiQuality.stuffingRisk > 0 && \"text-destructive\")}>\n                {(aiQuality.stuffingRiskRate * 100).toFixed(1)}%\n              </div>\n            </Card>\n          ) : null}\n        </div>\n        {aiQuality?.topProgramVersion ? (\n          <div className=\"text-[11px] text-muted-foreground\">\n            Active DSPy program: <span className=\"font-mono\">{aiQuality.topProgramVersion}</span>\n          </div>\n        ) : null}\n\n        {summary?.recentFailures?.length ? (\n          <div className=\"space-y-2\">\n            <div className=\"text-xs font-semibold\">Recent Failures</div>\n            <div className=\"max-h-[250px] overflow-auto scrollbar-thin space-y-1.5\">\n              {summary.recentFailures.slice(0, 8).map((f) => (\n                <Card key={f.id} className=\"rounded-lg p-3 shadow-card\">\n                  <div className=\"flex items-center justify-between gap-2\">\n                    <Badge variant=\"secondary\" className=\"rounded-md text-[10px] h-5 px-1.5\">{f.type}</Badge>\n                    <span className=\"text-[9px] text-muted-foreground font-mono truncate max-w-[120px]\">{f.id}</span>\n                  </div>\n                  {f.lastError && (\n                    <p className=\"mt-1.5 text-[11px] text-muted-foreground whitespace-pre-wrap break-words leading-relaxed\">\n                      {f.lastError}\n                    </p>\n                  )}\n                </Card>\n              ))}\n            </div>\n          </div>\n        ) : (\n          <div className=\"rounded-xl border-2 border-dashed border-muted p-6 text-center\">\n            <CheckCircle2 className=\"size-5 text-emerald-500 mx-auto mb-1.5\" />\n            <p className=\"text-xs text-muted-foreground\">No failures recorded</p>\n          </div>\n        )}\n      </DialogContent>\n    </Dialog>\n  )\n}\n"
    },
    {
      "path": "components/Providers.tsx",
      "content": "\"use client\"\n\nimport * as React from \"react\"\nimport { SessionProvider } from \"next-auth/react\"\nimport { ThemeProvider } from \"@/components/ThemeProvider\"\nimport { Toaster } from \"@/components/ui/sonner\"\nimport { DirectionProvider } from \"@/components/ui/direction\"\n\nexport function Providers({ children }: { children: React.ReactNode }) {\n  return (\n    <SessionProvider>\n      <ThemeProvider>\n        <DirectionProvider dir=\"ltr\">\n          {children}\n          <Toaster />\n        </DirectionProvider>\n      </ThemeProvider>\n    </SessionProvider>\n  )\n}\n"
    },
    {
      "path": "components/ReviewCard.tsx",
      "content": "\"use client\"\n\nimport * as React from \"react\"\nimport { cn } from \"@/lib/utils\"\nimport { formatAge, type ReviewRow } from \"@/lib/hooks\"\nimport { Avatar, AvatarFallback } from \"@/components/ui/avatar\"\nimport { Checkbox } from \"@/components/ui/checkbox\"\nimport { Star, MapPin, CheckCircle2, AlertTriangle, Clock } from \"@/components/icons\"\n\nfunction initials(name: string) {\n  const parts = name.trim().split(/\\s+/).filter(Boolean)\n  const a = parts[0]?.[0] ?? \"?\"\n  const b = parts.length > 1 ? parts[parts.length - 1]?.[0] : \"\"\n  return (a + b).toUpperCase()\n}\n\nfunction SparklesIcon({ className, weight }: { className?: string; weight?: string }) {\n  return (\n    <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 256 256\" className={className} fill=\"currentColor\">\n      <title>Sparkles</title>\n      {weight === \"fill\" ? (\n        <path d=\"M216 112a8 8 0 0 1-8 8 80.1 80.1 0 0 0-80 80 8 8 0 0 1-16 0 80.1 80.1 0 0 0-80-80 8 8 0 0 1 0-16 80.1 80.1 0 0 0 80-80 8 8 0 0 1 16 0 80.1 80.1 0 0 0 80 80 8 8 0 0 1 8 8Z\" />\n      ) : (\n        <path d=\"M216 112a8 8 0 0 1-8 8 80.1 80.1 0 0 0-80 80 8 8 0 0 1-16 0 80.1 80.1 0 0 0-80-80 8 8 0 0 1 0-16 80.1 80.1 0 0 0 80-80 8 8 0 0 1 16 0 80.1 80.1 0 0 0 80 80 8 8 0 0 1 8 8Z\" fill=\"none\" stroke=\"currentColor\" strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"16\" />\n      )}\n    </svg>\n  )\n}\n\nfunction StarsRow({ value }: { value: number }) {\n  return (\n    <div className=\"inline-flex items-center gap-0.5\" role=\"img\" aria-label={`${value} stars`}>\n      {Array.from({ length: 5 }, (_, i) => (\n        <Star\n          key={`star-${i}-${value}`}\n          weight={i < value ? \"fill\" : \"regular\"}\n          className={cn(\n            \"h-3.5 w-3.5\",\n            i < value ? \"fill-primary text-primary\" : \"text-muted-foreground/30\"\n          )}\n        />\n      ))}\n    </div>\n  )\n}\n\nfunction StatusBadge({ row }: { row: ReviewRow }) {\n  if (!row.unanswered) {\n    return (\n      <div className=\"flex items-center gap-1 text-[10px] font-bold text-emerald-600 bg-emerald-50 px-2 py-1 rounded-full border border-emerald-100/50\">\n        <CheckCircle2 className=\"size-3\" weight=\"fill\" />\n        <span>Replied</span>\n      </div>\n    )\n  }\n\n  if (row.draftStatus === \"READY\") {\n    return (\n      <div className=\"flex items-center gap-1 text-[10px] font-bold text-blue-600 bg-blue-50 px-2 py-1 rounded-full border border-blue-100/50\">\n        <SparklesIcon className=\"size-3\" weight=\"fill\" />\n        <span>Draft Ready</span>\n      </div>\n    )\n  }\n\n  if (row.draftStatus === \"BLOCKED_BY_VERIFIER\") {\n    return (\n      <div className=\"flex items-center gap-1 text-[10px] font-bold text-rose-600 bg-rose-50 px-2 py-1 rounded-full border border-rose-100/50\">\n        <AlertTriangle className=\"size-3\" weight=\"fill\" />\n        <span>Flagged</span>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"flex items-center gap-1 text-[10px] font-bold text-amber-600 bg-amber-50 px-2 py-1 rounded-full border border-amber-100/50\">\n      <Clock className=\"size-3\" weight=\"fill\" />\n      <span>Needs Reply</span>\n    </div>\n  )\n}\n\nexport const ReviewCard = React.memo(function ReviewCard({\n  reviewId,\n  row,\n  showCheckbox,\n  checked,\n  onCheckedChange,\n  onOpen,\n  selected,\n}: {\n  reviewId: string\n  row: ReviewRow\n  showCheckbox: boolean\n  checked: boolean\n  onCheckedChange: (reviewId: string, val: boolean) => void\n  onOpen: (reviewId: string) => void\n  selected: boolean\n}) {\n  const name = row.reviewer.displayName || \"Anonymous\"\n  const initial = initials(name)\n  const isNegative = row.starRating <= 2\n\n  return (\n    <div\n      onClick={() => onOpen(reviewId)}\n      className={cn(\n        // Avoid layout/entrance animations for list items; it degrades scroll/typing smoothness as the list grows.\n        \"group relative w-full rounded-2xl transition-colors duration-200 border border-transparent select-none cursor-pointer\",\n        selected\n          ? \"bg-primary/5 border-primary/10 shadow-sm z-10\"\n          : \"bg-card hover:bg-muted/30 hover:border-border/60 shadow-card hover:shadow-elevated\"\n      )}\n    >\n      <div className=\"p-4 sm:p-5 flex flex-col gap-3\">\n        <div className=\"flex items-start justify-between gap-3\">\n          <div className=\"flex items-center gap-3 min-w-0\">\n            <div className=\"relative shrink-0\">\n              <Avatar className=\"h-10 w-10 border border-border/40 shadow-sm transition-transform group-hover:scale-105\">\n                <AvatarFallback className={cn(\"text-xs font-bold\", selected ? \"bg-primary text-primary-foreground\" : \"bg-muted text-muted-foreground\")}>\n                  {initial}\n                </AvatarFallback>\n              </Avatar>\n              {isNegative && (\n                <div className=\"absolute -bottom-0.5 -right-0.5 bg-background rounded-full p-0.5 shadow-sm ring-1 ring-border\">\n                  <div className=\"bg-rose-500 h-2.5 w-2.5 rounded-full\" />\n                </div>\n              )}\n            </div>\n            <div className=\"min-w-0\">\n              <div className=\"font-bold text-sm truncate text-foreground leading-tight\">\n                {name}\n              </div>\n              <div className=\"flex items-center gap-1.5 text-[11px] text-muted-foreground font-medium mt-0.5\">\n                 <MapPin className=\"size-3 shrink-0 opacity-70\" />\n                 <span className=\"truncate\">{row.location.displayName}</span>\n              </div>\n            </div>\n          </div>\n          \n          <div className=\"flex flex-col items-end gap-1 shrink-0\">\n             <span className=\"text-[10px] text-muted-foreground font-semibold tabular-nums opacity-60\">\n               {formatAge(row.createTimeIso)}\n             </span>\n             {showCheckbox ? (\n                <div\n                  onClick={(e) => {\n                    e.stopPropagation()\n                  }}\n                  className=\"pt-1 flex items-center justify-center\"\n                >\n                  <Checkbox checked={checked} onCheckedChange={(v) => onCheckedChange(reviewId, Boolean(v))} />\n                </div>\n             ) : (\n                <StarsRow value={row.starRating} />\n             )}\n          </div>\n        </div>\n\n        <div className=\"pl-[52px]\">\n          <p className={cn(\n             \"text-sm leading-relaxed line-clamp-2\", \n             row.snippet ? \"text-muted-foreground/90\" : \"text-muted-foreground/40 italic\"\n          )}>\n            {row.snippet || \"No written comment\"}\n          </p>\n        </div>\n\n        <div className=\"pl-[52px] flex items-center justify-between pt-1\">\n          <StatusBadge row={row} />\n        </div>\n      </div>\n      \n      {selected && (\n        <div className=\"absolute left-0 top-3 bottom-3 w-1 bg-primary rounded-r-full\" />\n      )}\n    </div>\n  )\n})\nReviewCard.displayName = \"ReviewCard\"\n"
    },
    {
      "path": "components/ReviewDetail.tsx",
      "content": "\"use client\"\n\nimport * as React from \"react\"\nimport { cn } from \"@/lib/utils\"\nimport { useReviewDetail, formatAge } from \"@/lib/hooks\"\nimport { Badge } from \"@/components/ui/badge\"\nimport { Avatar, AvatarFallback } from \"@/components/ui/avatar\"\nimport { Button } from \"@/components/ui/button\"\nimport { ScrollArea } from \"@/components/ui/scroll-area\"\nimport { Skeleton } from \"@/components/ui/skeleton\"\nimport { DraftEditor } from \"@/components/DraftEditor\"\nimport Link from \"next/link\"\nimport {\n  Star,\n  MapPin,\n  AlertTriangle,\n  ArrowLeft,\n  CheckCircle2,\n  ThumbsUp,\n  ThumbsDown,\n} from \"@/components/icons\"\n\nfunction initials(name: string | null | undefined) {\n  if (!name) return \"?\"\n  const parts = name.trim().split(/\\s+/)\n  const a = parts[0]?.[0] ?? \"?\"\n  const b = parts.length > 1 ? parts[parts.length - 1]?.[0] : \"\"\n  return (a + b).toUpperCase()\n}\n\nfunction SparklesIcon({ className, weight }: { className?: string; weight?: string }) {\n  return (\n    <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 256 256\" className={className} fill=\"currentColor\">\n      <title>Sparkles</title>\n      {weight === \"fill\" ? (\n        <path d=\"M216 112a8 8 0 0 1-8 8 80.1 80.1 0 0 0-80 80 8 8 0 0 1-16 0 80.1 80.1 0 0 0-80-80 8 8 0 0 1 0-16 80.1 80.1 0 0 0 80-80 8 8 0 0 1 16 0 80.1 80.1 0 0 0 80 80 8 8 0 0 1 8 8Z\" />\n      ) : (\n        <path d=\"M216 112a8 8 0 0 1-8 8 80.1 80.1 0 0 0-80 80 8 8 0 0 1-16 0 80.1 80.1 0 0 0-80-80 8 8 0 0 1 0-16 80.1 80.1 0 0 0 80-80 8 8 0 0 1 16 0 80.1 80.1 0 0 0 80 80 8 8 0 0 1 8 8Z\" fill=\"none\" stroke=\"currentColor\" strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"16\" />\n      )}\n    </svg>\n  )\n}\n\nfunction StarsRow({ value }: { value: number }) {\n  return (\n    <div className=\"flex items-center gap-0.5\" role=\"img\" aria-label={`${value} stars`}>\n      {Array.from({ length: 5 }, (_, i) => (\n        <Star\n          key={`star-${i}-${value}`}\n          weight={i < value ? \"fill\" : \"regular\"}\n          className={cn(\n            \"h-3.5 w-3.5\",\n            i < value ? \"fill-primary text-primary\" : \"text-muted-foreground/30\"\n          )}\n        />\n      ))}\n    </div>\n  )\n}\n\nfunction SentimentBadge({ stars }: { stars: number }) {\n  if (stars >= 4) {\n    return (\n      <div className=\"inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full bg-emerald-50 text-emerald-700 border border-emerald-100/50\">\n        <ThumbsUp className=\"size-3\" weight=\"fill\" />\n        <span className=\"text-[10px] font-bold uppercase tracking-wider\">Positive</span>\n      </div>\n    )\n  }\n  if (stars === 3) {\n    return (\n      <div className=\"inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full bg-amber-50 text-amber-700 border border-amber-100/50\">\n        <div className=\"size-3 rounded-full border-2 border-current opacity-60\" />\n        <span className=\"text-[10px] font-bold uppercase tracking-wider\">Neutral</span>\n      </div>\n    )\n  }\n  return (\n    <div className=\"inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full bg-rose-50 text-rose-700 border border-rose-100/50\">\n      <ThumbsDown className=\"size-3\" weight=\"fill\" />\n      <span className=\"text-[10px] font-bold uppercase tracking-wider\">Negative</span>\n    </div>\n  )\n}\n\nexport function ReviewDetail({ reviewId, backHref }: { reviewId: string; backHref?: string }) {\n  const { review, loading, error, refresh } = useReviewDetail(reviewId)\n\n  if (loading && !review) {\n    return (\n      <div className=\"h-full flex flex-col p-6 space-y-8 max-w-2xl mx-auto w-full\">\n        <div className=\"flex items-center gap-4\">\n          <Skeleton className=\"h-12 w-12 rounded-full\" />\n          <div className=\"space-y-2 flex-1\">\n            <Skeleton className=\"h-4 w-32\" />\n            <Skeleton className=\"h-3 w-24\" />\n          </div>\n        </div>\n        <Skeleton className=\"h-32 w-full rounded-3xl\" />\n        <Skeleton className=\"h-64 w-full rounded-3xl\" />\n      </div>\n    )\n  }\n\n  if (error) {\n    return (\n      <div className=\"h-full flex flex-col items-center justify-center p-6 text-center\">\n        <div className=\"h-20 w-20 bg-rose-50 rounded-full flex items-center justify-center mb-4\">\n          <AlertTriangle className=\"h-8 w-8 text-rose-500/50\" />\n        </div>\n        <p className=\"text-sm font-bold text-foreground\">Unable to load review</p>\n        <p className=\"text-xs text-muted-foreground mt-1.5 max-w-[200px]\">{error}</p>\n        <Button type=\"button\" variant=\"ghost\" onClick={() => refresh()} className=\"mt-6 text-xs text-primary font-bold hover:underline h-auto p-0\">\n          Try Again\n        </Button>\n      </div>\n    )\n  }\n\n  if (!review) return null\n\n  return (\n    <div className=\"h-full flex flex-col bg-background lg:bg-transparent\">\n      {/* â”€â”€ Header â”€â”€ */}\n      <header className=\"shrink-0 px-6 py-4 flex items-center justify-between bg-background/80 backdrop-blur-xl border-b border-border sticky top-0 z-20\">\n        <div className=\"flex items-center gap-3\">\n          {backHref && (\n            <Link href={backHref} className=\"lg:hidden -ml-2 p-2 rounded-full text-muted-foreground hover:bg-muted hover:text-foreground transition-colors\">\n              <ArrowLeft className=\"size-5\" />\n            </Link>\n          )}\n          <div className=\"flex flex-col\">\n            <h2 className=\"text-sm font-bold text-foreground flex items-center gap-2\">\n              Review Details\n              <Badge variant=\"outline\" className=\"text-[9px] h-4 px-1.5 font-mono text-muted-foreground/60 border-border/50 hidden sm:flex\">\n                {reviewId.slice(-4)}\n              </Badge>\n            </h2>\n            <div className=\"text-[10px] text-muted-foreground font-medium flex items-center gap-1.5 mt-0.5\">\n               <MapPin className=\"size-3 opacity-70\" />\n               <span className=\"truncate max-w-[150px]\">{review.location.name}</span>\n            </div>\n          </div>\n        </div>\n        \n        <div className=\"flex items-center gap-3\">\n           <SentimentBadge stars={review.starRating} />\n        </div>\n      </header>\n\n      {/* â”€â”€ Content (Chat Style) â”€â”€ */}\n      <div className=\"flex-1 overflow-hidden relative\">\n        <ScrollArea className=\"h-full\">\n          <div className=\"flex flex-col gap-6 p-4 sm:p-6 max-w-3xl mx-auto w-full pb-32\">\n            \n            {/* Timestamp Divider */}\n            <div className=\"flex justify-center\">\n              <span className=\"text-[10px] font-bold text-muted-foreground/40 uppercase tracking-widest bg-muted/30 px-3 py-1 rounded-full\">\n                {formatAge(review.createTime)}\n              </span>\n            </div>\n\n            {/* User Review Message */}\n            <div className=\"flex gap-4\">\n               <Avatar className=\"h-10 w-10 border border-border shrink-0 shadow-sm mt-1\">\n                 <AvatarFallback className=\"text-xs font-bold bg-muted text-muted-foreground\">\n                   {initials(review.reviewer.displayName)}\n                 </AvatarFallback>\n               </Avatar>\n               <div className=\"flex flex-col gap-1.5 max-w-[85%]\">\n                 <div className=\"flex items-baseline justify-between gap-4 ml-1\">\n                   <span className=\"text-xs font-bold text-foreground\">\n                     {review.reviewer.displayName ?? \"Anonymous\"}\n                   </span>\n                   <StarsRow value={review.starRating} />\n                 </div>\n                 \n                 <div className=\"relative group\">\n                   <div className=\"bg-card border border-border p-5 rounded-2xl rounded-tl-none shadow-sm text-sm leading-relaxed text-foreground/90\">\n                     {review.comment ? (\n                       review.comment\n                     ) : (\n                       <span className=\"italic text-muted-foreground/60\">No written comment provided</span>\n                     )}\n                   </div>\n                   {/* Decoration */}\n                   <div className=\"absolute top-0 left-0 -ml-2 -mt-2 opacity-0 group-hover:opacity-100 transition-opacity\">\n                     <div className=\"size-4 bg-primary/10 rounded-full blur-xl\" />\n                   </div>\n                 </div>\n               </div>\n            </div>\n\n            {/* AI Assistant / Draft Area */}\n            <div className=\"flex gap-4 flex-row-reverse\">\n               <div className=\"h-10 w-10 rounded-full bg-primary/10 border border-primary/20 flex items-center justify-center shrink-0 text-primary mt-1 shadow-glow-primary\">\n                 <SparklesIcon className=\"size-5\" weight=\"fill\" />\n               </div>\n               \n               <div className=\"flex flex-col gap-1.5 max-w-[90%] w-full\">\n                 <div className=\"flex items-center justify-end gap-2 mr-1\">\n                   <span className=\"text-xs font-bold text-primary\">\n                     AI Assistant\n                   </span>\n                 </div>\n\n                 {review.reply.comment ? (\n                    // Published State\n                    <div className=\"bg-emerald-50/80 border border-emerald-100 p-5 rounded-2xl rounded-tr-none text-sm leading-relaxed text-emerald-900 shadow-sm\">\n                       <div className=\"flex items-center gap-2 mb-2 text-emerald-700 font-bold text-xs uppercase tracking-wider\">\n                         <CheckCircle2 className=\"size-3.5\" weight=\"fill\" />\n                         Published Reply\n                       </div>\n                       {review.reply.comment}\n                       <div className=\"mt-3 pt-3 border-t border-emerald-200/50 text-[10px] font-medium text-emerald-600/70 text-right\">\n                         Posted {formatAge(review.reply.updateTime ? String(review.reply.updateTime) : \"\")}\n                       </div>\n                    </div>\n                 ) : (\n                    // Drafting State\n                    <div className=\"bg-background border border-border/60 shadow-elevated rounded-2xl rounded-tr-none overflow-hidden\">\n                       <DraftEditor\n                         reviewId={review.id}\n                         review={review}\n                         refresh={refresh}\n                       />\n                    </div>\n                 )}\n               </div>\n            </div>\n\n          </div>\n        </ScrollArea>\n      </div>\n    </div>\n  )\n}\n"
    },
    {
      "path": "components/search-context.tsx",
      "content": "\"use client\"\n\nimport * as React from \"react\"\n\ntype SearchState = {\n  query: string\n  setQuery: (q: string) => void\n}\n\nconst SearchContext = React.createContext<SearchState | null>(null)\n\nexport function SearchProvider({ children }: { children: React.ReactNode }) {\n  const [query, setQuery] = React.useState(\"\")\n\n  const value = React.useMemo(() => ({ query, setQuery }), [query])\n  return <SearchContext.Provider value={value}>{children}</SearchContext.Provider>\n}\n\nexport function useGlobalSearch(): SearchState {\n  const ctx = React.useContext(SearchContext)\n  if (!ctx) {\n    throw new Error(\"useGlobalSearch must be used within <SearchProvider>.\")\n  }\n  return ctx\n}\n\n"
    },
    {
      "path": "components/SignOutButton.tsx",
      "content": "\"use client\"\n\nimport * as React from \"react\"\nimport { signOut } from \"next-auth/react\"\nimport { Button } from \"@/components/ui/button\"\nimport { LogOut } from \"@/components/icons\"\n\nexport function SignOutButton({ className }: { className?: string }) {\n  return (\n    <Button\n      type=\"button\"\n      variant=\"ghost\"\n      className={className}\n      onClick={() => signOut({ callbackUrl: \"/signin\" })}\n    >\n      <LogOut className=\"size-4\" />\n      Sign out\n    </Button>\n  )\n}\n\n"
    },
    {
      "path": "components/ThemeProvider.tsx",
      "content": "\"use client\"\n\nimport * as React from \"react\"\nimport { ThemeProvider as NextThemesProvider } from \"next-themes\"\n\nexport function ThemeProvider({ children }: { children: React.ReactNode }) {\n  return (\n    <NextThemesProvider attribute=\"class\" defaultTheme=\"light\" enableSystem>\n      {children}\n    </NextThemesProvider>\n  )\n}\n\n"
    },
    {
      "path": "components/ui/accordion.tsx",
      "content": "\"use client\"\n\nimport * as React from \"react\"\nimport { Accordion as AccordionPrimitive } from \"radix-ui\"\nimport { ChevronDown } from \"@/components/icons\"\nimport { cn } from \"@/lib/utils\"\n\nexport const Accordion = AccordionPrimitive.Root\n\nexport const AccordionItem = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <AccordionPrimitive.Item ref={ref} className={cn(\"border-b\", className)} {...props} />\n))\nAccordionItem.displayName = \"AccordionItem\"\n\nexport const AccordionTrigger = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Header className=\"flex\">\n    <AccordionPrimitive.Trigger\n      ref={ref}\n      className={cn(\n        \"flex flex-1 items-center justify-between py-4 text-sm font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <ChevronDown className=\"h-4 w-4 shrink-0 transition-transform duration-200\" />\n    </AccordionPrimitive.Trigger>\n  </AccordionPrimitive.Header>\n))\nAccordionTrigger.displayName = \"AccordionTrigger\"\n\nexport const AccordionContent = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Content\n    ref={ref}\n    className=\"overflow-hidden text-sm data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down\"\n    {...props}\n  >\n    <div className={cn(\"pb-4 pt-0\", className)}>{children}</div>\n  </AccordionPrimitive.Content>\n))\nAccordionContent.displayName = \"AccordionContent\"\n"
    },
    {
      "path": "components/ui/alert-dialog.tsx",
      "content": "\"use client\"\n\nimport * as React from \"react\"\nimport { AlertDialog as AlertDialogPrimitive } from \"radix-ui\"\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nexport const AlertDialog = AlertDialogPrimitive.Root\nexport const AlertDialogTrigger = AlertDialogPrimitive.Trigger\nexport const AlertDialogPortal = AlertDialogPrimitive.Portal\n\nexport const AlertDialogOverlay = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Overlay\n    ref={ref}\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/40 backdrop-blur-sm data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n  />\n))\nAlertDialogOverlay.displayName = \"AlertDialogOverlay\"\n\nexport const AlertDialogContent = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPortal>\n    <AlertDialogOverlay />\n    <AlertDialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-google-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 rounded-xl\",\n        className\n      )}\n      {...props}\n    />\n  </AlertDialogPortal>\n))\nAlertDialogContent.displayName = \"AlertDialogContent\"\n\nexport function AlertDialogHeader({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) {\n  return <div className={cn(\"flex flex-col space-y-2 text-center sm:text-left\", className)} {...props} />\n}\n\nexport function AlertDialogFooter({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) {\n  return <div className={cn(\"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\", className)} {...props} />\n}\n\nexport const AlertDialogTitle = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Title ref={ref} className={cn(\"text-lg font-semibold\", className)} {...props} />\n))\nAlertDialogTitle.displayName = \"AlertDialogTitle\"\n\nexport const AlertDialogDescription = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Description ref={ref} className={cn(\"text-sm text-muted-foreground\", className)} {...props} />\n))\nAlertDialogDescription.displayName = \"AlertDialogDescription\"\n\nexport const AlertDialogAction = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Action>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Action>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Action ref={ref} className={cn(buttonVariants(), className)} {...props} />\n))\nAlertDialogAction.displayName = \"AlertDialogAction\"\n\nexport const AlertDialogCancel = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Cancel>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Cancel>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Cancel\n    ref={ref}\n    className={cn(buttonVariants({ variant: \"secondary\" }), \"mt-2 sm:mt-0\", className)}\n    {...props}\n  />\n))\nAlertDialogCancel.displayName = \"AlertDialogCancel\"\n\n"
    },
    {
      "path": "components/ui/avatar.tsx",
      "content": "\"use client\"\n\nimport * as React from \"react\"\nimport { Avatar as AvatarPrimitive } from \"radix-ui\"\nimport { cn } from \"@/lib/utils\"\n\nexport const Avatar = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Root\n    ref={ref}\n    className={cn(\"relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full\", className)}\n    {...props}\n  />\n))\nAvatar.displayName = \"Avatar\"\n\nexport const AvatarImage = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Image>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Image>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Image\n    ref={ref}\n    className={cn(\"aspect-square h-full w-full object-cover\", className)}\n    {...props}\n  />\n))\nAvatarImage.displayName = \"AvatarImage\"\n\nexport const AvatarFallback = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Fallback>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Fallback>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Fallback\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full items-center justify-center rounded-full bg-muted text-muted-foreground font-semibold\",\n      className\n    )}\n    {...props}\n  />\n))\nAvatarFallback.displayName = \"AvatarFallback\"\n\n"
    },
    {
      "path": "components/ui/badge.tsx",
      "content": "import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { cn } from \"@/lib/utils\"\n\nconst badgeVariants = cva(\n  \"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2\",\n  {\n    variants: {\n      variant: {\n        default: \"border-transparent bg-primary text-primary-foreground\",\n        secondary: \"border-transparent bg-secondary text-secondary-foreground\",\n        destructive: \"border-transparent bg-destructive text-destructive-foreground\",\n        outline: \"text-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nexport type BadgeProps = React.HTMLAttributes<HTMLDivElement> & VariantProps<typeof badgeVariants>\n\nexport function Badge({ className, variant, ...props }: BadgeProps) {\n  return <div className={cn(badgeVariants({ variant }), className)} {...props} />\n}\n\n"
    },
    {
      "path": "components/ui/button.tsx",
      "content": "\"use client\"\n\nimport * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-xl text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 ring-offset-background disabled:pointer-events-none disabled:opacity-50\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-primary text-primary-foreground hover:bg-primary/90 shadow-google-sm\",\n        secondary: \"bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n        destructive: \"bg-destructive text-destructive-foreground hover:bg-destructive/90\",\n        outline: \"border bg-background hover:bg-accent hover:text-accent-foreground\",\n        ghost: \"hover:bg-accent hover:text-accent-foreground\",\n        link: \"text-primary underline-offset-4 hover:underline\",\n      },\n      size: {\n        default: \"h-10 px-4 py-2\",\n        sm: \"h-9 px-3\",\n        lg: \"h-11 px-8\",\n        icon: \"h-10 w-10\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nexport type ButtonProps = React.ButtonHTMLAttributes<HTMLButtonElement> &\n  VariantProps<typeof buttonVariants> & {\n    asChild?: boolean\n  }\n\nexport const Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : \"button\"\n    return (\n      <Comp\n        className={cn(buttonVariants({ variant, size }), className)}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nButton.displayName = \"Button\"\n\nexport { buttonVariants }\n"
    },
    {
      "path": "components/ui/card.tsx",
      "content": "import * as React from \"react\"\nimport { cn } from \"@/lib/utils\"\n\nexport function Card({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) {\n  return (\n    <div\n      className={cn(\"rounded-2xl border bg-card text-card-foreground\", className)}\n      {...props}\n    />\n  )\n}\n\nexport function CardHeader({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) {\n  return <div className={cn(\"flex flex-col space-y-1.5 p-6\", className)} {...props} />\n}\n\nexport function CardTitle({ className, ...props }: React.HTMLAttributes<HTMLHeadingElement>) {\n  return <h3 className={cn(\"text-lg font-semibold leading-none tracking-tight\", className)} {...props} />\n}\n\nexport function CardDescription({ className, ...props }: React.HTMLAttributes<HTMLParagraphElement>) {\n  return <p className={cn(\"text-sm text-muted-foreground\", className)} {...props} />\n}\n\nexport function CardContent({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) {\n  return <div className={cn(\"p-6 pt-0\", className)} {...props} />\n}\n\nexport function CardFooter({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) {\n  return <div className={cn(\"flex items-center p-6 pt-0\", className)} {...props} />\n}\n\n"
    },
    {
      "path": "components/ui/checkbox.tsx",
      "content": "\"use client\"\n\nimport * as React from \"react\"\nimport { Checkbox as CheckboxPrimitive } from \"radix-ui\"\nimport { Check } from \"@/components/icons\"\nimport { cn } from \"@/lib/utils\"\n\nexport const Checkbox = React.forwardRef<\n  React.ElementRef<typeof CheckboxPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof CheckboxPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <CheckboxPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"peer h-4 w-4 shrink-0 rounded-sm border border-primary shadow focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground\",\n      className\n    )}\n    {...props}\n  >\n    <CheckboxPrimitive.Indicator className=\"flex items-center justify-center text-current\">\n      <Check className=\"h-3.5 w-3.5\" />\n    </CheckboxPrimitive.Indicator>\n  </CheckboxPrimitive.Root>\n))\nCheckbox.displayName = \"Checkbox\"\n"
    },
    {
      "path": "components/ui/dialog.tsx",
      "content": "\"use client\"\n\nimport * as React from \"react\"\nimport { Dialog as DialogPrimitive } from \"radix-ui\"\nimport { X } from \"@/components/icons\"\nimport { cn } from \"@/lib/utils\"\n\nexport const Dialog = DialogPrimitive.Root\nexport const DialogTrigger = DialogPrimitive.Trigger\nexport const DialogPortal = DialogPrimitive.Portal\nexport const DialogClose = DialogPrimitive.Close\n\nexport const DialogOverlay = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Overlay\n    ref={ref}\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/40 backdrop-blur-sm data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogOverlay.displayName = \"DialogOverlay\"\n\nexport const DialogContent = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DialogPortal>\n    <DialogOverlay />\n    <DialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-google-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] rounded-xl\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <DialogPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </DialogPrimitive.Close>\n    </DialogPrimitive.Content>\n  </DialogPortal>\n))\nDialogContent.displayName = \"DialogContent\"\n\nexport function DialogHeader({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) {\n  return <div className={cn(\"flex flex-col space-y-1.5 text-center sm:text-left\", className)} {...props} />\n}\n\nexport function DialogFooter({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) {\n  return <div className={cn(\"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\", className)} {...props} />\n}\n\nexport const DialogTitle = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Title ref={ref} className={cn(\"text-lg font-semibold leading-none tracking-tight\", className)} {...props} />\n))\nDialogTitle.displayName = \"DialogTitle\"\n\nexport const DialogDescription = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Description ref={ref} className={cn(\"text-sm text-muted-foreground\", className)} {...props} />\n))\nDialogDescription.displayName = \"DialogDescription\"\n"
    },
    {
      "path": "components/ui/direction.tsx",
      "content": "\"use client\"\n\nimport * as React from \"react\"\nimport * as DirectionPrimitive from \"@radix-ui/react-direction\"\n\nexport function DirectionProvider({\n  dir,\n  children,\n}: {\n  dir: \"ltr\" | \"rtl\"\n  children: React.ReactNode\n}) {\n  return <DirectionPrimitive.DirectionProvider dir={dir}>{children}</DirectionPrimitive.DirectionProvider>\n}\n\n"
    },
    {
      "path": "components/ui/dropdown-menu.tsx",
      "content": "\"use client\"\n\nimport * as React from \"react\"\nimport { DropdownMenu as DropdownMenuPrimitive } from \"radix-ui\"\nimport { Check, ChevronRight, Circle } from \"@/components/icons\"\nimport { cn } from \"@/lib/utils\"\n\nexport const DropdownMenu = DropdownMenuPrimitive.Root\nexport const DropdownMenuTrigger = DropdownMenuPrimitive.Trigger\nexport const DropdownMenuGroup = DropdownMenuPrimitive.Group\nexport const DropdownMenuPortal = DropdownMenuPrimitive.Portal\nexport const DropdownMenuSub = DropdownMenuPrimitive.Sub\nexport const DropdownMenuRadioGroup = DropdownMenuPrimitive.RadioGroup\n\nexport const DropdownMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubTrigger> & { inset?: boolean }\n>(({ className, inset, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </DropdownMenuPrimitive.SubTrigger>\n))\nDropdownMenuSubTrigger.displayName = \"DropdownMenuSubTrigger\"\n\nexport const DropdownMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-google-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuSubContent.displayName = \"DropdownMenuSubContent\"\n\nexport const DropdownMenuContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <DropdownMenuPrimitive.Portal>\n    <DropdownMenuPrimitive.Content\n      ref={ref}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-google-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n        className\n      )}\n      {...props}\n    />\n  </DropdownMenuPrimitive.Portal>\n))\nDropdownMenuContent.displayName = \"DropdownMenuContent\"\n\nexport const DropdownMenuItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Item> & { inset?: boolean }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuItem.displayName = \"DropdownMenuItem\"\n\nexport const DropdownMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <DropdownMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.CheckboxItem>\n))\nDropdownMenuCheckboxItem.displayName = \"DropdownMenuCheckboxItem\"\n\nexport const DropdownMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.RadioItem>\n))\nDropdownMenuRadioItem.displayName = \"DropdownMenuRadioItem\"\n\nexport const DropdownMenuLabel = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Label> & { inset?: boolean }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Label\n    ref={ref}\n    className={cn(\"px-2 py-1.5 text-sm font-semibold\", inset && \"pl-8\", className)}\n    {...props}\n  />\n))\nDropdownMenuLabel.displayName = \"DropdownMenuLabel\"\n\nexport const DropdownMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.Separator ref={ref} className={cn(\"-mx-1 my-1 h-px bg-muted\", className)} {...props} />\n))\nDropdownMenuSeparator.displayName = \"DropdownMenuSeparator\"\n\nexport const DropdownMenuShortcut = ({ className, ...props }: React.HTMLAttributes<HTMLSpanElement>) => {\n  return <span className={cn(\"ml-auto text-xs tracking-widest opacity-60\", className)} {...props} />\n}\n"
    },
    {
      "path": "components/ui/input.tsx",
      "content": "import * as React from \"react\"\nimport { cn } from \"@/lib/utils\"\n\nexport type InputProps = React.InputHTMLAttributes<HTMLInputElement>\n\nexport const Input = React.forwardRef<HTMLInputElement, InputProps>(({ className, type, ...props }, ref) => {\n  return (\n    <input\n      type={type}\n      className={cn(\n        \"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  )\n})\nInput.displayName = \"Input\"\n\n"
    },
    {
      "path": "components/ui/label.tsx",
      "content": "\"use client\"\n\nimport * as React from \"react\"\nimport { Label as LabelPrimitive } from \"radix-ui\"\nimport { cn } from \"@/lib/utils\"\n\nexport const Label = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <LabelPrimitive.Root\n    ref={ref}\n    className={cn(\"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\", className)}\n    {...props}\n  />\n))\nLabel.displayName = \"Label\"\n\n"
    },
    {
      "path": "components/ui/scroll-area.tsx",
      "content": "\"use client\"\n\nimport * as React from \"react\"\nimport { ScrollArea as ScrollAreaPrimitive } from \"radix-ui\"\nimport { cn } from \"@/lib/utils\"\n\nexport const ScrollArea = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <ScrollAreaPrimitive.Root ref={ref} className={cn(\"relative overflow-hidden\", className)} {...props}>\n    <ScrollAreaPrimitive.Viewport className=\"h-full w-full rounded-[inherit]\">\n      {children}\n    </ScrollAreaPrimitive.Viewport>\n    <ScrollBar />\n    <ScrollAreaPrimitive.Corner />\n  </ScrollAreaPrimitive.Root>\n))\nScrollArea.displayName = \"ScrollArea\"\n\nexport const ScrollBar = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.Scrollbar>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.Scrollbar>\n>(({ className, orientation = \"vertical\", ...props }, ref) => (\n  <ScrollAreaPrimitive.Scrollbar\n    ref={ref}\n    orientation={orientation}\n    className={cn(\n      \"flex touch-none select-none transition-colors\",\n      orientation === \"vertical\" && \"h-full w-2.5 border-l border-l-transparent p-[1px]\",\n      orientation === \"horizontal\" && \"h-2.5 flex-col border-t border-t-transparent p-[1px]\",\n      className\n    )}\n    {...props}\n  >\n    <ScrollAreaPrimitive.Thumb className=\"relative flex-1 rounded-full bg-border\" />\n  </ScrollAreaPrimitive.Scrollbar>\n))\nScrollBar.displayName = \"ScrollBar\"\n\n"
    },
    {
      "path": "components/ui/select.tsx",
      "content": "\"use client\"\n\nimport * as React from \"react\"\nimport { Select as SelectPrimitive } from \"radix-ui\"\nimport { Check, ChevronDown, ChevronUp } from \"@/components/icons\"\nimport { cn } from \"@/lib/utils\"\n\nexport const Select = SelectPrimitive.Root\nexport const SelectGroup = SelectPrimitive.Group\nexport const SelectValue = SelectPrimitive.Value\n\nexport const SelectTrigger = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <SelectPrimitive.Icon asChild>\n      <ChevronDown className=\"h-4 w-4 opacity-50\" />\n    </SelectPrimitive.Icon>\n  </SelectPrimitive.Trigger>\n))\nSelectTrigger.displayName = \"SelectTrigger\"\n\nexport const SelectScrollUpButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollUpButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollUpButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollUpButton\n    ref={ref}\n    className={cn(\"flex cursor-default items-center justify-center py-1\", className)}\n    {...props}\n  >\n    <ChevronUp className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollUpButton>\n))\nSelectScrollUpButton.displayName = \"SelectScrollUpButton\"\n\nexport const SelectScrollDownButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollDownButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollDownButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollDownButton\n    ref={ref}\n    className={cn(\"flex cursor-default items-center justify-center py-1\", className)}\n    {...props}\n  >\n    <ChevronDown className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollDownButton>\n))\nSelectScrollDownButton.displayName = \"SelectScrollDownButton\"\n\nexport const SelectContent = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Content>\n>(({ className, children, position = \"popper\", ...props }, ref) => (\n  <SelectPrimitive.Portal>\n    <SelectPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-google-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n        position === \"popper\" &&\n          \"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1\",\n        className\n      )}\n      position={position}\n      {...props}\n    >\n      <SelectScrollUpButton />\n      <SelectPrimitive.Viewport\n        className={cn(\"p-1\", position === \"popper\" && \"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]\")}\n      >\n        {children}\n      </SelectPrimitive.Viewport>\n      <SelectScrollDownButton />\n    </SelectPrimitive.Content>\n  </SelectPrimitive.Portal>\n))\nSelectContent.displayName = \"SelectContent\"\n\nexport const SelectLabel = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Label>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Label ref={ref} className={cn(\"py-1.5 pl-8 pr-2 text-sm font-semibold\", className)} {...props} />\n))\nSelectLabel.displayName = \"SelectLabel\"\n\nexport const SelectItem = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Item>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <SelectPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </SelectPrimitive.ItemIndicator>\n    </span>\n    <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>\n  </SelectPrimitive.Item>\n))\nSelectItem.displayName = \"SelectItem\"\n\nexport const SelectSeparator = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Separator ref={ref} className={cn(\"-mx-1 my-1 h-px bg-muted\", className)} {...props} />\n))\nSelectSeparator.displayName = \"SelectSeparator\"\n"
    },
    {
      "path": "components/ui/separator.tsx",
      "content": "\"use client\"\n\nimport * as React from \"react\"\nimport { Separator as SeparatorPrimitive } from \"radix-ui\"\nimport { cn } from \"@/lib/utils\"\n\nexport const Separator = React.forwardRef<\n  React.ElementRef<typeof SeparatorPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SeparatorPrimitive.Root>\n>(({ className, orientation = \"horizontal\", decorative = true, ...props }, ref) => (\n  <SeparatorPrimitive.Root\n    ref={ref}\n    decorative={decorative}\n    orientation={orientation}\n    className={cn(\n      \"shrink-0 bg-border\",\n      orientation === \"horizontal\" ? \"h-px w-full\" : \"h-full w-px\",\n      className\n    )}\n    {...props}\n  />\n))\nSeparator.displayName = \"Separator\"\n\n"
    },
    {
      "path": "components/ui/sheet.tsx",
      "content": "\"use client\"\n\nimport * as React from \"react\"\nimport { Dialog as DialogPrimitive } from \"radix-ui\"\nimport { X } from \"@/components/icons\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { cn } from \"@/lib/utils\"\n\nexport const Sheet = DialogPrimitive.Root\nexport const SheetTrigger = DialogPrimitive.Trigger\nexport const SheetClose = DialogPrimitive.Close\nexport const SheetPortal = DialogPrimitive.Portal\n\nexport const SheetOverlay = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Overlay\n    ref={ref}\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/40 backdrop-blur-sm data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n  />\n))\nSheetOverlay.displayName = \"SheetOverlay\"\n\nconst sheetVariants = cva(\n  \"fixed z-50 gap-4 bg-background p-6 shadow-google-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500 data-[state=open]:animate-in data-[state=closed]:animate-out\",\n  {\n    variants: {\n      side: {\n        top: \"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top\",\n        bottom: \"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom\",\n        left: \"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm\",\n        right:\n          \"inset-y-0 right-0 h-full w-3/4 border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm\",\n      },\n    },\n    defaultVariants: {\n      side: \"right\",\n    },\n  }\n)\n\nexport interface SheetContentProps\n  extends React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content>,\n    VariantProps<typeof sheetVariants> {}\n\nexport const SheetContent = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Content>,\n  SheetContentProps\n>(({ side = \"right\", className, children, ...props }, ref) => (\n  <SheetPortal>\n    <SheetOverlay />\n    <DialogPrimitive.Content\n      ref={ref}\n      className={cn(sheetVariants({ side }), \"rounded-none\", className)}\n      {...props}\n    >\n      {children}\n      <DialogPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </DialogPrimitive.Close>\n    </DialogPrimitive.Content>\n  </SheetPortal>\n))\nSheetContent.displayName = \"SheetContent\"\n\nexport function SheetHeader({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) {\n  return <div className={cn(\"flex flex-col space-y-2 text-center sm:text-left\", className)} {...props} />\n}\n\nexport function SheetFooter({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) {\n  return <div className={cn(\"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\", className)} {...props} />\n}\n\nexport const SheetTitle = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Title ref={ref} className={cn(\"text-lg font-semibold leading-none tracking-tight\", className)} {...props} />\n))\nSheetTitle.displayName = \"SheetTitle\"\n\nexport const SheetDescription = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Description ref={ref} className={cn(\"text-sm text-muted-foreground\", className)} {...props} />\n))\nSheetDescription.displayName = \"SheetDescription\"\n"
    },
    {
      "path": "components/ui/skeleton.tsx",
      "content": "import { cn } from \"@/lib/utils\"\n\nexport function Skeleton({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) {\n  return <div className={cn(\"animate-pulse rounded-md bg-muted\", className)} {...props} />\n}\n\n"
    },
    {
      "path": "components/ui/sonner.tsx",
      "content": "\"use client\"\n\nimport * as React from \"react\"\nimport { Toaster as Sonner } from \"sonner\"\nimport { useTheme } from \"next-themes\"\n\nexport function Toaster() {\n  const { theme } = useTheme()\n  const resolved = theme === \"dark\" ? \"dark\" : \"light\"\n\n  return (\n    <Sonner\n      theme={resolved}\n      richColors\n      closeButton\n      toastOptions={{\n        classNames: {\n          toast:\n            \"group toast bg-background text-foreground border border-border shadow-google-md\",\n          description: \"text-muted-foreground\",\n          actionButton: \"bg-primary text-primary-foreground\",\n          cancelButton: \"bg-muted text-muted-foreground\",\n        },\n      }}\n    />\n  )\n}\n\n"
    },
    {
      "path": "components/ui/switch.tsx",
      "content": "\"use client\"\n\nimport * as React from \"react\"\nimport { Switch as SwitchPrimitive } from \"radix-ui\"\nimport { cn } from \"@/lib/utils\"\n\nexport const Switch = React.forwardRef<\n  React.ElementRef<typeof SwitchPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SwitchPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <SwitchPrimitive.Root\n    className={cn(\n      \"peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  >\n    <SwitchPrimitive.Thumb\n      className={cn(\n        \"pointer-events-none block h-5 w-5 rounded-full bg-background shadow-google-sm ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0\"\n      )}\n    />\n  </SwitchPrimitive.Root>\n))\nSwitch.displayName = \"Switch\"\n\n"
    },
    {
      "path": "components/ui/table.tsx",
      "content": "import * as React from \"react\"\nimport { cn } from \"@/lib/utils\"\n\nexport function Table({ className, ...props }: React.TableHTMLAttributes<HTMLTableElement>) {\n  return <table className={cn(\"w-full caption-bottom text-sm\", className)} {...props} />\n}\n\nexport function TableHeader({ className, ...props }: React.HTMLAttributes<HTMLTableSectionElement>) {\n  return <thead className={cn(\"[&_tr]:border-b\", className)} {...props} />\n}\n\nexport function TableBody({ className, ...props }: React.HTMLAttributes<HTMLTableSectionElement>) {\n  return <tbody className={cn(\"[&_tr:last-child]:border-0\", className)} {...props} />\n}\n\nexport function TableFooter({ className, ...props }: React.HTMLAttributes<HTMLTableSectionElement>) {\n  return <tfoot className={cn(\"border-t bg-muted/50 font-medium [&>tr]:last:border-b-0\", className)} {...props} />\n}\n\nexport function TableRow({ className, ...props }: React.HTMLAttributes<HTMLTableRowElement>) {\n  return (\n    <tr\n      className={cn(\"border-b transition-colors hover:bg-muted/40 data-[state=selected]:bg-muted\", className)}\n      {...props}\n    />\n  )\n}\n\nexport function TableHead({ className, ...props }: React.ThHTMLAttributes<HTMLTableCellElement>) {\n  return (\n    <th\n      className={cn(\"h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0\", className)}\n      {...props}\n    />\n  )\n}\n\nexport function TableCell({ className, ...props }: React.TdHTMLAttributes<HTMLTableCellElement>) {\n  return (\n    <td\n      className={cn(\"p-4 align-middle [&:has([role=checkbox])]:pr-0\", className)}\n      {...props}\n    />\n  )\n}\n\nexport function TableCaption({ className, ...props }: React.HTMLAttributes<HTMLTableCaptionElement>) {\n  return <caption className={cn(\"mt-4 text-sm text-muted-foreground\", className)} {...props} />\n}\n\n"
    },
    {
      "path": "components/ui/tabs.tsx",
      "content": "\"use client\"\n\nimport * as React from \"react\"\nimport { Tabs as TabsPrimitive } from \"radix-ui\"\nimport { cn } from \"@/lib/utils\"\n\nexport const Tabs = TabsPrimitive.Root\n\nexport const TabsList = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.List\n    ref={ref}\n    className={cn(\n      \"inline-flex h-10 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsList.displayName = \"TabsList\"\n\nexport const TabsTrigger = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-google-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsTrigger.displayName = \"TabsTrigger\"\n\nexport const TabsContent = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsContent.displayName = \"TabsContent\"\n\n"
    },
    {
      "path": "components/ui/textarea.tsx",
      "content": "import * as React from \"react\"\nimport { cn } from \"@/lib/utils\"\n\nexport type TextareaProps = React.TextareaHTMLAttributes<HTMLTextAreaElement>\n\nexport const Textarea = React.forwardRef<HTMLTextAreaElement, TextareaProps>(({ className, ...props }, ref) => {\n  return (\n    <textarea\n      className={cn(\n        \"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  )\n})\nTextarea.displayName = \"Textarea\"\n\n"
    },
    {
      "path": "components/ui/toggle-group.tsx",
      "content": "\"use client\"\n\nimport * as React from \"react\"\nimport { ToggleGroup as ToggleGroupPrimitive } from \"radix-ui\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { cn } from \"@/lib/utils\"\n\nconst toggleGroupVariants = cva(\n  \"inline-flex items-center justify-center rounded-xl bg-muted p-1 text-muted-foreground\",\n  {\n    variants: {\n      size: {\n        sm: \"h-8\",\n        default: \"h-9\",\n        lg: \"h-10\",\n      },\n    },\n    defaultVariants: {\n      size: \"default\",\n    },\n  }\n)\n\nexport const ToggleGroup = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Root> &\n    VariantProps<typeof toggleGroupVariants>\n>(({ className, size, ...props }, ref) => (\n  <ToggleGroupPrimitive.Root\n    ref={ref}\n    className={cn(toggleGroupVariants({ size }), className)}\n    {...props}\n  />\n))\nToggleGroup.displayName = \"ToggleGroup\"\n\nconst toggleGroupItemVariants = cva(\n  \"inline-flex items-center justify-center whitespace-nowrap rounded-lg px-3 text-xs font-semibold transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 ring-offset-background disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-background data-[state=on]:text-foreground data-[state=on]:shadow-google-sm\",\n  {\n    variants: {\n      size: {\n        sm: \"h-7\",\n        default: \"h-8\",\n        lg: \"h-9\",\n      },\n    },\n    defaultVariants: {\n      size: \"default\",\n    },\n  }\n)\n\nexport const ToggleGroupItem = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Item> &\n    VariantProps<typeof toggleGroupItemVariants>\n>(({ className, size, ...props }, ref) => (\n  <ToggleGroupPrimitive.Item\n    ref={ref}\n    className={cn(toggleGroupItemVariants({ size }), className)}\n    {...props}\n  />\n))\nToggleGroupItem.displayName = \"ToggleGroupItem\"\n\n"
    },
    {
      "path": "components/ui/tooltip.tsx",
      "content": "\"use client\"\n\nimport * as React from \"react\"\nimport { Tooltip as TooltipPrimitive } from \"radix-ui\"\nimport { cn } from \"@/lib/utils\"\n\nexport const TooltipProvider = TooltipPrimitive.Provider\nexport const Tooltip = TooltipPrimitive.Root\nexport const TooltipTrigger = TooltipPrimitive.Trigger\n\nexport const TooltipContent = React.forwardRef<\n  React.ElementRef<typeof TooltipPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TooltipPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <TooltipPrimitive.Portal>\n    <TooltipPrimitive.Content\n      ref={ref}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-xs text-popover-foreground shadow-google-md data-[state=delayed-open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=delayed-open]:fade-in-0\",\n        className\n      )}\n      {...props}\n    />\n  </TooltipPrimitive.Portal>\n))\nTooltipContent.displayName = \"TooltipContent\"\n\n"
    },
    {
      "path": "next.config.ts",
      "content": "import { fileURLToPath } from \"node:url\"\nimport type { NextConfig } from \"next\"\nimport path from \"node:path\"\n\nconst repoRoot = path.dirname(fileURLToPath(import.meta.url))\n\nconst nextConfig: NextConfig & { allowedDevOrigins?: string[] } = {\n  turbopack: {\n    // Pin root to this repository so parent lockfiles do not affect module resolution.\n    root: repoRoot,\n  },\n  // Used by Playwright (baseURL uses 127.0.0.1) and avoids future Next.js dev-origin restrictions.\n  allowedDevOrigins: [\"127.0.0.1\", \"localhost\"],\n  images: {\n    remotePatterns: [\n      {\n        protocol: \"https\",\n        hostname: \"www.gstatic.com\",\n      },\n    ],\n  },\n}\n\nexport default nextConfig\n"
    },
    {
      "path": "postcss.config.mjs",
      "content": "const config = {\n  plugins: {\n    \"@tailwindcss/postcss\": {},\n  },\n}\n\nexport default config\n\n"
    },
    {
      "path": "tailwind.config.ts",
      "content": "import type { Config } from \"tailwindcss\"\nimport defaultTheme from \"tailwindcss/defaultTheme\"\n\n// Keep Tailwind's filesystem scanning bounded to this repo.\n// Without an explicit content list, some environments can end up scanning too broadly,\n// which makes dev builds appear to hang.\nexport default {\n  darkMode: \"class\",\n  content: [\n    \"./app/**/*.{ts,tsx,mdx}\",\n    \"./components/**/*.{ts,tsx,mdx}\",\n    \"./lib/**/*.{ts,tsx,mdx}\",\n  ],\n  theme: {\n    extend: {\n      fontFamily: {\n        sans: [\"var(--font-sans)\", ...defaultTheme.fontFamily.sans],\n      },\n      borderRadius: {\n        lg: \"var(--radius)\",\n        md: \"calc(var(--radius) - 2px)\",\n        sm: \"calc(var(--radius) - 4px)\",\n      },\n      colors: {\n        border: \"var(--border)\",\n        input: \"var(--input)\",\n        ring: \"var(--ring)\",\n        background: \"var(--background)\",\n        foreground: \"var(--foreground)\",\n        primary: {\n          DEFAULT: \"var(--primary)\",\n          foreground: \"var(--primary-foreground)\",\n        },\n        secondary: {\n          DEFAULT: \"var(--secondary)\",\n          foreground: \"var(--secondary-foreground)\",\n        },\n        destructive: {\n          DEFAULT: \"var(--destructive)\",\n          foreground: \"var(--destructive-foreground)\",\n        },\n        muted: {\n          DEFAULT: \"var(--muted)\",\n          foreground: \"var(--muted-foreground)\",\n        },\n        accent: {\n          DEFAULT: \"var(--accent)\",\n          foreground: \"var(--accent-foreground)\",\n        },\n        popover: {\n          DEFAULT: \"var(--popover)\",\n          foreground: \"var(--popover-foreground)\",\n        },\n        card: {\n          DEFAULT: \"var(--card)\",\n          foreground: \"var(--card-foreground)\",\n        },\n      },\n    },\n  },\n  plugins: [],\n} satisfies Config\n"
    }
  ]
}